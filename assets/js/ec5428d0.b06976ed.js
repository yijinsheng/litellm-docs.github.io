"use strict";(globalThis.webpackChunkmy_website=globalThis.webpackChunkmy_website||[]).push([[25546],{7227(e,n,i){i.d(n,{A:()=>s});i(96540);var t=i(18215);const r="tabItem_Ymn6";var l=i(74848);function s({children:e,hidden:n,className:i}){return(0,l.jsx)("div",{role:"tabpanel",className:(0,t.A)(r,i),hidden:n,children:e})}},28453(e,n,i){i.d(n,{R:()=>s,x:()=>a});var t=i(96540);const r={},l=t.createContext(r);function s(e){const n=t.useContext(l);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),t.createElement(l.Provider,{value:n},e.children)}},49489(e,n,i){i.d(n,{A:()=>k});var t=i(96540),r=i(18215),l=i(24245),s=i(56347),a=i(36494),o=i(62814),d=i(45167),c=i(69900);function u(e){return t.Children.toArray(e).filter(e=>"\n"!==e).map(e=>{if(!e||(0,t.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})?.filter(Boolean)??[]}function m(e){const{values:n,children:i}=e;return(0,t.useMemo)(()=>{const e=n??function(e){return u(e).map(({props:{value:e,label:n,attributes:i,default:t}})=>({value:e,label:n,attributes:i,default:t}))}(i);return function(e){const n=(0,d.XI)(e,(e,n)=>e.value===n.value);if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map(e=>e.value).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e},[n,i])}function h({value:e,tabValues:n}){return n.some(n=>n.value===e)}function _({queryString:e=!1,groupId:n}){const i=(0,s.W6)(),r=function({queryString:e=!1,groupId:n}){if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:e,groupId:n});return[(0,o.aZ)(r),(0,t.useCallback)(e=>{if(!r)return;const n=new URLSearchParams(i.location.search);n.set(r,e),i.replace({...i.location,search:n.toString()})},[r,i])]}function p(e){const{defaultValue:n,queryString:i=!1,groupId:r}=e,l=m(e),[s,o]=(0,t.useState)(()=>function({defaultValue:e,tabValues:n}){if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!h({value:e,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${n.map(e=>e.value).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}const i=n.find(e=>e.default)??n[0];if(!i)throw new Error("Unexpected error: 0 tabValues");return i.value}({defaultValue:n,tabValues:l})),[d,u]=_({queryString:i,groupId:r}),[p,v]=function({groupId:e}){const n=function(e){return e?`docusaurus.tab.${e}`:null}(e),[i,r]=(0,c.Dv)(n);return[i,(0,t.useCallback)(e=>{n&&r.set(e)},[n,r])]}({groupId:r}),x=(()=>{const e=d??p;return h({value:e,tabValues:l})?e:null})();(0,a.A)(()=>{x&&o(x)},[x]);return{selectedValue:s,selectValue:(0,t.useCallback)(e=>{if(!h({value:e,tabValues:l}))throw new Error(`Can't select invalid tab value=${e}`);o(e),u(e),v(e)},[u,v,l]),tabValues:l}}var v=i(11062);const x="tabList__CuJ",f="tabItem_LNqP";var j=i(74848);function b({className:e,block:n,selectedValue:i,selectValue:t,tabValues:s}){const a=[],{blockElementScrollPositionUntilNextRender:o}=(0,l.a_)(),d=e=>{const n=e.currentTarget,r=a.indexOf(n),l=s[r].value;l!==i&&(o(n),t(l))},c=e=>{let n=null;switch(e.key){case"Enter":d(e);break;case"ArrowRight":{const i=a.indexOf(e.currentTarget)+1;n=a[i]??a[0];break}case"ArrowLeft":{const i=a.indexOf(e.currentTarget)-1;n=a[i]??a[a.length-1];break}}n?.focus()};return(0,j.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,r.A)("tabs",{"tabs--block":n},e),children:s.map(({value:e,label:n,attributes:t})=>(0,j.jsx)("li",{role:"tab",tabIndex:i===e?0:-1,"aria-selected":i===e,ref:e=>{a.push(e)},onKeyDown:c,onClick:d,...t,className:(0,r.A)("tabs__item",f,t?.className,{"tabs__item--active":i===e}),children:n??e},e))})}function g({lazy:e,children:n,selectedValue:i}){const l=(Array.isArray(n)?n:[n]).filter(Boolean);if(e){const e=l.find(e=>e.props.value===i);return e?(0,t.cloneElement)(e,{className:(0,r.A)("margin-top--md",e.props.className)}):null}return(0,j.jsx)("div",{className:"margin-top--md",children:l.map((e,n)=>(0,t.cloneElement)(e,{key:n,hidden:e.props.value!==i}))})}function y(e){const n=p(e);return(0,j.jsxs)("div",{className:(0,r.A)("tabs-container",x),children:[(0,j.jsx)(b,{...n,...e}),(0,j.jsx)(g,{...n,...e})]})}function k(e){const n=(0,v.A)();return(0,j.jsx)(y,{...e,children:u(e.children)},String(n))}},66183(e,n,i){i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>d,default:()=>h,frontMatter:()=>o,metadata:()=>t,toc:()=>u});const t=JSON.parse('{"id":"providers/milvus_vector_stores","title":"Milvus - \u5411\u91cf\u5b58\u50a8","description":"\u4f7f\u7528 Milvus \u4f5c\u4e3a RAG \u7684\u5411\u91cf\u5b58\u50a8\u3002","source":"@site/docs/providers/milvus_vector_stores.md","sourceDirName":"providers","slug":"/providers/milvus_vector_stores","permalink":"/docs/providers/milvus_vector_stores","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Meta Llama","permalink":"/docs/providers/meta_llama"},"next":{"title":"Mistral AI API","permalink":"/docs/providers/mistral"}}');var r=i(74848),l=i(28453),s=i(49489),a=i(7227);const o={},d="Milvus - \u5411\u91cf\u5b58\u50a8",c={},u=[{value:"\u5feb\u901f\u5165\u95e8",id:"\u5feb\u901f\u5165\u95e8",level:2},{value:"\u4f7f\u7528\u65b9\u6cd5",id:"\u4f7f\u7528\u65b9\u6cd5",level:2},{value:"\u57fa\u672c\u641c\u7d22",id:"\u57fa\u672c\u641c\u7d22",level:3},{value:"\u9ad8\u7ea7\u9009\u9879",id:"\u9ad8\u7ea7\u9009\u9879",level:3},{value:"\u914d\u7f6e\u8bbe\u7f6e",id:"\u914d\u7f6e\u8bbe\u7f6e",level:3},{value:"\u542f\u52a8\u4ee3\u7406",id:"\u542f\u52a8\u4ee3\u7406",level:3},{value:"\u901a\u8fc7 API \u641c\u7d22",id:"\u901a\u8fc7-api-\u641c\u7d22",level:3},{value:"\u5fc5\u9700\u53c2\u6570",id:"\u5fc5\u9700\u53c2\u6570",level:2},{value:"\u53ef\u9009\u53c2\u6570",id:"\u53ef\u9009\u53c2\u6570",level:2},{value:"\u652f\u6301\u7684\u529f\u80fd",id:"\u652f\u6301\u7684\u529f\u80fd",level:2},{value:"\u54cd\u5e94\u683c\u5f0f",id:"\u54cd\u5e94\u683c\u5f0f",level:2},{value:"\u539f\u751f API (\u539f\u751f Milvus \u683c\u5f0f)",id:"\u539f\u751f-api-\u539f\u751f-milvus-\u683c\u5f0f",level:2},{value:"\u7ba1\u7406\u5458\u6d41\u7a0b",id:"\u7ba1\u7406\u5458\u6d41\u7a0b",level:3},{value:"1. \u5c06\u5411\u91cf\u5b58\u50a8\u6dfb\u52a0\u5230 LiteLLM",id:"1-\u5c06\u5411\u91cf\u5b58\u50a8\u6dfb\u52a0\u5230-litellm",level:4},{value:"2. \u542f\u52a8\u4ee3\u7406",id:"2-\u542f\u52a8\u4ee3\u7406",level:4},{value:"3. \u521b\u5efa\u865a\u62df\u7d22\u5f15",id:"3-\u521b\u5efa\u865a\u62df\u7d22\u5f15",level:4},{value:"4. \u521b\u5efa\u5177\u6709\u5411\u91cf\u5b58\u50a8\u6743\u9650\u7684\u5bc6\u94a5",id:"4-\u521b\u5efa\u5177\u6709\u5411\u91cf\u5b58\u50a8\u6743\u9650\u7684\u5bc6\u94a5",level:4},{value:"\u5f00\u53d1\u8005\u6d41\u7a0b",id:"\u5f00\u53d1\u8005\u6d41\u7a0b",level:3},{value:"MilvusRESTClient",id:"milvusrestclient",level:4},{value:"1. \u521b\u5efa\u5177\u6709\u6a21\u5f0f\u7684\u96c6\u5408",id:"1-\u521b\u5efa\u5177\u6709\u6a21\u5f0f\u7684\u96c6\u5408",level:4},{value:"2. \u5411\u96c6\u5408\u63d2\u5165\u6570\u636e",id:"2-\u5411\u96c6\u5408\u63d2\u5165\u6570\u636e",level:4},{value:"3. \u641c\u7d22\u96c6\u5408",id:"3-\u641c\u7d22\u96c6\u5408",level:4},{value:"\u5b8c\u6574\u793a\u4f8b",id:"\u5b8c\u6574\u793a\u4f8b",level:4},{value:"\u8fd0\u4f5c\u65b9\u5f0f",id:"\u8fd0\u4f5c\u65b9\u5f0f",level:2}];function m(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,l.R)(),...e.components},{Details:i}=n;return i||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"milvus---\u5411\u91cf\u5b58\u50a8",children:"Milvus - \u5411\u91cf\u5b58\u50a8"})}),"\n",(0,r.jsx)(n.p,{children:"\u4f7f\u7528 Milvus \u4f5c\u4e3a RAG \u7684\u5411\u91cf\u5b58\u50a8\u3002"}),"\n",(0,r.jsx)(n.h2,{id:"\u5feb\u901f\u5165\u95e8",children:"\u5feb\u901f\u5165\u95e8"}),"\n",(0,r.jsx)(n.p,{children:"\u4f60\u9700\u8981\u4e09\u6837\u4e1c\u897f\uff1a"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"\u4e00\u4e2a Milvus \u5b9e\u4f8b\uff08\u4e91\u6258\u7ba1\u6216\u81ea\u6258\u7ba1\uff09"}),"\n",(0,r.jsx)(n.li,{children:"\u4e00\u4e2a\u5d4c\u5165\u6a21\u578b\uff08\u5c06\u4f60\u7684\u67e5\u8be2\u8f6c\u6362\u4e3a\u5411\u91cf\uff09"}),"\n",(0,r.jsx)(n.li,{children:"\u5305\u542b\u5411\u91cf\u5b57\u6bb5\u7684 Milvus \u96c6\u5408"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"\u4f7f\u7528\u65b9\u6cd5",children:"\u4f7f\u7528\u65b9\u6cd5"}),"\n",(0,r.jsxs)(s.A,{children:[(0,r.jsxs)(a.A,{value:"sdk",label:"SDK",children:[(0,r.jsx)(n.h3,{id:"\u57fa\u672c\u641c\u7d22",children:"\u57fa\u672c\u641c\u7d22"}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'from litellm import vector_stores\nimport os\n\n# \u8bbe\u7f6e\u51ed\u8bc1\nos.environ["MILVUS_API_KEY"] = "your-milvus-api-key"\nos.environ["MILVUS_API_BASE"] = "https://your-milvus-instance.milvus.io"\n\n# \u641c\u7d22\u5411\u91cf\u5b58\u50a8\nresponse = vector_stores.search(\n    vector_store_id="my-collection-name",  # \u4f60\u7684 Milvus \u96c6\u5408\u540d\u79f0\n    query="What is the capital of France?",\n    custom_llm_provider="milvus",\n    litellm_embedding_model="azure/text-embedding-3-large",\n    litellm_embedding_config={\n        "api_base": "your-embedding-endpoint",\n        "api_key": "your-embedding-api-key",\n        "api_version": "2025-09-01"\n    },\n    milvus_text_field="book_intro",  # \u5305\u542b\u6587\u672c\u5185\u5bb9\u7684\u5b57\u6bb5\u540d\u79f0\n    api_key=os.getenv("MILVUS_API_KEY"),\n)\n\nprint(response)\n\n\n### \u5f02\u6b65\u641c\u7d22\n\n```python\nfrom litellm import vector_stores\n\nresponse = await vector_stores.asearch(\n    vector_store_id="my-collection-name",\n    query="What is the capital of France?",\n    custom_llm_provider="milvus",\n    litellm_embedding_model="azure/text-embedding-3-large",\n    litellm_embedding_config={\n        "api_base": "your-embedding-endpoint",\n        "api_key": "your-embedding-api-key",\n        "api_version": "2025-09-01"\n    },\n    milvus_text_field="book_intro",\n    api_key=os.getenv("MILVUS_API_KEY"),\n)\n\nprint(response)\n'})}),(0,r.jsx)(n.h3,{id:"\u9ad8\u7ea7\u9009\u9879",children:"\u9ad8\u7ea7\u9009\u9879"}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'from litellm import vector_stores\n\nresponse = vector_stores.search(\n    vector_store_id="my-collection-name",\n    query="What is the capital of France?",\n    custom_llm_provider="milvus",\n    litellm_embedding_model="azure/text-embedding-3-large",\n    litellm_embedding_config={\n        "api_base": "your-embedding-endpoint",\n        "api_key": "your-embedding-api-key"\n    },\n    milvus_text_field="book_intro",\n    api_key=os.getenv("MILVUS_API_KEY"),\n    # Milvus \u7279\u5b9a\u53c2\u6570\n    limit=10,  # \u8fd4\u56de\u7684\u7ed3\u679c\u6570\u91cf\n    offset=0,  # \u5206\u9875\u504f\u79fb\u91cf\n    dbName="default",  # \u6570\u636e\u5e93\u540d\u79f0\n    annsField="book_intro_vector",  # \u5411\u91cf\u5b57\u6bb5\u540d\u79f0\n    outputFields=["id", "book_intro", "title"],  # \u8981\u8fd4\u56de\u7684\u5b57\u6bb5\n    filter=\'book_id > 0\',  # \u5143\u6570\u636e\u8fc7\u6ee4\u8868\u8fbe\u5f0f\n    searchParams={"metric_type": "L2", "params": {"nprobe": 10}},  # \u641c\u7d22\u53c2\u6570\n)\n\nprint(response)\n'})})]}),(0,r.jsxs)(a.A,{value:"proxy",label:"PROXY",children:[(0,r.jsx)(n.h3,{id:"\u914d\u7f6e\u8bbe\u7f6e",children:"\u914d\u7f6e\u8bbe\u7f6e"}),(0,r.jsxs)(n.p,{children:["\u5c06\u4ee5\u4e0b\u5185\u5bb9\u6dfb\u52a0\u5230\u4f60\u7684 ",(0,r.jsx)(n.code,{children:"config.yaml"})," \u4e2d\uff1a"]}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:'vector_store_registry:\n  - vector_store_name: "milvus-knowledgebase"\n    litellm_params:\n        vector_store_id: "my-collection-name"\n        custom_llm_provider: "milvus"\n        api_key: os.environ/MILVUS_API_KEY\n        api_base: https://your-milvus-instance.milvus.io\n        litellm_embedding_model: "azure/text-embedding-3-large"\n        litellm_embedding_config:\n            api_base: https://your-endpoint.cognitiveservices.azure.com/\n            api_key: os.environ/AZURE_API_KEY\n            api_version: "2025-09-01"\n        milvus_text_field: "book_intro"\n        # \u53ef\u9009 Milvus \u53c2\u6570\n        annsField: "book_intro_vector"\n        limit: 10\n'})}),(0,r.jsx)(n.h3,{id:"\u542f\u52a8\u4ee3\u7406",children:"\u542f\u52a8\u4ee3\u7406"}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"litellm --config /path/to/config.yaml\n"})}),(0,r.jsx)(n.h3,{id:"\u901a\u8fc7-api-\u641c\u7d22",children:"\u901a\u8fc7 API \u641c\u7d22"}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"curl -X POST 'http://0.0.0.0:4000/v1/vector_stores/my-collection-name/search' \\\n-H 'Content-Type: application/json' \\\n-H 'Authorization: Bearer sk-1234' \\\n-d '{\n  \"query\": \"What is the capital of France?\"\n}'\n"})})]})]}),"\n",(0,r.jsx)(n.h2,{id:"\u5fc5\u9700\u53c2\u6570",children:"\u5fc5\u9700\u53c2\u6570"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"\u53c2\u6570"}),(0,r.jsx)(n.th,{children:"\u7c7b\u578b"}),(0,r.jsx)(n.th,{children:"\u63cf\u8ff0"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"vector_store_id"})}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsx)(n.td,{children:"\u4f60\u7684 Milvus \u96c6\u5408\u540d\u79f0"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"custom_llm_provider"})}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsxs)(n.td,{children:["\u8bbe\u7f6e\u4e3a ",(0,r.jsx)(n.code,{children:'"milvus"'})]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"litellm_embedding_model"})}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsxs)(n.td,{children:["\u751f\u6210\u67e5\u8be2\u5d4c\u5165\u7684\u6a21\u578b\uff08\u4f8b\u5982\uff0c",(0,r.jsx)(n.code,{children:'"azure/text-embedding-3-large"'}),"\uff09"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"litellm_embedding_config"})}),(0,r.jsx)(n.td,{children:"dict"}),(0,r.jsx)(n.td,{children:"\u5d4c\u5165\u6a21\u578b\u914d\u7f6e\uff08api_base, api_key, api_version)"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"milvus_text_field"})}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsx)(n.td,{children:"\u5305\u542b\u6587\u672c\u5185\u5bb9\u7684\u5b57\u6bb5\u540d\u79f0"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"api_key"})}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsxs)(n.td,{children:["\u4f60\u7684 Milvus API \u5bc6\u94a5 (\u6216\u8bbe\u7f6e ",(0,r.jsx)(n.code,{children:"MILVUS_API_KEY"})," \u73af\u5883\u53d8\u91cf)"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"api_base"})}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsxs)(n.td,{children:["\u4f60\u7684 Milvus API \u57fa\u7840 URL (\u6216\u8bbe\u7f6e ",(0,r.jsx)(n.code,{children:"MILVUS_API_BASE"})," \u73af\u5883\u53d8\u91cf)"]})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"\u53ef\u9009\u53c2\u6570",children:"\u53ef\u9009\u53c2\u6570"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"\u53c2\u6570"}),(0,r.jsx)(n.th,{children:"\u7c7b\u578b"}),(0,r.jsx)(n.th,{children:"\u63cf\u8ff0"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"dbName"})}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsx)(n.td,{children:'\u6570\u636e\u5e93\u540d\u79f0\uff08\u9ed8\u8ba4\u503c\uff1a "default"\uff09'})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"annsField"})}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsx)(n.td,{children:'\u641c\u7d22\u7684\u5411\u91cf\u5b57\u6bb5\u540d\u79f0\uff08\u9ed8\u8ba4\u503c\uff1a "book_intro_vector"\uff09'})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"limit"})}),(0,r.jsx)(n.td,{children:"integer"}),(0,r.jsx)(n.td,{children:"\u8fd4\u56de\u7684\u6700\u5927\u7ed3\u679c\u6570\u91cf"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"offset"})}),(0,r.jsx)(n.td,{children:"integer"}),(0,r.jsx)(n.td,{children:"\u5206\u9875\u504f\u79fb\u91cf"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"filter"})}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsx)(n.td,{children:"\u5143\u6570\u636e\u8fc7\u6ee4\u8868\u8fbe\u5f0f"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"groupingField"})}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsx)(n.td,{children:"\u7ed3\u679c\u5206\u7ec4\u5b57\u6bb5"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"outputFields"})}),(0,r.jsx)(n.td,{children:"list"}),(0,r.jsx)(n.td,{children:"\u7ed3\u679c\u4e2d\u8981\u8fd4\u56de\u7684\u5b57\u6bb5\u5217\u8868"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"searchParams"})}),(0,r.jsx)(n.td,{children:"dict"}),(0,r.jsx)(n.td,{children:"\u641c\u7d22\u53c2\u6570\uff0c\u4f8b\u5982\u5ea6\u91cf\u7c7b\u578b\u548c\u641c\u7d22\u53c2\u6570"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"partitionNames"})}),(0,r.jsx)(n.td,{children:"list"}),(0,r.jsx)(n.td,{children:"\u8981\u641c\u7d22\u7684\u5206\u533a\u540d\u79f0\u5217\u8868"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"consistencyLevel"})}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsx)(n.td,{children:"\u641c\u7d22\u7684\u4e00\u81f4\u6027\u7ea7\u522b"})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"\u652f\u6301\u7684\u529f\u80fd",children:"\u652f\u6301\u7684\u529f\u80fd"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"\u529f\u80fd"}),(0,r.jsx)(n.th,{children:"\u72b6\u6001"}),(0,r.jsx)(n.th,{children:"\u5907\u6ce8"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"\u65e5\u5fd7\u8bb0\u5f55"}),(0,r.jsx)(n.td,{children:"\u2705 \u652f\u6301"}),(0,r.jsx)(n.td,{children:"\u5b8c\u6574\u7684\u65e5\u5fd7\u652f\u6301"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"\u4fdd\u62a4\u62a4\u680f"}),(0,r.jsx)(n.td,{children:"\u274c \u5c1a\u672a\u652f\u6301"}),(0,r.jsx)(n.td,{children:"\u5411\u91cf\u5b58\u50a8\u4e0d\u652f\u6301\u4fdd\u62a4\u62a4\u680f"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"\u6210\u672c\u8ddf\u8e2a"}),(0,r.jsx)(n.td,{children:"\u2705 \u652f\u6301"}),(0,r.jsx)(n.td,{children:"Milvus \u641c\u7d22\u6210\u672c\u4e3a $0"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"\u7edf\u4e00 API"}),(0,r.jsx)(n.td,{children:"\u2705 \u652f\u6301"}),(0,r.jsxs)(n.td,{children:["\u8c03\u7528\u517c\u5bb9 OpenAI \u7684 ",(0,r.jsx)(n.code,{children:"/v1/vector_stores/search"})," \u7aef\u70b9"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"\u900f\u4f20"}),(0,r.jsx)(n.td,{children:"\u2705 \u652f\u6301"}),(0,r.jsx)(n.td,{children:"\u4f7f\u7528\u539f\u751f\u7684 Milvus API \u683c\u5f0f"})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"\u54cd\u5e94\u683c\u5f0f",children:"\u54cd\u5e94\u683c\u5f0f"}),"\n",(0,r.jsx)(n.p,{children:"\u54cd\u5e94\u9075\u5faa\u6807\u51c6 LiteLLM \u5411\u91cf\u5b58\u50a8\u683c\u5f0f\uff1a"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "object": "vector_store.search_results.page",\n  "search_query": "What is the capital of France?",\n  "data": [\n    {\n      "score": 0.95,\n      "content": [\n        {\n          "text": "Paris is the capital of France...",\n          "type": "text"\n        }\n      ],\n      "file_id": null,\n      "filename": null,\n      "attributes": {\n        "id": "123",\n        "title": "France Geography"\n      }\n    }\n  ]\n}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"\u539f\u751f-api-\u539f\u751f-milvus-\u683c\u5f0f",children:"\u539f\u751f API (\u539f\u751f Milvus \u683c\u5f0f)"}),"\n",(0,r.jsxs)(n.p,{children:["\u4f7f\u7528\u6b64\u529f\u80fd\uff0c\u5f00\u53d1\u8005\u53ef\u4ee5 ",(0,r.jsx)(n.strong,{children:"\u521b\u5efa"})," \u548c ",(0,r.jsx)(n.strong,{children:"\u641c\u7d22"})," \u5411\u91cf\u5b58\u50a8\uff0c\u800c\u65e0\u9700\u63d0\u4f9b Milvus \u51ed\u8bc1\u3002"]}),"\n",(0,r.jsx)(n.p,{children:"\u4ec5\u9002\u7528\u4e8e\u4ee3\u7406\u3002"}),"\n",(0,r.jsx)(n.h3,{id:"\u7ba1\u7406\u5458\u6d41\u7a0b",children:"\u7ba1\u7406\u5458\u6d41\u7a0b"}),"\n",(0,r.jsx)(n.h4,{id:"1-\u5c06\u5411\u91cf\u5b58\u50a8\u6dfb\u52a0\u5230-litellm",children:"1. \u5c06\u5411\u91cf\u5b58\u50a8\u6dfb\u52a0\u5230 LiteLLM"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:'model_list:  \n  - model_name: embedding-model\n    litellm_params:\n      model: azure/text-embedding-3-large\n      api_base: https://your-endpoint.cognitiveservices.azure.com/\n      api_key: os.environ/AZURE_API_KEY\n      api_version: "2025-09-01"\n\nvector_store_registry:\n  - vector_store_name: "milvus-store"\n    litellm_params:\n      vector_store_id: "can-be-anything" # \u5411\u91cf\u5b58\u50a8 id \u53ef\u4ee5\u662f\u4efb\u4f55\u503c\uff0c\u7528\u4e8e\u900f\u4f20 API\n      custom_llm_provider: "milvus"\n      api_key: os.environ/MILVUS_API_KEY\n      api_base: https://your-milvus-instance.milvus.io\n\ngeneral_settings:\n    database_url: "postgresql://user:password@host:port/database"\n    master_key: "sk-1234"\n'})}),"\n",(0,r.jsx)(n.p,{children:"\u5c06\u5411\u91cf\u5b58\u50a8\u51ed\u8bc1\u6dfb\u52a0\u5230 LiteLLM\u3002"}),"\n",(0,r.jsx)(n.h4,{id:"2-\u542f\u52a8\u4ee3\u7406",children:"2. \u542f\u52a8\u4ee3\u7406"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"litellm --config /path/to/config.yaml\n\n# \u8fd0\u884c\u5728 http://0.0.0.0:4000\n"})}),"\n",(0,r.jsx)(n.h4,{id:"3-\u521b\u5efa\u865a\u62df\u7d22\u5f15",children:"3. \u521b\u5efa\u865a\u62df\u7d22\u5f15"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'curl -L -X POST \'http://0.0.0.0:4000/v1/indexes\' \\\n-H \'Content-Type: application/json\' \\\n-H \'Authorization: Bearer sk-1234\' \\\n-d \'{ \n    "index_name": "dall-e-6",\n    "litellm_params": {\n        "vector_store_index": "real-collection-name",\n        "vector_store_name": "milvus-store"\n    }\n}\'\n'})}),"\n",(0,r.jsx)(n.p,{children:"\u8fd9\u662f\u4e00\u4e2a\u865a\u62df\u7d22\u5f15\uff0c\u5f00\u53d1\u8005\u53ef\u4ee5\u4f7f\u7528\u5b83\u6765\u521b\u5efa\u548c\u641c\u7d22\u5411\u91cf\u5b58\u50a8\u3002"}),"\n",(0,r.jsx)(n.h4,{id:"4-\u521b\u5efa\u5177\u6709\u5411\u91cf\u5b58\u50a8\u6743\u9650\u7684\u5bc6\u94a5",children:"4. \u521b\u5efa\u5177\u6709\u5411\u91cf\u5b58\u50a8\u6743\u9650\u7684\u5bc6\u94a5"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'curl -L -X POST \'http://0.0.0.0:4000/key/generate\' \\\n-H \'Content-Type: application/json\' \\\n-H \'Authorization: Bearer sk-1234\' \\\n-d \'{\n    "allowed_vector_store_indexes": [{"index_name": "dall-e-6", "index_permissions": ["write", "read"]}],\n    "models": ["embedding-model"]\n}\'\n'})}),"\n",(0,r.jsx)(n.p,{children:"\u7ed9\u5bc6\u94a5\u8bbf\u95ee\u865a\u62df\u7d22\u5f15\u548c\u5d4c\u5165\u6a21\u578b\u7684\u6743\u9650\u3002"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\u9884\u671f\u54cd\u5e94"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n    "key": "sk-my-virtual-key"\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"\u5f00\u53d1\u8005\u6d41\u7a0b",children:"\u5f00\u53d1\u8005\u6d41\u7a0b"}),"\n",(0,r.jsx)(n.h4,{id:"milvusrestclient",children:"MilvusRESTClient"}),"\n",(0,r.jsxs)(n.p,{children:["\u8981\u4f7f\u7528\u900f\u4f20 API\uff0c\u4f60\u9700\u8981\u4e00\u4e2a\u7b80\u5355\u7684 REST \u5ba2\u6237\u7aef\u3002\u5c06\u4ee5\u4e0b ",(0,r.jsx)(n.code,{children:"milvus_rest_client.py"})," \u6587\u4ef6\u590d\u5236\u5230\u4f60\u7684\u9879\u76ee\u4e2d\uff1a"]}),"\n",(0,r.jsxs)(i,{children:[(0,r.jsx)("summary",{children:"\u70b9\u51fb\u5c55\u5f00 milvus_rest_client.py"}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'"""\n\u57fa\u4e8e\uff1ahttps://milvus.io/api-reference/restful/v2.6.x/\n\u7b80\u5355 Milvus REST API v2 \u5ba2\u6237\u7aef\n"""\n\nimport requests\nfrom typing import List, Dict, Any, Optional\n\n\nclass DataType:\n    """Milvus \u6570\u636e\u7c7b\u578b"""\n\n    INT64 = "Int64"\n    FLOAT_VECTOR = "FloatVector"\n    VARCHAR = "VarChar"\n    BOOL = "Bool"\n    FLOAT = "Float"\n\n\nclass CollectionSchema:\n    """\u96c6\u5408\u6a21\u5f0f\u6784\u5efa\u5668"""\n\n    def __init__(self):\n        self.fields = []\n\n    def add_field(\n        self,\n        field_name: str,\n        data_type: str,\n        is_primary: bool = False,\n        dim: Optional[int] = None,\n        description: str = "",\n    ):\n        """\u6dfb\u52a0\u5b57\u6bb5\u5230\u6a21\u5f0f"""\n        field = {\n            "fieldName": field_name,\n            "dataType": data_type,\n            "isPrimary": is_primary,\n            "description": description,\n        }\n        if data_type == DataType.FLOAT_VECTOR and dim:\n            field["elementTypeParams"] = {"dim": str(dim)}\n        self.fields.append(field)\n        return self\n\n    def to_dict(self):\n        """\u5c06\u6a21\u5f0f\u8f6c\u6362\u4e3a API \u6240\u9700\u7684\u5b57\u5178\u683c\u5f0f"""\n        return {"fields": self.fields}\n\n\nclass IndexParams:\n    """\u7d22\u5f15\u53c2\u6570\u6784\u5efa\u5668"""\n\n    def __init__(self):\n        self.indexes = []\n\n    def add_index(\n        self, field_name: str, metric_type: str = "L2", index_name: Optional[str] = None\n    ):\n        """\u6dfb\u52a0\u7d22\u5f15"""\n        index = {\n            "fieldName": field_name,\n            "indexName": index_name or f"{field_name}_index",\n            "metricType": metric_type,\n        }\n        self.indexes.append(index)\n        return self\n\n    def to_list(self):\n        """\u5c06\u53c2\u6570\u8f6c\u6362\u4e3a API \u6240\u9700\u7684\u5217\u8868\u683c\u5f0f"""\n        return self.indexes\n\n\nclass MilvusRESTClient:\n    """\n    \u7b80\u5355 Milvus REST API v2 \u5ba2\u6237\u7aef\n\n    \u53c2\u8003\uff1ahttps://milvus.io/api-reference/restful/v2.6.x/\n    """\n\n    def __init__(self, uri: str, token: str, db_name: str = "default"):\n        """\n        \u521d\u59cb\u5316 Milvus REST \u5ba2\u6237\u7aef\n\n        \u53c2\u6570\uff1a\n            uri: Milvus \u670d\u52a1\u5668 URI\uff08\u4f8b\u5982\uff0chttp://localhost:19530\uff09\n            token: \u8ba4\u8bc1\u4ee4\u724c\n            db_name: \u6570\u636e\u5e93\u540d\u79f0\n        """\n        self.base_url = uri.rstrip("/")\n        self.token = token\n        self.db_name = db_name\n        self.headers = {\n            "Authorization": f"Bearer {token}",\n            "Content-Type": "application/json",\n        }\n\n    def _make_request(self, endpoint: str, data: Dict[str, Any]) -> Dict[str, Any]:\n        """\u5411 Milvus API \u53d1\u9001 POST \u8bf7\u6c42"""\n        url = f"{self.base_url}{endpoint}"\n\n        # \u5982\u679c\u6ca1\u6709\u5728\u6570\u636e\u4e2d\u5305\u542b dbName \u4e14\u4e0d\u662f\u9ed8\u8ba4\u503c\uff0c\u5219\u6dfb\u52a0\n        if "dbName" not in data and self.db_name != "default":\n            data["dbName"] = self.db_name\n\n        try:\n            response = requests.post(url, json=data, headers=self.headers)\n            response.raise_for_status()\n        except requests.exceptions.HTTPError as e:\n            print(f"e.response.text: {e.response.content}")\n            raise e\n\n        result = response.json()\n\n        # \u68c0\u67e5 API \u9519\u8bef\n        if result.get("code") != 0:\n            raise Exception(\n                f"Milvus API Error: {result.get(\'message\', \'Unknown error\')}"\n            )\n\n        return result\n\n    def has_collection(self, collection_name: str) -> bool:\n        """\n        \u68c0\u67e5\u96c6\u5408\u662f\u5426\u5b58\u5728\n\n        \u53c2\u8003\uff1ahttps://milvus.io/api-reference/restful/v2.6.x/v2/Collection%20(v2)/Has.md\n        """\n        try:\n            result = self._make_request(\n                "/v2/vectordb/collections/has", {"collectionName": collection_name}\n            )\n            return result.get("data", {}).get("has", False)\n        except Exception:\n            return False\n\n    def drop_collection(self, collection_name: str):\n        """\n        \u5220\u9664\u96c6\u5408\n\n        \u53c2\u8003\uff1ahttps://milvus.io/api-reference/restful/v2.6.x/v2/Collection%20(v2)/Drop.md\n        """\n        return self._make_request(\n            "/v2/vectordb/collections/drop", {"collectionName": collection_name}\n        )\n\n    def create_schema(self) -> CollectionSchema:\n        """\u521b\u5efa\u65b0\u7684\u96c6\u5408\u6a21\u5f0f"""\n        return CollectionSchema()\n\n    def prepare_index_params(self) -> IndexParams:\n        """\u51c6\u5907\u7d22\u5f15\u53c2\u6570"""\n        return IndexParams()\n\n    def create_collection(\n        self,\n        collection_name: str,\n        schema: CollectionSchema,\n        index_params: Optional[IndexParams] = None,\n    ):\n        """\n        \u521b\u5efa\u96c6\u5408\n\n        \u53c2\u8003\uff1ahttps://milvus.io/api-reference/restful/v2.6.x/v2/Collection%20(v2)/Create.md\n        """\n        data = {"collectionName": collection_name, "schema": schema.to_dict()}\n\n        if index_params:\n            data["indexParams"] = index_params.to_list()\n\n        return self._make_request("/v2/vectordb/collections/create", data)\n\n    def describe_collection(self, collection_name: str) -> Dict[str, Any]:\n        """\n        \u63cf\u8ff0\u96c6\u5408\n\n        \u53c2\u8003\uff1ahttps://milvus.io/api-reference/restful/v2.6.x/v2/Collection%20(v2)/Describe.md\n        """\n        result = self._make_request(\n            "/v2/vectordb/collections/describe", {"collectionName": collection_name}\n        )\n        return result.get("data", {})\n\n    def insert(\n        self,\n        collection_name: str,\n        data: List[Dict[str, Any]],\n        partition_name: Optional[str] = None,\n    ):\n        """\n        \u5411\u96c6\u5408\u63d2\u5165\u6570\u636e\n\n        \u53c2\u8003\uff1ahttps://milvus.io/api-reference/restful/v2.6.x/v2/Vector%20(v2)/Insert.md\n        """\n        payload = {"collectionName": collection_name, "data": data}\n\n        if partition_name:\n            payload["partitionName"] = partition_name\n\n        result = self._make_request("/v2/vectordb/entities/insert", payload)\n        return result.get("data", {})\n\n    def flush(self, collection_name: str):\n        """\n        \u5c06\u96c6\u5408\u6570\u636e\u5237\u65b0\u5230\u5b58\u50a8\n\n        \u53c2\u8003\uff1ahttps://milvus.io/api-reference/restful/v2.6.x/v2/Collection%20(v2)/Flush.md\n        """\n        return self._make_request(\n            "/v2/vectordb/collections/flush", {"collectionName": collection_name}\n        )\n\n    def search(\n        self,\n        collection_name: str,\n        data: List[List[float]],\n        anns_field: str,\n        limit: int = 10,\n        search_params: Optional[Dict[str, Any]] = None,\n        output_fields: Optional[List[str]] = None,\n    ) -> List[List[Dict]]:\n        """\n        \u641c\u7d22\u5411\u91cf\n\n        \u53c2\u8003\uff1ahttps://milvus.io/api-reference/restful/v2.6.x/v2/Vector%20(v2)/Search.md\n        """\n        payload = {\n            "collectionName": collection_name,\n            "data": data,\n            "annsField": anns_field,\n            "limit": limit,\n        }\n\n        if search_params:\n            payload["searchParams"] = search_params\n\n        if output_fields:\n            payload["outputFields"] = output_fields\n\n        result = self._make_request("/v2/vectordb/entities/search", payload)\n        return result.get("data", [])\n'})})]}),"\n",(0,r.jsx)(n.h4,{id:"1-\u521b\u5efa\u5177\u6709\u6a21\u5f0f\u7684\u96c6\u5408",children:"1. \u521b\u5efa\u5177\u6709\u6a21\u5f0f\u7684\u96c6\u5408"}),"\n",(0,r.jsxs)(n.p,{children:["\u6ce8\u610f\uff1a\u4f7f\u7528\u4f60\u914d\u7f6e\u4e2d ",(0,r.jsx)(n.code,{children:"milvus"})," \u63d0\u4f9b\u5546\u6240\u4f7f\u7528\u7684 ",(0,r.jsx)(n.code,{children:"/milvus"})," \u7aef\u70b9\u3002"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'from milvus_rest_client import MilvusRESTClient, DataType  # \u4f7f\u7528\u4e0a\u9762\u7684\u5ba2\u6237\u7aef\nimport random\nimport time\n\n# \u914d\u7f6e\nuri = "http://0.0.0.0:4000/milvus"  # \u91cd\u8981\uff1a\u4f7f\u7528 `/milvus` \u7aef\u70b9\u8fdb\u884c\u900f\u4f20\ntoken = "sk-my-virtual-key"\ncollection_name = "dall-e-6"  # \u865a\u62df\u7d22\u5f15\u540d\u79f0\n\n# \u521d\u59cb\u5316\u5ba2\u6237\u7aef\nmilvus_client = MilvusRESTClient(uri=uri, token=token)\nprint(f"\u6210\u529f\u8fde\u63a5\u5230\u6570\u636e\u5e93: {uri}")\n\n# \u68c0\u67e5\u96c6\u5408\u662f\u5426\u5b58\u5728\u5e76\u5220\u9664\u5df2\u6709\u7684\u96c6\u5408\ncheck_collection = milvus_client.has_collection(collection_name)\nif check_collection:\n    milvus_client.drop_collection(collection_name)\n    print(f"\u6210\u529f\u5220\u9664\u73b0\u6709\u96c6\u5408 {collection_name}")\n\n# \u5b9a\u4e49\u6a21\u5f0f\ndim = 64  # \u5411\u91cf\u7ef4\u5ea6\n\nprint("\u5f00\u59cb\u521b\u5efa\u96c6\u5408\u6a21\u5f0f")\nschema = milvus_client.create_schema()\nschema.add_field(\n    "book_id", DataType.INT64, is_primary=True, description="\u81ea\u5b9a\u4e49\u4e3b\u952e"\n)\nschema.add_field("word_count", DataType.INT64, description="\u8bcd\u6570")\nschema.add_field(\n    "book_intro", DataType.FLOAT_VECTOR, dim=dim, description="\u4e66\u7c4d\u7b80\u4ecb"\n)\n\n# \u51c6\u5907\u7d22\u5f15\u53c2\u6570\nprint("\u5f00\u59cb\u51c6\u5907\u9ed8\u8ba4 AUTOINDEX \u7d22\u5f15\u53c2\u6570")\nindex_params = milvus_client.prepare_index_params()\nindex_params.add_index("book_intro", metric_type="L2")\n\n# \u521b\u5efa\u96c6\u5408\nprint(f"\u5f00\u59cb\u521b\u5efa\u793a\u4f8b\u96c6\u5408: {collection_name}")\nmilvus_client.create_collection(\n    collection_name, schema=schema, index_params=index_params\n)\ncollection_property = milvus_client.describe_collection(collection_name)\nprint("\u96c6\u5408\u8be6\u7ec6\u4fe1\u606f: %s" % collection_property)\n'})}),"\n",(0,r.jsx)(n.h4,{id:"2-\u5411\u96c6\u5408\u63d2\u5165\u6570\u636e",children:"2. \u5411\u96c6\u5408\u63d2\u5165\u6570\u636e"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'# \u4f7f\u7528\u81ea\u5b9a\u4e49 ID \u63d2\u5165\u6570\u636e\nnb = 1000\ninsert_rounds = 2\nstart = 0  # \u7b2c\u4e00\u4e2a\u4e3b\u952e id\ntotal_rt = 0  # \u63d2\u5165\u7684\u603b\u54cd\u5e94\u65f6\u95f4\n\nprint(\n    f"\u5f00\u59cb\u5411\u793a\u4f8b\u96c6\u5408 {collection_name} \u63d2\u5165 {nb*insert_rounds} \u6761\u5b9e\u4f53"\n)\nfor i in range(insert_rounds):\n    vector = [random.random() for _ in range(dim)]\n    rows = [\n        {"book_id": i, "word_count": random.randint(1, 100), "book_intro": vector}\n        for i in range(start, start + nb)\n    ]\n    t0 = time.time()\n    milvus_client.insert(collection_name, rows)\n    ins_rt = time.time() - t0\n    start += nb\n    total_rt += ins_rt\nprint(f"\u63d2\u5165\u5b8c\u6210\uff0c\u8017\u65f6 {round(total_rt, 4)} \u79d2")\n\n# \u5237\u65b0\u96c6\u5408\nprint("\u5f00\u59cb\u5237\u65b0")\nstart_flush = time.time()\nmilvus_client.flush(collection_name)\nend_flush = time.time()\nprint(f"\u5237\u65b0\u5b8c\u6210\uff0c\u8017\u65f6 {round(end_flush - start_flush, 4)} \u79d2")\n'})}),"\n",(0,r.jsx)(n.h4,{id:"3-\u641c\u7d22\u96c6\u5408",children:"3. \u641c\u7d22\u96c6\u5408"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'# \u641c\u7d22\u914d\u7f6e\nnq = 3  # \u67e5\u8be2\u5411\u91cf\u7684\u6570\u91cf\nsearch_params = {"metric_type": "L2", "params": {"level": 2}}\nlimit = 2  # \u8fd4\u56de\u7684\u7ed3\u679c\u6570\u91cf\n\n# \u6267\u884c\u641c\u7d22\nfor i in range(5):\n    search_vectors = [[random.random() for _ in range(dim)] for _ in range(nq)]\n    t0 = time.time()\n    results = milvus_client.search(\n        collection_name,\n        data=search_vectors,\n        limit=limit,\n        search_params=search_params,\n        anns_field="book_intro",\n    )\n    t1 = time.time()\n    print(f"\u641c\u7d22 {i} \u7ed3\u679c: {results}")\n    print(f"\u641c\u7d22 {i} \u5ef6\u8fdf: {round(t1-t0, 4)} \u79d2")\n'})}),"\n",(0,r.jsx)(n.h4,{id:"\u5b8c\u6574\u793a\u4f8b",children:"\u5b8c\u6574\u793a\u4f8b"}),"\n",(0,r.jsx)(n.p,{children:"\u8fd9\u91cc\u662f\u5b8c\u6574\u7684\u8fd0\u884c\u793a\u4f8b\uff1a"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'from milvus_rest_client import MilvusRESTClient, DataType  # \u4f7f\u7528\u4e0a\u9762\u7684\u5ba2\u6237\u7aef\nimport random\nimport time\n\n# ----------------------------\n# \ud83d\udd10 \u914d\u7f6e\n# ----------------------------\nuri = "http://0.0.0.0:4000/milvus"  # \u91cd\u8981\uff1a\u4f7f\u7528 `/milvus` \u7aef\u70b9\ntoken = "sk-my-virtual-key"\ncollection_name = "dall-e-6"  # \u4f60\u7684\u865a\u62df\u7d22\u5f15\u540d\u79f0\n\n# ----------------------------\n# \ud83d\udccb \u7b2c\u4e00\u6b65 \u2014 \u521d\u59cb\u5316\u5ba2\u6237\u7aef\n# ----------------------------\nmilvus_client = MilvusRESTClient(uri=uri, token=token)\nprint(f"\u2705 \u6210\u529f\u8fde\u63a5\u5230\u6570\u636e\u5e93: {uri}")\n\n# ----------------------------\n# \ud83d\uddd1\ufe0f  \u7b2c\u4e8c\u6b65 \u2014 \u5220\u9664\u73b0\u6709\u96c6\u5408\uff08\u5982\u679c\u9700\u8981\uff09\n# ----------------------------\ncheck_collection = milvus_client.has_collection(collection_name)\nif check_collection:\n    milvus_client.drop_collection(collection_name)\n    print(f"\ud83d\uddd1\ufe0f  \u6210\u529f\u5220\u9664\u73b0\u6709\u96c6\u5408 {collection_name}")\n\n# ----------------------------\n# \ud83d\udcd0 \u7b2c\u4e09\u6b65 \u2014 \u521b\u5efa\u96c6\u5408\u6a21\u5f0f\n# ----------------------------\ndim = 64  # \u5411\u91cf\u7ef4\u5ea6\n\nprint("\ud83d\udcd0 \u5f00\u59cb\u521b\u5efa\u96c6\u5408\u6a21\u5f0f")\nschema = milvus_client.create_schema()\nschema.add_field(\n    "book_id", DataType.INT64, is_primary=True, description="\u81ea\u5b9a\u4e49\u4e3b\u952e"\n)\nschema.add_field("word_count", DataType.INT64, description="\u8bcd\u6570")\nschema.add_field(\n    "book_intro", DataType.FLOAT_VECTOR, dim=dim, description="\u4e66\u7c4d\u7b80\u4ecb"\n)\n\n# ----------------------------\n# \ud83d\udd0d \u7b2c\u56db\u6b65 \u2014 \u521b\u5efa\u7d22\u5f15\n# ----------------------------\nprint("\ud83d\udd0d \u5f00\u59cb\u51c6\u5907\u9ed8\u8ba4 AUTOINDEX \u7d22\u5f15\u53c2\u6570")\nindex_params = milvus_client.prepare_index_params()\nindex_params.add_index("book_intro", metric_type="L2")\n\n# ----------------------------\n# \ud83c\udfd7\ufe0f  \u7b2c\u4e94\u6b65 \u2014 \u521b\u5efa\u96c6\u5408\n# ----------------------------\nprint(f"\ud83c\udfd7\ufe0f  \u5f00\u59cb\u521b\u5efa\u96c6\u5408: {collection_name}")\nmilvus_client.create_collection(\n    collection_name, schema=schema, index_params=index_params\n)\ncollection_property = milvus_client.describe_collection(collection_name)\nprint(f"\u2705 \u96c6\u5408\u5df2\u521b\u5efa\uff1a{collection_property}")\n\n# ----------------------------\n# \ud83d\udce4 \u7b2c\u516d\u6b65 \u2014 \u63d2\u5165\u6570\u636e\n# ----------------------------\nnb = 1000\ninsert_rounds = 2\nstart = 0\ntotal_rt = 0\n\nprint(f"\ud83d\udce4 \u5f00\u59cb\u5411\u96c6\u5408 {collection_name} \u63d2\u5165 {nb*insert_rounds} \u6761\u5b9e\u4f53")\nfor i in range(insert_rounds):\n    vector = [random.random() for _ in range(dim)]\n    rows = [\n        {"book_id": i, "word_count": random.randint(1, 100), "book_intro": vector}\n        for i in range(start, start + nb)\n    ]\n    t0 = time.time()\n    milvus_client.insert(collection_name, rows)\n    ins_rt = time.time() - t0\n    start += nb\n    total_rt += ins_rt\nprint(f"\u2705 \u63d2\u5165\u5b8c\u6210\uff0c\u8017\u65f6 {round(total_rt, 4)} \u79d2")\n\n# ----------------------------\n# \ud83d\udcbe \u7b2c\u4e03\u6b65 \u2014 \u5237\u65b0\u96c6\u5408\n# ----------------------------\nprint("\ud83d\udcbe \u5f00\u59cb\u5237\u65b0\u96c6\u5408")\nstart_flush = time.time()\nmilvus_client.flush(collection_name)\nend_flush = time.time()\nprint(f"\u2705 \u5237\u65b0\u5b8c\u6210\uff0c\u8017\u65f6 {round(end_flush - start_flush, 4)} \u79d2")\n\n# ----------------------------\n# \ud83d\udd0d \u7b2c\u516b\u6b65 \u2014 \u641c\u7d22\n# ----------------------------\nnq = 3\nsearch_params = {"metric_type": "L2", "params": {"level": 2}}\nlimit = 2\n\nprint(f"\ud83d\udd0d \u5f00\u59cb\u6267\u884c {5} \u6b21\u641c\u7d22\u64cd\u4f5c")\nfor i in range(5):\n    search_vectors = [[random.random() for _ in range(dim)] for _ in range(nq)]\n    t0 = time.time()\n    results = milvus_client.search(\n        collection_name,\n        data=search_vectors,\n        limit=limit,\n        search_params=search_params,\n        anns_field="book_intro",\n    )\n    t1 = time.time()\n    print(f"\u2705 \u641c\u7d22 {i} \u7ed3\u679c: {results}")\n    print(f"   \u641c\u7d22 {i} \u5ef6\u8fdf: {round(t1-t0, 4)} \u79d2")\n'})}),"\n",(0,r.jsx)(n.h2,{id:"\u8fd0\u4f5c\u65b9\u5f0f",children:"\u8fd0\u4f5c\u65b9\u5f0f"}),"\n",(0,r.jsx)(n.p,{children:"\u5f53\u4f60\u641c\u7d22\u65f6\uff1a"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"LiteLLM \u4f7f\u7528\u4f60\u6307\u5b9a\u7684\u5d4c\u5165\u6a21\u578b\u5c06\u67e5\u8be2\u8f6c\u6362\u4e3a\u5411\u91cf"}),"\n",(0,r.jsxs)(n.li,{children:["\u5b83\u901a\u8fc7 ",(0,r.jsx)(n.code,{children:"/v2/vectordb/entities/search"})," \u7aef\u70b9\u5c06\u5411\u91cf\u53d1\u9001\u5230\u4f60\u7684 Milvus \u5b9e\u4f8b"]}),"\n",(0,r.jsx)(n.li,{children:"Milvus \u5728\u4f60\u7684\u96c6\u5408\u4e2d\u4f7f\u7528\u5411\u91cf\u76f8\u4f3c\u5ea6\u641c\u7d22\u627e\u5230\u6700\u76f8\u5173\u7684\u6587\u6863"}),"\n",(0,r.jsx)(n.li,{children:"\u7ed3\u679c\u8fd4\u56de\u5e26\u6709\u8ddd\u79bb\u8bc4\u5206"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"\u5d4c\u5165\u6a21\u578b\u53ef\u4ee5\u662f LiteLLM \u652f\u6301\u7684\u4efb\u4f55\u6a21\u578b - Azure OpenAI, OpenAI, Bedrock \u7b49\u3002"})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(m,{...e})}):m(e)}}}]);