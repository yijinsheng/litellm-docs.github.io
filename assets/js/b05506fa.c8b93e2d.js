"use strict";(globalThis.webpackChunkmy_website=globalThis.webpackChunkmy_website||[]).push([[65578],{7227(e,n,l){l.d(n,{A:()=>d});l(96540);var s=l(18215);const i="tabItem_Ymn6";var r=l(74848);function d({children:e,hidden:n,className:l}){return(0,r.jsx)("div",{role:"tabpanel",className:(0,s.A)(i,l),hidden:n,children:e})}},28453(e,n,l){l.d(n,{R:()=>d,x:()=>t});var s=l(96540);const i={},r=s.createContext(i);function d(e){const n=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:d(e.components),s.createElement(r.Provider,{value:n},e.children)}},49489(e,n,l){l.d(n,{A:()=>y});var s=l(96540),i=l(18215),r=l(24245),d=l(56347),t=l(36494),a=l(62814),c=l(45167),o=l(69900);function h(e){return s.Children.toArray(e).filter(e=>"\n"!==e).map(e=>{if(!e||(0,s.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})?.filter(Boolean)??[]}function u(e){const{values:n,children:l}=e;return(0,s.useMemo)(()=>{const e=n??function(e){return h(e).map(({props:{value:e,label:n,attributes:l,default:s}})=>({value:e,label:n,attributes:l,default:s}))}(l);return function(e){const n=(0,c.XI)(e,(e,n)=>e.value===n.value);if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map(e=>e.value).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e},[n,l])}function j({value:e,tabValues:n}){return n.some(n=>n.value===e)}function x({queryString:e=!1,groupId:n}){const l=(0,d.W6)(),i=function({queryString:e=!1,groupId:n}){if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:e,groupId:n});return[(0,a.aZ)(i),(0,s.useCallback)(e=>{if(!i)return;const n=new URLSearchParams(l.location.search);n.set(i,e),l.replace({...l.location,search:n.toString()})},[i,l])]}function _(e){const{defaultValue:n,queryString:l=!1,groupId:i}=e,r=u(e),[d,a]=(0,s.useState)(()=>function({defaultValue:e,tabValues:n}){if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!j({value:e,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${n.map(e=>e.value).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}const l=n.find(e=>e.default)??n[0];if(!l)throw new Error("Unexpected error: 0 tabValues");return l.value}({defaultValue:n,tabValues:r})),[c,h]=x({queryString:l,groupId:i}),[_,m]=function({groupId:e}){const n=function(e){return e?`docusaurus.tab.${e}`:null}(e),[l,i]=(0,o.Dv)(n);return[l,(0,s.useCallback)(e=>{n&&i.set(e)},[n,i])]}({groupId:i}),p=(()=>{const e=c??_;return j({value:e,tabValues:r})?e:null})();(0,t.A)(()=>{p&&a(p)},[p]);return{selectedValue:d,selectValue:(0,s.useCallback)(e=>{if(!j({value:e,tabValues:r}))throw new Error(`Can't select invalid tab value=${e}`);a(e),h(e),m(e)},[h,m,r]),tabValues:r}}var m=l(11062);const p="tabList__CuJ",g="tabItem_LNqP";var w=l(74848);function b({className:e,block:n,selectedValue:l,selectValue:s,tabValues:d}){const t=[],{blockElementScrollPositionUntilNextRender:a}=(0,r.a_)(),c=e=>{const n=e.currentTarget,i=t.indexOf(n),r=d[i].value;r!==l&&(a(n),s(r))},o=e=>{let n=null;switch(e.key){case"Enter":c(e);break;case"ArrowRight":{const l=t.indexOf(e.currentTarget)+1;n=t[l]??t[0];break}case"ArrowLeft":{const l=t.indexOf(e.currentTarget)-1;n=t[l]??t[t.length-1];break}}n?.focus()};return(0,w.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,i.A)("tabs",{"tabs--block":n},e),children:d.map(({value:e,label:n,attributes:s})=>(0,w.jsx)("li",{role:"tab",tabIndex:l===e?0:-1,"aria-selected":l===e,ref:e=>{t.push(e)},onKeyDown:o,onClick:c,...s,className:(0,i.A)("tabs__item",g,s?.className,{"tabs__item--active":l===e}),children:n??e},e))})}function v({lazy:e,children:n,selectedValue:l}){const r=(Array.isArray(n)?n:[n]).filter(Boolean);if(e){const e=r.find(e=>e.props.value===l);return e?(0,s.cloneElement)(e,{className:(0,i.A)("margin-top--md",e.props.className)}):null}return(0,w.jsx)("div",{className:"margin-top--md",children:r.map((e,n)=>(0,s.cloneElement)(e,{key:n,hidden:e.props.value!==l}))})}function f(e){const n=_(e);return(0,w.jsxs)("div",{className:(0,i.A)("tabs-container",p),children:[(0,w.jsx)(b,{...n,...e}),(0,w.jsx)(v,{...n,...e})]})}function y(e){const n=(0,m.A)();return(0,w.jsx)(f,{...e,children:h(e.children)},String(n))}},57647(e,n,l){l.r(n),l.d(n,{assets:()=>o,contentTitle:()=>c,default:()=>j,frontMatter:()=>a,metadata:()=>s,toc:()=>h});const s=JSON.parse('{"id":"proxy/token_auth","title":"OIDC - JWT \u57fa\u7840\u8ba4\u8bc1","description":"\u4f7f\u7528 JWT \u5bf9\u7ba1\u7406\u5458\u3001\u7528\u6237\u6216\u9879\u76ee\u8fdb\u884c\u4ee3\u7406\u8ba4\u8bc1\u3002","source":"@site/docs/proxy/token_auth.md","sourceDirName":"proxy","slug":"/proxy/token_auth","permalink":"/docs/proxy/token_auth","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"\u865a\u62df\u5bc6\u94a5","permalink":"/docs/proxy/virtual_keys"},"next":{"title":"[Beta] Service Accounts","permalink":"/docs/proxy/service_accounts"}}');var i=l(74848),r=l(28453),d=l(49489),t=l(7227);const a={},c="OIDC - JWT \u57fa\u7840\u8ba4\u8bc1",o={},h=[{value:"\u4f7f\u7528\u8bf4\u660e",id:"\u4f7f\u7528\u8bf4\u660e",level:2},{value:"\u7b2c\u4e00\u6b65\uff1a\u914d\u7f6e\u4ee3\u7406",id:"\u7b2c\u4e00\u6b65\u914d\u7f6e\u4ee3\u7406",level:3},{value:"\u7b2c\u4e8c\u6b65\uff1a\u521b\u5efa\u5177\u6709\u4f5c\u7528\u57df\u7684 JWT",id:"\u7b2c\u4e8c\u6b65\u521b\u5efa\u5177\u6709\u4f5c\u7528\u57df\u7684-jwt",level:3},{value:"\u7b2c\u4e09\u6b65\uff1a\u6d4b\u8bd5\u60a8\u7684 JWT",id:"\u7b2c\u4e09\u6b65\u6d4b\u8bd5\u60a8\u7684-jwt",level:3},{value:"\u9ad8\u7ea7\u7528\u6cd5",id:"\u9ad8\u7ea7\u7528\u6cd5",level:2},{value:"\u591a\u4e2a OIDC \u63d0\u4f9b\u5546",id:"\u591a\u4e2a-oidc-\u63d0\u4f9b\u5546",level:3},{value:"Kubernetes \u670d\u52a1\u8d26\u53f7\u8ba4\u8bc1",id:"kubernetes-\u670d\u52a1\u8d26\u53f7\u8ba4\u8bc1",level:3},{value:"\u5148\u51b3\u6761\u4ef6",id:"\u5148\u51b3\u6761\u4ef6",level:4},{value:"\u7b2c\u4e00\u6b65\uff1a\u914d\u7f6e OIDC \u53d1\u73b0 URL",id:"\u7b2c\u4e00\u6b65\u914d\u7f6e-oidc-\u53d1\u73b0-url",level:4},{value:"\u7b2c\u4e8c\u6b65\uff1a\u914d\u7f6e LiteLLM",id:"\u7b2c\u4e8c\u6b65\u914d\u7f6e-litellm",level:4},{value:"\u7b2c\u4e09\u6b65\uff1a\u521b\u5efa\u670d\u52a1\u8d26\u53f7\u5e76\u914d\u7f6e Pod",id:"\u7b2c\u4e09\u6b65\u521b\u5efa\u670d\u52a1\u8d26\u53f7\u5e76\u914d\u7f6e-pod",level:4},{value:"\u7b2c\u56db\u6b65\uff1a\u521b\u5efa\u547d\u540d\u7a7a\u95f4\u4e2d\u7684\u56e2\u961f",id:"\u7b2c\u56db\u6b65\u521b\u5efa\u547d\u540d\u7a7a\u95f4\u4e2d\u7684\u56e2\u961f",level:4},{value:"\u7b2c\u4e94\u6b65\uff1a\u4f7f\u7528\u4ee4\u724c",id:"\u7b2c\u4e94\u6b65\u4f7f\u7528\u4ee4\u724c",level:4},{value:"\u793a\u4f8b\uff1a\u670d\u52a1\u8d26\u53f7\u4ee4\u724c\u7ed3\u6784",id:"\u793a\u4f8b\u670d\u52a1\u8d26\u53f7\u4ee4\u724c\u7ed3\u6784",level:4},{value:"\u9ad8\u7ea7\uff1a\u4f7f\u7528\u540d\u79f0\u89e3\u6790\u5c06\u547d\u540d\u7a7a\u95f4\u6620\u5c04\u5230\u56e2\u961f",id:"\u9ad8\u7ea7\u4f7f\u7528\u540d\u79f0\u89e3\u6790\u5c06\u547d\u540d\u7a7a\u95f4\u6620\u5c04\u5230\u56e2\u961f",level:4},{value:"\u8bbe\u7f6e\u63a5\u53d7\u7684 JWT \u8303\u56f4\u540d\u79f0",id:"\u8bbe\u7f6e\u63a5\u53d7\u7684-jwt-\u8303\u56f4\u540d\u79f0",level:3},{value:"\u8ddf\u8e2a\u6700\u7ec8\u7528\u6237 / \u5185\u90e8\u7528\u6237 / \u56e2\u961f / \u7ec4\u7ec7",id:"\u8ddf\u8e2a\u6700\u7ec8\u7528\u6237--\u5185\u90e8\u7528\u6237--\u56e2\u961f--\u7ec4\u7ec7",level:3},{value:"\u6839\u636e\u540d\u79f0\uff08\u522b\u540d\uff09\u800c\u4e0d\u662f ID \u89e3\u6790",id:"\u6839\u636e\u540d\u79f0\u522b\u540d\u800c\u4e0d\u662f-id-\u89e3\u6790",level:3},{value:"JWT \u8303\u56f4",id:"jwt-\u8303\u56f4",level:3},{value:"\u63a7\u5236\u6a21\u578b\u8bbf\u95ee\u6743\u9650\u4e0e\u56e2\u961f",id:"\u63a7\u5236\u6a21\u578b\u8bbf\u95ee\u6743\u9650\u4e0e\u56e2\u961f",level:3},{value:"\u6d41\u7a0b",id:"\u6d41\u7a0b",level:3},{value:"\u901a\u8fc7\u8bf7\u6c42\u5934\u9009\u62e9\u56e2\u961f",id:"\u901a\u8fc7\u8bf7\u6c42\u5934\u9009\u62e9\u56e2\u961f",level:3},{value:"\u81ea\u5b9a\u4e49 JWT \u9a8c\u8bc1",id:"\u81ea\u5b9a\u4e49-jwt-\u9a8c\u8bc1",level:3},{value:"1. \u8bbe\u7f6e\u81ea\u5b9a\u4e49\u9a8c\u8bc1\u51fd\u6570",id:"1-\u8bbe\u7f6e\u81ea\u5b9a\u4e49\u9a8c\u8bc1\u51fd\u6570",level:4},{value:"2. \u8bbe\u7f6e config.yaml",id:"2-\u8bbe\u7f6e-configyaml",level:4},{value:"3. \u6d4b\u8bd5\u6d41\u7a0b",id:"3-\u6d4b\u8bd5\u6d41\u7a0b",level:4},{value:"\u5141\u8bb8\u5176\u4ed6\u63d0\u4f9b\u65b9\u8def\u7531",id:"\u5141\u8bb8\u5176\u4ed6\u63d0\u4f9b\u65b9\u8def\u7531",level:3},{value:"\u7f13\u5b58\u516c\u94a5",id:"\u7f13\u5b58\u516c\u94a5",level:3},{value:"\u81ea\u5b9a\u4e49 JWT \u5b57\u6bb5",id:"\u81ea\u5b9a\u4e49-jwt-\u5b57\u6bb5",level:3},{value:"\u963b\u6b62\u56e2\u961f",id:"\u963b\u6b62\u56e2\u961f",level:3},{value:"\u5141\u8bb8\u6307\u5b9a\u7535\u5b50\u90ae\u4ef6\u57df\u7684\u7528\u6237",id:"\u5141\u8bb8\u6307\u5b9a\u7535\u5b50\u90ae\u4ef6\u57df\u7684\u7528\u6237",level:3},{value:"OIDC UserInfo \u7aef\u70b9",id:"oidc-userinfo-\u7aef\u70b9",level:2},{value:"\u4f7f\u7528\u573a\u666f",id:"\u4f7f\u7528\u573a\u666f",level:3},{value:"\u914d\u7f6e",id:"\u914d\u7f6e",level:3},{value:"\u6d41\u7a0b\u56fe",id:"\u6d41\u7a0b\u56fe",level:3},{value:"\u793a\u4f8b\uff1aAzure AD",id:"\u793a\u4f8bazure-ad",level:3},{value:"\u793a\u4f8b\uff1aKeycloak",id:"\u793a\u4f8bkeycloak",level:3},{value:"[BETA] \u4f7f\u7528 OIDC \u89d2\u8272\u63a7\u5236\u8bbf\u95ee",id:"beta-\u4f7f\u7528-oidc-\u89d2\u8272\u63a7\u5236\u8bbf\u95ee",level:2},{value:"\u5982\u4f55\u5de5\u4f5c",id:"\u5982\u4f55\u5de5\u4f5c",level:3},{value:"\u914d\u7f6e\u9009\u9879",id:"\u914d\u7f6e\u9009\u9879",level:3},{value:"\u91cd\u8981\u6ce8\u610f\u4e8b\u9879",id:"\u91cd\u8981\u6ce8\u610f\u4e8b\u9879",level:3},{value:"\u6d4b\u8bd5\u540c\u6b65\u529f\u80fd",id:"\u6d4b\u8bd5\u540c\u6b65\u529f\u80fd",level:3},{value:"\u6240\u6709 JWT \u53c2\u6570",id:"\u6240\u6709-jwt-\u53c2\u6570",level:3}];function u(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",mermaid:"mermaid",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"oidc---jwt-\u57fa\u7840\u8ba4\u8bc1",children:"OIDC - JWT \u57fa\u7840\u8ba4\u8bc1"})}),"\n",(0,i.jsx)(n.p,{children:"\u4f7f\u7528 JWT \u5bf9\u7ba1\u7406\u5458\u3001\u7528\u6237\u6216\u9879\u76ee\u8fdb\u884c\u4ee3\u7406\u8ba4\u8bc1\u3002"}),"\n",(0,i.jsxs)(n.admonition,{type:"info",children:[(0,i.jsx)(n.p,{children:"\u2728 JWT \u57fa\u7840\u8ba4\u8bc1\u5728 LiteLLM \u4f01\u4e1a\u7248\u4e2d\u63d0\u4f9b"}),(0,i.jsx)(n.p,{children:(0,i.jsx)(n.a,{href:"https://www.litellm.ai/#pricing",children:"\u4f01\u4e1a\u5b9a\u4ef7"})}),(0,i.jsx)(n.p,{children:(0,i.jsx)(n.a,{href:"https://calendly.com/d/4mp-gd3-k5k/litellm-1-1-onboarding-chat",children:"\u5728\u6b64\u8054\u7cfb\u6211\u4eec\u4ee5\u83b7\u53d6\u514d\u8d39\u8bd5\u7528"})})]}),"\n",(0,i.jsx)(n.h2,{id:"\u4f7f\u7528\u8bf4\u660e",children:"\u4f7f\u7528\u8bf4\u660e"}),"\n",(0,i.jsx)(n.h3,{id:"\u7b2c\u4e00\u6b65\u914d\u7f6e\u4ee3\u7406",children:"\u7b2c\u4e00\u6b65\uff1a\u914d\u7f6e\u4ee3\u7406"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"JWT_PUBLIC_KEY_URL"}),"\uff1a\u8fd9\u662f\u60a8\u7684 OpenID \u63d0\u4f9b\u5546\u7684\u516c\u94a5\u7aef\u70b9\u3002\u901a\u5e38\u5b83\u4e3a ",(0,i.jsx)(n.code,{children:"{openid-provider-base-url}/.well-known/openid-configuration/jwks"}),"\u3002\u5bf9\u4e8e Keycloak\uff0c\u5b83\u662f ",(0,i.jsx)(n.code,{children:"{keycloak_base_url}/realms/{your-realm}/protocol/openid-connect/certs"}),"\u3002"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"JWT_AUDIENCE"}),"\uff1a\u8fd9\u662f\u7528\u4e8e\u89e3\u7801 JWT \u7684\u53d7\u4f17\u3002\u5982\u679c\u4e0d\u8bbe\u7f6e\uff0c\u5219\u5728\u89e3\u7801\u6b65\u9aa4\u4e2d\u5c06\u4e0d\u9a8c\u8bc1\u53d7\u4f17\u3002"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'export JWT_PUBLIC_KEY_URL="" # "https://demo.duendesoftware.com/.well-known/openid-configuration/jwks"\n\n\n- \u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u542f\u7528 `enable_jwt_auth`\u3002\u8fd9\u4f1a\u544a\u8bc9\u4ee3\u7406\u68c0\u67e5\u662f\u5426\u4e3a JWT \u4ee4\u724c\u3002\n\n```yaml\ngeneral_settings:\n  master_key: sk-1234\n  enable_jwt_auth: True\n\nmodel_list:\n- model_name: azure-gpt-3.5 \n  litellm_params:\n      model: azure/<your-deployment-name>\n      api_base: os.environ/AZURE_API_BASE\n      api_key: os.environ/AZURE_API_KEY\n      api_version: "2023-07-01-preview"\n'})}),"\n",(0,i.jsx)(n.h3,{id:"\u7b2c\u4e8c\u6b65\u521b\u5efa\u5177\u6709\u4f5c\u7528\u57df\u7684-jwt",children:"\u7b2c\u4e8c\u6b65\uff1a\u521b\u5efa\u5177\u6709\u4f5c\u7528\u57df\u7684 JWT"}),"\n",(0,i.jsxs)(d.A,{children:[(0,i.jsxs)(t.A,{value:"admin",label:"\u7ba1\u7406\u5458",children:[(0,i.jsxs)(n.p,{children:["\u5728\u60a8\u7684 OpenID \u63d0\u4f9b\u5546\uff08\u4f8b\u5982 Keycloak\uff09\u4e2d\u521b\u5efa\u4e00\u4e2a\u5ba2\u6237\u7aef\u8303\u56f4 ",(0,i.jsx)(n.code,{children:"litellm_proxy_admin"}),"\u3002"]}),(0,i.jsxs)(n.p,{children:["\u751f\u6210 JWT \u65f6\uff0c\u6388\u4e88\u7528\u6237 ",(0,i.jsx)(n.code,{children:"litellm_proxy_admin"})," \u8303\u56f4\u3002"]}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"curl --location ' 'https://demo.duendesoftware.com/connect/token'' \\\n--header 'Content-Type: application/x-www-form-urlencoded' \\\n--data-urlencode 'client_id={CLIENT_ID}' \\\n--data-urlencode 'client_secret={CLIENT_SECRET}' \\\n--data-urlencode 'username=test-{USERNAME}' \\\n--data-urlencode 'password={USER_PASSWORD}' \\\n--data-urlencode 'scope=litellm_proxy_admin' # \ud83d\udc48 \u6388\u4e88\u6b64\u8303\u56f4\n"})})]}),(0,i.jsxs)(t.A,{value:"project",label:"\u9879\u76ee",children:[(0,i.jsx)(n.p,{children:"\u5728\u60a8\u7684 OpenID \u63d0\u4f9b\u5546\uff08\u4f8b\u5982 Keycloak\uff09\u4e2d\u4e3a\u9879\u76ee\u751f\u6210 JWT\u3002"}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"curl --location ' 'https://demo.duendesoftware.com/connect/token'' \\\n--header 'Content-Type: application/x-www-form-urlencoded' \\\n--data-urlencode 'client_id={CLIENT_ID}' \\ # \ud83d\udc48 \u9879\u76ee ID\n--data-urlencode 'client_secret={CLIENT_SECRET}' \\\n--data-urlencode 'grant_type=client_credential' \\\n"})})]})]}),"\n",(0,i.jsx)(n.h3,{id:"\u7b2c\u4e09\u6b65\u6d4b\u8bd5\u60a8\u7684-jwt",children:"\u7b2c\u4e09\u6b65\uff1a\u6d4b\u8bd5\u60a8\u7684 JWT"}),"\n",(0,i.jsxs)(d.A,{children:[(0,i.jsx)(t.A,{value:"key",label:"/key/generate",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"curl --location '{proxy_base_url}/key/generate' \\\n--header 'Authorization: Bearer eyJhbGciOiJSUzI1NiI...' \\\n--header 'Content-Type: application/json' \\\n--data '{}'\n"})})}),(0,i.jsx)(t.A,{value:"llm_call",label:"/chat/completions",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'curl --location \'http://0.0.0.0:4000/v1/chat/completions\' \\\n--header \'Content-Type: application/json\' \\\n--header \'Authorization: Bearer eyJhbGciOiJSUzI1...\' \\\n--data \'{"model": "azure-gpt-3.5", "messages": [ { "role": "user", "content": "What\'s the weather like in Boston today?" } ]}\'\n'})})})]}),"\n",(0,i.jsx)(n.h2,{id:"\u9ad8\u7ea7\u7528\u6cd5",children:"\u9ad8\u7ea7\u7528\u6cd5"}),"\n",(0,i.jsx)(n.h3,{id:"\u591a\u4e2a-oidc-\u63d0\u4f9b\u5546",children:"\u591a\u4e2a OIDC \u63d0\u4f9b\u5546"}),"\n",(0,i.jsx)(n.p,{children:"\u5982\u679c\u60a8\u5e0c\u671b LiteLLM \u4f7f\u7528\u591a\u4e2a OIDC \u63d0\u4f9b\u5546\u9a8c\u8bc1 JWT\uff08\u4f8b\u5982 Google Cloud\u3001GitHub Auth\uff09\uff0c\u8bf7\u4f7f\u7528\u6b64\u529f\u80fd\u3002"}),"\n",(0,i.jsxs)(n.p,{children:["\u5728\u73af\u5883\u53d8\u91cf\u4e2d\u8bbe\u7f6e ",(0,i.jsx)(n.code,{children:"JWT_PUBLIC_KEY_URL"})," \u4e3a\u60a8\u7684 OIDC \u63d0\u4f9b\u5546\u7684 URL \u5217\u8868\uff0c\u7528\u9017\u53f7\u5206\u9694\u3002"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'export JWT_PUBLIC_KEY_URL="https://demo.duendesoftware.com/.well-known/openid-configuration/jwks,https://accounts.google.com/.well-known/openid-configuration/jwks"\n'})}),"\n",(0,i.jsx)(n.h3,{id:"kubernetes-\u670d\u52a1\u8d26\u53f7\u8ba4\u8bc1",children:"Kubernetes \u670d\u52a1\u8d26\u53f7\u8ba4\u8bc1"}),"\n",(0,i.jsx)(n.p,{children:"\u4f7f\u7528 Kubernetes \u670d\u52a1\u8d26\u53f7\u4ee4\u724c\u5bf9\u96c6\u7fa4\u4e2d\u7684\u5de5\u4f5c\u8d1f\u8f7d\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\u3002\u8fd9\u5728\u60a8\u5e0c\u671b pod \u4f7f\u7528\u5176\u539f\u751f\u7684 Kubernetes \u8eab\u4efd\u6765\u8ba4\u8bc1\u5230 LiteLLM \u7684\u60c5\u51b5\u4e0b\u975e\u5e38\u6709\u7528\u3002"}),"\n",(0,i.jsx)(n.h4,{id:"\u5148\u51b3\u6761\u4ef6",children:"\u5148\u51b3\u6761\u4ef6"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"\u60a8\u7684 Kubernetes \u96c6\u7fa4\u5fc5\u987b\u542f\u7528\u670d\u52a1\u8d26\u53f7\u4ee4\u724c\u6295\u5f71\uff08\u9ed8\u8ba4\u4ece Kubernetes 1.20+ \u5f00\u59cb\uff09"}),"\n",(0,i.jsx)(n.li,{children:"\u60a8\u96c6\u7fa4\u7684 OIDC \u53d1\u884c\u8005\u53ef\u8bbf\u95ee\uff08\u5bf9\u4e8e EKS\u3001GKE \u548c AKS\uff0c\u8fd9\u662f\u81ea\u52a8\u5316\u7684\uff09"}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"\u7b2c\u4e00\u6b65\u914d\u7f6e-oidc-\u53d1\u73b0-url",children:"\u7b2c\u4e00\u6b65\uff1a\u914d\u7f6e OIDC \u53d1\u73b0 URL"}),"\n",(0,i.jsxs)(n.p,{children:["\u5c06 ",(0,i.jsx)(n.code,{children:"JWT_PUBLIC_KEY_URL"})," \u8bbe\u7f6e\u4e3a\u60a8\u7684\u96c6\u7fa4\u7684 OIDC \u53d1\u73b0\u7aef\u70b9\uff1a"]}),"\n",(0,i.jsxs)(d.A,{children:[(0,i.jsx)(t.A,{value:"eks",label:"Amazon EKS",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'# \u83b7\u53d6\u60a8\u7684 EKS OIDC \u53d1\u884c\u8005 URL\naws eks describe-cluster --name <cluster-name> --query "cluster.identity.oidc.issuer" --output text\n\n# \u8bbe\u7f6e JWKS URL\uff08\u5728\u53d1\u884c\u8005 URL \u540e\u8ffd\u52a0 /keys\uff09\nexport JWT_PUBLIC_KEY_URL="https://oidc.eks.<region>.amazonaws.com/id/<id>/keys"\n'})})}),(0,i.jsx)(t.A,{value:"gke",label:"Google GKE",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'# Google GKE \u4f7f\u7528 Google \u7684 OIDC \u63d0\u4f9b\u5546\nexport JWT_PUBLIC_KEY_URL="https://container.googleapis.com/v1/projects/<project>/locations/<location>/clusters/<cluster>/jwks"\n'})})}),(0,i.jsx)(t.A,{value:"aks",label:"Azure AKS",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'# \u83b7\u53d6\u60a8\u7684 AKS OIDC \u53d1\u884c\u8005 URL\naz aks show --name <cluster-name> --resource-group <resource-group> --query "oidcIssuerProfile.issuerUrl" -o tsv\n\n# \u8bbe\u7f6e JWKS URL\nexport JWT_PUBLIC_KEY_URL="<issuer-url>/openid/v1/jwks"\n'})})}),(0,i.jsx)(t.A,{value:"self-managed",label:"\u81ea\u6258\u7ba1",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'# \u5bf9\u4e8e\u81ea\u6258\u7ba1\u96c6\u7fa4\uff0c\u8bf7\u68c0\u67e5 API \u670d\u52a1\u5668\u7684 --service-account-issuer \u6807\u5fd7\n# JWKS \u7aef\u70b9\u901a\u5e38\u4f4d\u4e8e\uff1a\nexport JWT_PUBLIC_KEY_URL="https://<api-server>/openid/v1/jwks"\n'})})})]}),"\n",(0,i.jsx)(n.h4,{id:"\u7b2c\u4e8c\u6b65\u914d\u7f6e-litellm",children:"\u7b2c\u4e8c\u6b65\uff1a\u914d\u7f6e LiteLLM"}),"\n",(0,i.jsx)(n.p,{children:"\u914d\u7f6e LiteLLM \u4ece Kubernetes \u670d\u52a1\u8d26\u53f7\u4ee4\u724c\u4e2d\u63d0\u53d6\u8eab\u4efd\u4fe1\u606f\uff1a"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'general_settings:\n  enable_jwt_auth: True\n  litellm_jwtauth:  \n    # \u4f7f\u7528\u547d\u540d\u7a7a\u95f4\u4f5c\u4e3a\u56e2\u961f\u6807\u8bc6\u7b26\uff08\u901a\u8fc7 DB \u4e2d\u7684 team_alias \u89e3\u6790\uff09\n    team_alias_jwt_field: "kubernetes\\.io.namespace"\n'})}),"\n",(0,i.jsx)(n.h4,{id:"\u7b2c\u4e09\u6b65\u521b\u5efa\u670d\u52a1\u8d26\u53f7\u5e76\u914d\u7f6e-pod",children:"\u7b2c\u4e09\u6b65\uff1a\u521b\u5efa\u670d\u52a1\u8d26\u53f7\u5e76\u914d\u7f6e Pod"}),"\n",(0,i.jsx)(n.p,{children:"\u521b\u5efa\u4e00\u4e2a\u5e26\u6709\u5173\u8054 secret \u7684\u670d\u52a1\u8d26\u53f7\uff0c\u5e76\u5c06 pod \u914d\u7f6e\u4e3a\u4f7f\u7528\u4ee4\u724c\uff1a"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"apiVersion: v1\nkind: ServiceAccount\nmetadata:\n  name: my-llm-client\n  namespace: my-app\n---\napiVersion: v1\nkind: Secret\nmetadata:\n  name: my-llm-client-token\n  namespace: my-app\n  annotations:\n    kubernetes.io/service-account.name: my-llm-client\ntype: kubernetes.io/service-account-token\n---\napiVersion: v1\nkind: Pod\nmetadata:\n  name: llm-client-pod\n  namespace: my-app\nspec:\n  serviceAccountName: my-llm-client\n  containers:\n  - name: app\n    image: my-app:latest\n    env:\n    - name: LITELLM_TOKEN\n      valueFrom:\n        secretKeyRef:\n          name: my-llm-client-token\n          key: token\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u8bbe\u7f6e LiteLLM \u4e2d\u7684\u9884\u671f\u53d7\u4f17\uff1a"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'export JWT_AUDIENCE="https://kubernetes.default.svc"\n'})}),"\n",(0,i.jsx)(n.h4,{id:"\u7b2c\u56db\u6b65\u521b\u5efa\u547d\u540d\u7a7a\u95f4\u4e2d\u7684\u56e2\u961f",children:"\u7b2c\u56db\u6b65\uff1a\u521b\u5efa\u547d\u540d\u7a7a\u95f4\u4e2d\u7684\u56e2\u961f"}),"\n",(0,i.jsxs)(n.p,{children:["\u5728 LiteLLM \u4e2d\u4e3a\u547d\u540d\u7a7a\u95f4\u521b\u5efa\u4e00\u4e2a\u4e0e\u4e4b\u5339\u914d\u7684\u56e2\u961f\uff08\u4f7f\u7528 ",(0,i.jsx)(n.code,{children:"team_alias"}),"\uff09\uff1a"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'curl -X POST \'http://0.0.0.0:4000/team/new\' \\\n-H \'Authorization: Bearer <PROXY_MASTER_KEY>\' \\\n-H \'Content-Type: application/json\' \\\n-d \'{\n    "team_alias": "my-app",\n    "team_id": "my-app",\n    "models": ["gpt-4", "claude-sonnet-4-20250514"]\n}\'\n'})}),"\n",(0,i.jsx)(n.h4,{id:"\u7b2c\u4e94\u6b65\u4f7f\u7528\u4ee4\u724c",children:"\u7b2c\u4e94\u6b65\uff1a\u4f7f\u7528\u4ee4\u724c"}),"\n",(0,i.jsxs)(n.p,{children:["\u4ece pod \u5185\u90e8\uff0c\u4ee4\u724c\u5728 ",(0,i.jsx)(n.code,{children:"LITELLM_TOKEN"})," \u73af\u5883\u53d8\u91cf\u4e2d\u53ef\u7528\uff1a"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'# \u4f7f\u7528 env \u53d8\u91cf\u5411 LiteLLM \u53d1\u51fa\u8bf7\u6c42\ncurl -X POST \'http://0.0.0.0:4000/v1/chat/completions\' \\\n-H \'Content-Type: application/json\' \\\n-H "Authorization: Bearer $LITELLM_TOKEN" \\\n-d \'{\n  "model": "gpt-4",\n  "messages": [{"role": "user", "content": "Hello!"}]\n}\'\n'})}),"\n",(0,i.jsx)(n.h4,{id:"\u793a\u4f8b\u670d\u52a1\u8d26\u53f7\u4ee4\u724c\u7ed3\u6784",children:"\u793a\u4f8b\uff1a\u670d\u52a1\u8d26\u53f7\u4ee4\u724c\u7ed3\u6784"}),"\n",(0,i.jsx)(n.p,{children:"\u4e00\u4e2a Kubernetes \u670d\u52a1\u8d26\u53f7\u4ee4\u724c\u770b\u8d77\u6765\u50cf\u8fd9\u6837\uff1a"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "aud": ["litellm-proxy"],\n  "exp": 1234567890,\n  "iat": 1234567890,\n  "iss": "https://oidc.eks.us-west-2.amazonaws.com/id/EXAMPLE",\n  "kubernetes.io": {\n    "namespace": "my-app",\n    "pod": {\n      "name": "llm-client-pod",\n      "uid": "pod-uid"\n    },\n    "serviceaccount": {\n      "name": "my-llm-client",\n      "uid": "sa-uid"\n    }\n  },\n  "nbf": 1234567890,\n  "sub": "system:serviceaccount:my-app:my-llm-client"\n}\n'})}),"\n",(0,i.jsx)(n.h4,{id:"\u9ad8\u7ea7\u4f7f\u7528\u540d\u79f0\u89e3\u6790\u5c06\u547d\u540d\u7a7a\u95f4\u6620\u5c04\u5230\u56e2\u961f",children:"\u9ad8\u7ea7\uff1a\u4f7f\u7528\u540d\u79f0\u89e3\u6790\u5c06\u547d\u540d\u7a7a\u95f4\u6620\u5c04\u5230\u56e2\u961f"}),"\n",(0,i.jsxs)(n.p,{children:["\u4f7f\u7528 ",(0,i.jsx)(n.code,{children:"team_alias_jwt_field"})," \u81ea\u52a8\u5c06\u547d\u540d\u7a7a\u95f4\u89e3\u6790\u4e3a\u56e2\u961f\uff1a"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'general_settings:\n  enable_jwt_auth: True\n  litellm_jwtauth:\n    user_id_jwt_field: "sub"\n    # \u5c06\u547d\u540d\u7a7a\u95f4\u6620\u5c04\u5230 team_alias \u5728\u6570\u636e\u5e93\u4e2d\n    team_alias_jwt_field: "kubernetes\\.io.namespace"\n    user_id_upsert: true\n'})}),"\n",(0,i.jsxs)(n.p,{children:["\u8fd9\u6837\uff0c",(0,i.jsx)(n.code,{children:"production"})," \u547d\u540d\u7a7a\u95f4\u4e2d\u7684 pod \u4f1a\u81ea\u52a8\u4e0e\u5177\u6709 ",(0,i.jsx)(n.code,{children:"team_alias: production"})," \u7684\u56e2\u961f\u5173\u8054\u3002"]}),"\n",(0,i.jsx)(n.h3,{id:"\u8bbe\u7f6e\u63a5\u53d7\u7684-jwt-\u8303\u56f4\u540d\u79f0",children:"\u8bbe\u7f6e\u63a5\u53d7\u7684 JWT \u8303\u56f4\u540d\u79f0"}),"\n",(0,i.jsx)(n.p,{children:"\u66f4\u6539 litellm \u8bc4\u4f30\u4ee5\u786e\u5b9a\u7528\u6237\u662f\u5426\u6709\u7ba1\u7406\u5458\u8bbf\u95ee\u6743\u9650\u7684\u5b57\u7b26\u4e32\u3002"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'general_settings:\n  master_key: sk-1234\n  enable_jwt_auth: True\n  litellm_jwtauth:\n    admin_jwt_scope: "litellm-proxy-admin"\n'})}),"\n",(0,i.jsx)(n.h3,{id:"\u8ddf\u8e2a\u6700\u7ec8\u7528\u6237--\u5185\u90e8\u7528\u6237--\u56e2\u961f--\u7ec4\u7ec7",children:"\u8ddf\u8e2a\u6700\u7ec8\u7528\u6237 / \u5185\u90e8\u7528\u6237 / \u56e2\u961f / \u7ec4\u7ec7"}),"\n",(0,i.jsx)(n.p,{children:"\u8bbe\u7f6e\u5728 JWT \u4e2d\u5bf9\u5e94\u4e8e litellm \u7528\u6237 / \u56e2\u961f / \u7ec4\u7ec7\u7684\u5b57\u6bb5\u3002"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"\u6ce8\u610f\uff1a"})," \u6240\u6709 JWT \u5b57\u6bb5\u652f\u6301\u70b9\u7b26\u53f7\u8bbf\u95ee\u5d4c\u5957\u58f0\u660e\uff08\u4f8b\u5982\uff0c",(0,i.jsx)(n.code,{children:'"user.sub"'}),"\uff0c",(0,i.jsx)(n.code,{children:'"resource_access.client.roles"'}),"\uff09\u3002"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'general_settings:\n  master_key: sk-1234\n  enable_jwt_auth: True\n  litellm_jwtauth:\n    admin_jwt_scope: "litellm-proxy-admin"\n    team_id_jwt_field: "client_id" # \ud83d\udc48 \u53ef\u4ee5\u662f\u4efb\u4f55\u5b57\u6bb5\uff08\u652f\u6301\u70b9\u7b26\u53f7\u8bbf\u95ee\u5d4c\u5957\u58f0\u660e\uff09\n    user_id_jwt_field: "sub" # \ud83d\udc48 \u53ef\u4ee5\u662f\u4efb\u4f55\u5b57\u6bb5\uff08\u652f\u6301\u70b9\u7b26\u53f7\u8bbf\u95ee\u5d4c\u5957\u58f0\u660e\uff09\n    org_id_jwt_field: "org_id" # \ud83d\udc48 \u53ef\u4ee5\u662f\u4efb\u4f55\u5b57\u6bb5\uff08\u652f\u6301\u70b9\u7b26\u53f7\u8bbf\u95ee\u5d4c\u5957\u58f0\u660e\uff09\n    end_user_id_jwt_field: "customer_id" # \ud83d\udc48 \u53ef\u4ee5\u662f\u4efb\u4f55\u5b57\u6bb5\uff08\u652f\u6301\u70b9\u7b26\u53f7\u8bbf\u95ee\u5d4c\u5957\u58f0\u660e\uff09\n'})}),"\n",(0,i.jsx)(n.p,{children:"\u9884\u671f JWT (\u6241\u5e73\u7ed3\u6784)\uff1a"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "client_id": "my-unique-team",\n  "sub": "my-unique-user",\n  "org_id": "my-unique-org"\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"\u6216\u4f7f\u7528\u5e26\u70b9\u7b26\u53f7\u7684\u5d4c\u5957\u7ed3\u6784\uff1a"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "user": {\n    "sub": "my-unique-user",\n    "email": "user@example.com"\n  },\n  "tenant": {\n    "team_id": "my-unique-team"\n  },\n  "organization": {\n    "id": "my-unique-org"\n  }\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"\u914d\u7f6e\u5d4c\u5957\u793a\u4f8b\uff1a"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'litellm_jwtauth:\n  user_id_jwt_field: "user.sub"\n  user_email_jwt_field: "user.email"\n  team_id_jwt_field: "tenant.team_id"\n  org_id_jwt_field: "organization.id"\n'})}),"\n",(0,i.jsx)(n.p,{children:"\u73b0\u5728\uff0c\u6bcf\u6b21\u8c03\u7528\u65f6 litellm \u90fd\u4f1a\u81ea\u52a8\u66f4\u65b0\u7528\u6237 / \u56e2\u961f / \u7ec4\u7ec7\u5728\u6570\u636e\u5e93\u4e2d\u7684\u82b1\u8d39\u3002"}),"\n",(0,i.jsx)(n.h3,{id:"\u6839\u636e\u540d\u79f0\u522b\u540d\u800c\u4e0d\u662f-id-\u89e3\u6790",children:"\u6839\u636e\u540d\u79f0\uff08\u522b\u540d\uff09\u800c\u4e0d\u662f ID \u89e3\u6790"}),"\n",(0,i.jsx)(n.p,{children:"\u6709\u65f6\u60a8\u7684 JWT \u4e2d\u5305\u542b\u53ef\u8bfb\u7684\u4eba\u7c7b\u540d\u79f0\u800c\u4e0d\u662f\u6570\u636e\u5e93 ID\u3002LiteLLM \u53ef\u4ee5\u901a\u8fc7\u67e5\u627e\u6570\u636e\u5e93\u6765\u89e3\u6790\u8fd9\u4e9b\u540d\u79f0\u4e3a ID\u3002"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"\u7528\u4f8b\uff1a"})," \u60a8\u7684 IDP \u5728 JWT \u4e2d\u63d0\u4f9b\u56e2\u961f / \u7ec4\u7ec7\u540d\u79f0\uff0c\u4f46 LiteLLM \u9700\u8981\u5b9e\u9645\u7684\u6570\u636e\u5e93 ID \u7528\u4e8e\u82b1\u8d39\u8ddf\u8e2a\u548c\u8bbf\u95ee\u63a7\u5236\u3002"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'general_settings:\n  master_key: sk-1234\n  enable_jwt_auth: True\n  litellm_jwtauth:\n    # \u57fa\u4e8e\u540d\u79f0\u7684\u5b57\u6bb5\uff08\u901a\u8fc7\u6570\u636e\u5e93\u67e5\u627e\u89e3\u6790\uff09\n    team_alias_jwt_field: "team_alias"       # \u6839\u636e DB \u4e2d\u7684 team_alias \u89e3\u6790\u56e2\u961f\n    org_alias_jwt_field: "org_alias"         # \u6839\u636e organization_alias \u5728 DB \u4e2d\u89e3\u6790\u7ec4\u7ec7\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"\u9884\u671f JWT\uff1a"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "sub": "user-123",\n  "team_alias": "engineering-team",\n  "org_alias": "acme-corp"\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"\u5de5\u4f5c\u539f\u7406\uff1a"})}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"LiteLLM \u4ece\u914d\u7f6e\u7684 JWT \u5b57\u6bb5\u4e2d\u63d0\u53d6\u540d\u79f0"}),"\n",(0,i.jsxs)(n.li,{children:["\u6839\u636e\u5176\u522b\u540d\u5b57\u6bb5\u5728\u6570\u636e\u5e93\u4e2d\u67e5\u627e\u5b9e\u4f53\uff1a","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\u56e2\u961f: ",(0,i.jsx)(n.code,{children:"LiteLLM_TeamTable"})," \u4e2d\u7684 ",(0,i.jsx)(n.code,{children:"team_alias"})," \u5217"]}),"\n",(0,i.jsxs)(n.li,{children:["\u7ec4\u7ec7: ",(0,i.jsx)(n.code,{children:"LiteLLM_OrganizationTable"})," \u4e2d\u7684 ",(0,i.jsx)(n.code,{children:"organization_alias"})," \u5217"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.li,{children:"\u4f7f\u7528\u89e3\u6790\u51fa\u7684 ID \u7528\u4e8e\u82b1\u8d39\u8ddf\u8e2a\u548c\u8bbf\u95ee\u63a7\u5236"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"\u4f18\u5148\u7ea7\uff1a"})," ID \u5b57\u6bb5\u59cb\u7ec8\u4f18\u5148\u4e8e\u540d\u79f0\u5b57\u6bb5\u3002\u5982\u679c\u540c\u65f6\u914d\u7f6e\u4e86 ",(0,i.jsx)(n.code,{children:"team_id_jwt_field"})," \u548c ",(0,i.jsx)(n.code,{children:"team_alias_jwt_field"}),"\uff0c\u5e76\u4e14 JWT \u4e2d\u90fd\u5b58\u5728\u8fd9\u4e24\u4e2a\u503c\uff0c\u5219\u5c06\u4f7f\u7528 ID\u3002"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'# \u793a\u4f8b: ID \u5177\u6709\u4f18\u5148\u6743\nlitellm_jwtauth:\n  team_id_jwt_field: "team_id"        # \u5982\u679c\u5728 JWT \u4e2d\u5b58\u5728\u5219\u4f7f\u7528\u6b64\u5b57\u6bb5\n  team_alias_jwt_field: "team_alias"   # \u5982\u679c team_id \u5b57\u6bb5\u4e0d\u5b58\u5728\u5219\u4f5c\u4e3a\u5907\u7528\n'})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"\u5d4c\u5957\u5b57\u6bb5\uff1a"})," \u540d\u79f0\u5b57\u6bb5\u4e5f\u652f\u6301\u70b9\u7b26\u53f7\u8bbf\u95ee\u5d4c\u5957\u58f0\u660e\uff1a"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'litellm_jwtauth:\n  team_alias_jwt_field: "organization.team.name"\n  org_alias_jwt_field: "company.name"\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"\u91cd\u8981\u6ce8\u610f\u4e8b\u9879\uff1a"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u5b9e\u4f53\uff08\u56e2\u961f / \u7ec4\u7ec7\uff09\u5fc5\u987b\u5728\u6570\u636e\u5e93\u4e2d\u4ee5\u5339\u914d\u7684\u522b\u540d\u5b58\u5728"}),"\n",(0,i.jsx)(n.li,{children:"\u522b\u540d\u5e94\u552f\u4e00 - \u5982\u679c\u591a\u4e2a\u5b9e\u4f53\u5171\u4eab\u76f8\u540c\u7684\u522b\u540d\uff0c\u5219\u5c06\u8fd4\u56de\u9519\u8bef"}),"\n",(0,i.jsx)(n.li,{children:"\u540d\u79f0\u89e3\u6790\u4f1a\u589e\u52a0\u4e00\u6b21\u6570\u636e\u5e93\u67e5\u627e\uff0c\u56e0\u6b64\u76f4\u63a5\u4f7f\u7528 ID \u7a0d\u5fae\u66f4\u9ad8\u6548"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"jwt-\u8303\u56f4",children:"JWT \u8303\u56f4"}),"\n",(0,i.jsx)(n.p,{children:"\u8fd9\u91cc\u662f JWT \u8ba4\u8bc1\u4ee4\u724c\u4e2d\u7684\u8303\u56f4\u7684\u6837\u5b50\uff1a"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"\u53ef\u4ee5\u662f\u4e00\u4e2a\u5217\u8868"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'scope: ["litellm-proxy-admin",...]\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"\u4e5f\u53ef\u4ee5\u662f\u4e00\u4e2a\u7a7a\u683c\u5206\u9694\u7684\u5b57\u7b26\u4e32"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'scope: "litellm-proxy-admin ..."\n'})}),"\n",(0,i.jsx)(n.h3,{id:"\u63a7\u5236\u6a21\u578b\u8bbf\u95ee\u6743\u9650\u4e0e\u56e2\u961f",children:"\u63a7\u5236\u6a21\u578b\u8bbf\u95ee\u6743\u9650\u4e0e\u56e2\u961f"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"\u6307\u5b9a\u5305\u542b\u7528\u6237\u6240\u5c5e\u56e2\u961f ID \u7684 JWT \u5b57\u6bb5\u3002"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'general_settings:\n  enable_jwt_auth: True\n  litellm_jwtauth:\n    user_id_jwt_field: "sub"\n    team_ids_jwt_field: "groups" \n    user_id_upsert: true # \u5982\u679c\u7528\u6237\u4e0d\u5b58\u5728\u5219\u5c06\u5176\u6dfb\u52a0\u5230\u6570\u636e\u5e93\u4e2d\n    enforce_team_based_model_access: true # \u4e0d\u5141\u8bb8\u7528\u6237\u8bbf\u95ee\u6a21\u578b\uff0c\u9664\u975e\u56e2\u961f\u5177\u6709\u76f8\u5e94\u7684\u6743\u9650\n'})}),"\n",(0,i.jsx)(n.p,{children:"\u5047\u8bbe\u60a8\u7684\u4ee4\u724c\u770b\u8d77\u6765\u50cf\u8fd9\u6837\uff1a"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'{\n  ...,\n  "sub": "my-unique-user",\n  "groups": ["team_id_1", "team_id_2"]\n}\n'})}),"\n",(0,i.jsxs)(n.ol,{start:"2",children:["\n",(0,i.jsx)(n.li,{children:"\u5728 LiteLLM \u4e2d\u521b\u5efa\u8fd9\u4e9b\u56e2\u961f"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"curl -X POST '<PROXY_BASE_URL>/team/new' \\\n-H 'Authorization: Bearer <PROXY_MASTER_KEY>' \\\n-H 'Content-Type: application/json' \\\n-D '{\n    \"team_alias\": \"team_1\",\n    \"team_id\": \"team_id_1\" # \ud83d\udc48 \u5fc5\u987b\u4e0e SSO \u7ec4 ID \u4e00\u81f4\n}'\n"})}),"\n",(0,i.jsxs)(n.ol,{start:"3",children:["\n",(0,i.jsx)(n.li,{children:"\u6d4b\u8bd5\u6d41\u7a0b"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["SSO \u5bf9\u4e8e UI\uff1a",(0,i.jsx)(n.a,{href:"https://www.loom.com/share/8959be458edf41fd85937452c29a33f3?sid=7ebd6d37-569a-4023-866e-e0cde67cb23e",children:(0,i.jsx)(n.strong,{children:"\u67e5\u770b\u8d70\u67e5"})})]}),"\n",(0,i.jsxs)(n.p,{children:["OIDC \u8ba4\u8bc1\u5bf9\u4e8e API\uff1a",(0,i.jsx)(n.a,{href:"https://www.loom.com/share/00fe2deab59a426183a46b1e2b522200?sid=4ed6d497-ead6-47f9-80c0-ca1c4b6b4814",children:(0,i.jsx)(n.strong,{children:"\u67e5\u770b\u8d70\u67e5"})})]}),"\n",(0,i.jsx)(n.h3,{id:"\u6d41\u7a0b",children:"\u6d41\u7a0b"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u9a8c\u8bc1\u7528\u6237 ID \u662f\u5426\u5b58\u5728\u4e8e\u6570\u636e\u5e93\u4e2d\uff08LiteLLM_UserTable\uff09"}),"\n",(0,i.jsx)(n.li,{children:"\u9a8c\u8bc1\u4efb\u4f55\u7ec4\u662f\u5426\u5b58\u5728\u4e8e\u6570\u636e\u5e93\u4e2d\uff08LiteLLM_TeamTable\uff09"}),"\n",(0,i.jsx)(n.li,{children:"\u9a8c\u8bc1\u4efb\u4f55\u7ec4\u662f\u5426\u6709\u6a21\u578b\u8bbf\u95ee\u6743\u9650"}),"\n",(0,i.jsx)(n.li,{children:"\u5982\u679c\u6240\u6709\u68c0\u67e5\u90fd\u901a\u8fc7\uff0c\u5219\u5141\u8bb8\u8bf7\u6c42"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"\u901a\u8fc7\u8bf7\u6c42\u5934\u9009\u62e9\u56e2\u961f",children:"\u901a\u8fc7\u8bf7\u6c42\u5934\u9009\u62e9\u56e2\u961f"}),"\n",(0,i.jsxs)(n.p,{children:["\u5f53 JWT \u4e2d\u5305\u542b\u591a\u4e2a\u56e2\u961f\uff08\u901a\u8fc7 ",(0,i.jsx)(n.code,{children:"team_ids_jwt_field"}),"\uff09\u65f6\uff0c\u53ef\u4ee5\u901a\u8fc7\u4f20\u9012 ",(0,i.jsx)(n.code,{children:"x-litellm-team-id"})," \u5934\u90e8\u6765\u663e\u5f0f\u9009\u62e9\u7528\u4e8e\u8bf7\u6c42\u7684\u56e2\u961f\u3002"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'curl -X POST \'http://0.0.0.0:4000/v1/chat/completions\' \\\n-H \'Content-Type: application/json\' \\\n-H \'Authorization: Bearer <your-jwt-token>\' \\\n-H \'x-litellm-team-id: team_id_2\' \\\n-d \'{\n  "model": "gpt-4",\n  "messages": [{"role": "user", "content": "Hello"}]\n}\'\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"\u9a8c\u8bc1\uff1a"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\u5934\u90e8\u4e2d\u7684\u56e2\u961f ID \u5fc5\u987b\u5b58\u5728\u4e8e JWT \u7684 ",(0,i.jsx)(n.code,{children:"team_ids_jwt_field"})," \u5217\u8868\u4e2d\u6216\u4e0e ",(0,i.jsx)(n.code,{children:"team_id_jwt_field"})," \u5339\u914d"]}),"\n",(0,i.jsx)(n.li,{children:"\u5982\u679c\u6307\u5b9a\u4e86\u65e0\u6548\u7684\u56e2\u961f\uff0c\u5219\u8fd4\u56de 403 \u9519\u8bef"}),"\n",(0,i.jsx)(n.li,{children:"\u5982\u679c\u672a\u63d0\u4f9b\u5934\u90e8\uff0cLiteLLM \u5c06\u81ea\u52a8\u9009\u62e9\u5177\u6709\u8bbf\u95ee\u6743\u9650\u7684\u7b2c\u4e00\u4e2a\u56e2\u961f"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"\u81ea\u5b9a\u4e49-jwt-\u9a8c\u8bc1",children:"\u81ea\u5b9a\u4e49 JWT \u9a8c\u8bc1"}),"\n",(0,i.jsx)(n.p,{children:"\u4f7f\u7528\u81ea\u5b9a\u4e49\u903b\u8f91\u9a8c\u8bc1 JWT Token\uff0c\u5982\u679c\u60a8\u9700\u8981\u4e00\u79cd\u989d\u5916\u7684\u65b9\u5f0f\u6765\u9a8c\u8bc1 LiteLLM \u4ee3\u7406\u4e2d\u7684\u4ee4\u724c\u662f\u5426\u6709\u6548\u3002"}),"\n",(0,i.jsx)(n.h4,{id:"1-\u8bbe\u7f6e\u81ea\u5b9a\u4e49\u9a8c\u8bc1\u51fd\u6570",children:"1. \u8bbe\u7f6e\u81ea\u5b9a\u4e49\u9a8c\u8bc1\u51fd\u6570"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'from typing import Literal\n\ndef my_custom_validate(token: str) -> Literal[True]:\n  """\n  \u53ea\u5141\u8bb8 tenant-id == "my-unique-tenant" \u7684\u4ee4\u724c\uff0c\u5e76\u4e14 claims == ["proxy-admin"]\n  """\n  allowed_tenants = ["my-unique-tenant"]\n  allowed_claims = ["proxy-admin"]\n\n  if token["tenant_id"] not in allowed_tenants:\n    raise Exception("\u65e0\u6548\u7684 JWT \u4ee4\u724c")\n  if token["claims"] not in allowed_claims:\n    raise Exception("\u65e0\u6548\u7684 JWT \u4ee4\u724c")\n  return True\n'})}),"\n",(0,i.jsx)(n.h4,{id:"2-\u8bbe\u7f6e-configyaml",children:"2. \u8bbe\u7f6e config.yaml"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'general_settings:\n  master_key: sk-1234\n  enable_jwt_auth: True\n  litellm_jwtauth:\n    user_id_jwt_field: "sub"\n    team_id_jwt_field: "tenant_id"\n    user_id_upsert: True\n    custom_validate: custom_validate.my_custom_validate # \ud83d\udc48 \u81ea\u5b9a\u4e49\u9a8c\u8bc1\u51fd\u6570\n'})}),"\n",(0,i.jsx)(n.h4,{id:"3-\u6d4b\u8bd5\u6d41\u7a0b",children:"3. \u6d4b\u8bd5\u6d41\u7a0b"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"\u9884\u671f JWT"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'{\n  "sub": "my-unique-user",\n  "tenant_id": "INVALID_TENANT",\n  "claims": ["proxy-admin"]\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"\u9884\u671f\u54cd\u5e94"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'{\n  "error": "\u65e0\u6548\u7684 JWT \u4ee4\u724c"\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"\u5141\u8bb8\u5176\u4ed6\u63d0\u4f9b\u65b9\u8def\u7531",children:"\u5141\u8bb8\u5176\u4ed6\u63d0\u4f9b\u65b9\u8def\u7531"}),"\n",(0,i.jsxs)(n.p,{children:["\u4e3a\u56e2\u961f JWT \u5141\u8bb8\u8bbf\u95ee Anthropic \u98ce\u683c\u7684\u7aef\u70b9\uff08\u5982 ",(0,i.jsx)(n.code,{children:"/v1/messages"}),"\uff09\uff0c\u8bf7\u66f4\u65b0 ",(0,i.jsx)(n.code,{children:"litellm_jwtauth"})," \u4e2d\u7684 ",(0,i.jsx)(n.code,{children:"team_allowed_routes"}),"\u3002",(0,i.jsx)(n.code,{children:"team_allowed_routes"})," \u652f\u6301\u4ee5\u4e0b\u503c\uff1a"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"LiteLLMRoutes"})," \u4e2d\u547d\u540d\u7684\u8def\u7531\u7ec4\uff08\u4f8b\u5982 ",(0,i.jsx)(n.code,{children:"openai_routes"}),", ",(0,i.jsx)(n.code,{children:"anthropic_routes"}),", ",(0,i.jsx)(n.code,{children:"info_routes"}),", ",(0,i.jsx)(n.code,{children:"mapped_pass_through_routes"}),"\uff09\u3002"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["\u4e0b\u9762\u662f\u4e00\u4e2a\u53ef\u4ee5\u4f7f\u7528\u7684\u8def\u7531\u7ec4\u53ca\u5176\u4ee3\u8868\u8def\u7531\u7684\u5feb\u901f\u53c2\u8003\u8868\u3002\u5982\u679c\u60a8\u9700\u8981\u8be6\u5c3d\u5217\u8868\uff0c\u8bf7\u53c2\u9605 ",(0,i.jsx)(n.code,{children:"litellm/proxy/_types.py"})," \u4e2d\u7684 ",(0,i.jsx)(n.code,{children:"LiteLLMRoutes"})," \u679a\u4e3e\u3002"]}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"\u8def\u7531\u7ec4"}),(0,i.jsx)(n.th,{children:"\u5305\u542b\u7684\u5185\u5bb9"}),(0,i.jsx)(n.th,{children:"\u4ee3\u8868\u6027\u8def\u7531"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"openai_routes"})}),(0,i.jsx)(n.td,{children:"\u517c\u5bb9 OpenAI \u7684 REST \u7aef\u70b9\uff08\u804a\u5929\u3001\u5b8c\u6210\u3001\u5d4c\u5165\u3001\u56fe\u50cf\u3001\u54cd\u5e94\u3001\u6a21\u578b\u7b49\uff09"}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"/v1/chat/completions"}),", ",(0,i.jsx)(n.code,{children:"/v1/completions"}),", ",(0,i.jsx)(n.code,{children:"/v1/embeddings"}),", ",(0,i.jsx)(n.code,{children:"/v1/images/generations"}),", ",(0,i.jsx)(n.code,{children:"/v1/models"})]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"anthropic_routes"})}),(0,i.jsxs)(n.td,{children:["Anthropic \u98ce\u683c\u7684\u7aef\u70b9\uff08\u5982 ",(0,i.jsx)(n.code,{children:"/v1/messages"})," \u53ca\u76f8\u5173\uff09"]}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"/v1/messages"}),", ",(0,i.jsx)(n.code,{children:"/v1/messages/count_tokens"}),", ",(0,i.jsx)(n.code,{children:"/v1/skills"})]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"mapped_pass_through_routes"})}),(0,i.jsxs)(n.td,{children:["\u63d0\u4f9b\u5546\u7279\u5b9a\u7684\u901a\u8fc7\u8def\u7531\u524d\u7f00\uff08\u4f8b\u5982\uff0cAnthropic \u901a\u8fc7 ",(0,i.jsx)(n.code,{children:"/anthropic"}),"\uff09\u3002\u4f7f\u7528 ",(0,i.jsx)(n.code,{children:"mapped_pass_through_routes"})," \u8fdb\u884c\u63d0\u4f9b\u5546\u6807\u8bb0\u6620\u5c04\u65f6\uff0c\u8bf7\u4e0e\u4e4b\u914d\u5408\u4f7f\u7528"]}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"/anthropic/*"}),", ",(0,i.jsx)(n.code,{children:"/vertex-ai/*"}),", ",(0,i.jsx)(n.code,{children:"/bedrock/*"})]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"passthrough_routes_wildcard"})}),(0,i.jsxs)(n.td,{children:["\u63d0\u4f9b\u5546\u901a\u914d\u7b26\u6620\u5c04\u7684\u901a\u914d\u7b26\u8def\u7531\u524d\u7f00\uff08\u4f8b\u5982\uff0c",(0,i.jsx)(n.code,{children:"/anthropic/*"}),"\uff09 - \u7531\u4ee3\u7406\u9884\u5148\u8ba1\u7b97\u7684\u901a\u914d\u7b26\u5217\u8868"]}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"/anthropic/*"}),", ",(0,i.jsx)(n.code,{children:"/vllm/*"})]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"google_routes"})}),(0,i.jsx)(n.td,{children:"Google \u7279\u5b9a\u7aef\u70b9\uff08\u5982 Vertex / \u6279\u5904\u7406\u7aef\u70b9\uff09"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"/v1beta/models/{model_name}:generateContent"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"mcp_routes"})}),(0,i.jsx)(n.td,{children:"\u5185\u90e8 MCP \u7ba1\u7406\u7aef\u70b9"}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"/mcp/tools"}),", ",(0,i.jsx)(n.code,{children:"/mcp/tools/call"})]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"info_routes"})}),(0,i.jsx)(n.td,{children:"\u7528\u4e8e UI \u7684\u53ea\u8bfb\u53ca\u4fe1\u606f\u7aef\u70b9"}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"/key/info"}),", ",(0,i.jsx)(n.code,{children:"/team/info"}),", ",(0,i.jsx)(n.code,{children:"/v1/models"})]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"management_routes"})}),(0,i.jsx)(n.td,{children:"\u53ea\u9650\u7ba1\u7406\u5458\u7684\u7ba1\u7406\u7aef\u70b9\uff08\u521b\u5efa/\u66f4\u65b0/\u5220\u9664\u7528\u6237/\u56e2\u961f/\u6a21\u578b\uff09"}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"/team/new"}),", ",(0,i.jsx)(n.code,{children:"/key/generate"}),", ",(0,i.jsx)(n.code,{children:"/model/new"})]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"spend_tracking_routes"})}),(0,i.jsx)(n.td,{children:"\u9884\u7b97/\u82b1\u8d39\u76f8\u5173\u7aef\u70b9"}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"/spend/logs"}),", ",(0,i.jsx)(n.code,{children:"/spend/keys"})]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"public_routes"})}),(0,i.jsx)(n.td,{children:"\u516c\u5f00\u548c\u672a\u8ba4\u8bc1\u7684\u7aef\u70b9"}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"/"}),", ",(0,i.jsx)(n.code,{children:"/routes"}),", ",(0,i.jsx)(n.code,{children:"/.well-known/litellm-ui-config"})]})]})]})]}),"\n",(0,i.jsxs)(n.p,{children:["\u6ce8\u610f\uff1a",(0,i.jsx)(n.code,{children:"llm_api_routes"})," \u662f OpenAI\u3001Anthropic\u3001Google \u7b49\u7aef\u70b9\uff08",(0,i.jsx)(n.code,{children:"openai_routes + anthropic_routes + google_routes + mapped_pass_through_routes + passthrough_routes_wildcard + apply_guardrail_routes + mcp_routes + litellm_native_routes"}),"\uff09\u7684\u5e76\u96c6\u3002"]}),"\n",(0,i.jsxs)(n.p,{children:["\u9ed8\u8ba4\u503c\uff1a\u5982\u679c\u5728 ",(0,i.jsx)(n.code,{children:"litellm_jwtauth"})," \u4e2d\u672a\u8986\u76d6\uff0c\u5219\u4f7f\u7528\u4ee5\u4e0b\u9ed8\u8ba4\u503c\uff1a"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"admin_jwt_scope"}),": ",(0,i.jsx)(n.code,{children:"litellm_proxy_admin"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"admin_allowed_routes"})," (\u9ed8\u8ba4): ",(0,i.jsx)(n.code,{children:"management_routes"}),", ",(0,i.jsx)(n.code,{children:"spend_tracking_routes"}),", ",(0,i.jsx)(n.code,{children:"global_spend_tracking_routes"}),", ",(0,i.jsx)(n.code,{children:"info_routes"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"team_allowed_routes"})," (\u9ed8\u8ba4): ",(0,i.jsx)(n.code,{children:"openai_routes"}),", ",(0,i.jsx)(n.code,{children:"info_routes"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"public_allowed_routes"})," (\u9ed8\u8ba4): ",(0,i.jsx)(n.code,{children:"public_routes"})]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["\u793a\u4f8b\uff1a\u5141\u8bb8\u56e2\u961f JWT \u8c03\u7528 Anthropic ",(0,i.jsx)(n.code,{children:"/v1/messages"}),"\uff08\u901a\u8fc7\u8def\u7531\u7ec4\u6216\u660e\u786e\u7684\u8def\u7531\u5b57\u7b26\u4e32\uff09\uff1a"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'general_settings:\n  enable_jwt_auth: True\n  litellm_jwtauth:\n    team_ids_jwt_field: "team_ids"\n    team_allowed_routes: ["openai_routes", "info_routes", "anthropic_routes"]\n'})}),"\n",(0,i.jsx)(n.p,{children:"\u6216\u8005\u4ec5\u9009\u62e9\u5141\u8bb8 Anthropic \u6d88\u606f\u7aef\u70b9\uff1a"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'general_settings:\n  enable_jwt_auth: True\n  litellm_jwtauth:\n    team_ids_jwt_field: "team_ids"\n    team_allowed_routes: ["/v1/messages", "info_routes"]\n'})}),"\n",(0,i.jsx)(n.h3,{id:"\u7f13\u5b58\u516c\u94a5",children:"\u7f13\u5b58\u516c\u94a5"}),"\n",(0,i.jsx)(n.p,{children:"\u63a7\u5236\u516c\u94a5\u7f13\u5b58\u65f6\u95f4\uff08\u4ee5\u79d2\u4e3a\u5355\u4f4d\uff09\u3002"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'general_settings:\n  master_key: sk-1234\n  enable_jwt_auth: True\n  litellm_jwtauth:\n    admin_jwt_scope: "litellm-proxy-admin"\n    admin_allowed_routes: ["/v1/embeddings"]\n    public_key_ttl: 600 # \ud83d\udc48 \u5173\u952e\u66f4\u6539\n'})}),"\n",(0,i.jsx)(n.h3,{id:"\u81ea\u5b9a\u4e49-jwt-\u5b57\u6bb5",children:"\u81ea\u5b9a\u4e49 JWT \u5b57\u6bb5"}),"\n",(0,i.jsxs)(n.p,{children:["\u8bbe\u7f6e\u4e00\u4e2a\u81ea\u5b9a\u4e49\u5b57\u6bb5\uff0c\u5728\u5176\u4e2d\u5b58\u50a8 team_id\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u68c0\u67e5 ",(0,i.jsx)(n.code,{children:"client_id"})," \u5b57\u6bb5\u3002"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'general_settings:\n  master_key: sk-1234\n  enable_jwt_auth: True\n  litellm_jwtauth:\n    team_id_jwt_field: "client_id" # \ud83d\udc48 \u5173\u952e\u66f4\u6539\n'})}),"\n",(0,i.jsx)(n.h3,{id:"\u963b\u6b62\u56e2\u961f",children:"\u963b\u6b62\u56e2\u961f"}),"\n",(0,i.jsxs)(n.p,{children:["\u8981\u963b\u6b62\u6240\u6709\u5177\u6709\u7279\u5b9a team_id \u7684\u8bf7\u6c42\uff0c\u8bf7\u4f7f\u7528 ",(0,i.jsx)(n.code,{children:"/team/block"}),"\u3002"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"\u963b\u6b62\u5355\u4e2a\u56e2\u961f"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"curl --location 'http://0.0.0.0:4000/team/block' \\\n--header 'Authorization: Bearer <admin-token>' \\\n--header 'Content-Type: application/json' \\\n--data '{\n    \"team_id\": \"litellm-test-client-id-new\" # \ud83d\udc48 \u8bbe\u7f6e team id\n}'\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"\u89e3\u9664\u963b\u6b62\u5355\u4e2a\u56e2\u961f"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"curl --location 'http://0.0.0.0:4000/team/unblock' \\\n--header 'Authorization: Bearer <admin-token>' \\\n--header 'Content-Type: application/json' \\\n--data '{\n    \"team_id\": \"litellm-test-client-id-new\" # \ud83d\udc48 \u8bbe\u7f6e team id\n}'\n"})}),"\n",(0,i.jsx)(n.h3,{id:"\u5141\u8bb8\u6307\u5b9a\u7535\u5b50\u90ae\u4ef6\u57df\u7684\u7528\u6237",children:"\u5141\u8bb8\u6307\u5b9a\u7535\u5b50\u90ae\u4ef6\u57df\u7684\u7528\u6237"}),"\n",(0,i.jsx)(n.p,{children:"\u5141\u8bb8\u5c5e\u4e8e\u7279\u5b9a\u7535\u5b50\u90ae\u4ef6\u57df\u7684\u7528\u6237\u81ea\u52a8\u8bbf\u95ee\u4ee3\u7406\u3002"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"\u6ce8\u610f\uff1a"})," ",(0,i.jsx)(n.code,{children:"user_allowed_email_domain"})," \u662f\u53ef\u9009\u7684\u3002\u5982\u679c\u6ca1\u6709\u6307\u5b9a\uff0c\u5219\u6240\u6709\u7528\u6237\u7684\u8bbf\u95ee\u5c06\u4e0d\u53d7\u5176\u7535\u5b50\u90ae\u4ef6\u57df\u540d\u7684\u5f71\u54cd\u3002"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'general_settings:\n  master_key: sk-1234\n  enable_jwt_auth: True\n  litellm_jwtauth:\n    user_email_jwt_field: "email" # \ud83d\udc48 \u68c0\u67e5 JWT \u8f7d\u8377\u4e2d\u7684 \'email\' \u5b57\u6bb5\n    user_allowed_email_domain: "my-co.com" # \ud83d\udc48 \u53ef\u9009 - \u5141\u8bb8 user@my-co.com \u8bbf\u95ee\u4ee3\u7406\n    user_id_upsert: true # \ud83d\udc48 \u5982\u679c\u6709\u6548\u7535\u5b50\u90ae\u4ef6\u4f46\u4e0d\u5728\u6570\u636e\u5e93\u4e2d\uff0c\u5219\u5c06\u7528\u6237\u63d2\u5165\u5230\u6570\u636e\u5e93\u4e2d\n'})}),"\n",(0,i.jsx)(n.h2,{id:"oidc-userinfo-\u7aef\u70b9",children:"OIDC UserInfo \u7aef\u70b9"}),"\n",(0,i.jsx)(n.p,{children:"\u5f53\u60a8\u7684 JWT/\u8bbf\u95ee\u4ee4\u724c\u4e0d\u5305\u542b\u7528\u6237\u6807\u8bc6\u4fe1\u606f\u65f6\uff0c\u8bf7\u4f7f\u7528\u6b64\u529f\u80fd\u3002LiteLLM \u5c06\u8c03\u7528\u8eab\u4efd\u63d0\u4f9b\u5546\u7684 UserInfo \u7aef\u70b9\u4ee5\u83b7\u53d6\u7528\u6237\u8be6\u60c5\u3002"}),"\n",(0,i.jsx)(n.h3,{id:"\u4f7f\u7528\u573a\u666f",children:"\u4f7f\u7528\u573a\u666f"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u60a8\u7684 JWT \u662f\u4e0d\u900f\u660e\u7684\uff08\u4e0d\u662f\u81ea\u5305\u542b\u7684\uff09\u6216\u7f3a\u5c11\u7528\u6237\u58f0\u660e"}),"\n",(0,i.jsx)(n.li,{children:"\u9700\u8981\u4ece\u60a8\u7684\u8eab\u4efd\u63d0\u4f9b\u5546\u5904\u83b7\u53d6\u6700\u65b0\u7684\u7528\u6237\u4fe1\u606f"}),"\n",(0,i.jsx)(n.li,{children:"\u60a8\u7684\u8bbf\u95ee\u4ee4\u724c\u4e0d\u5305\u62ec\u7535\u5b50\u90ae\u4ef6\u3001\u89d2\u8272\u6216\u5176\u4ed6\u6807\u8bc6\u6570\u636e"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"\u914d\u7f6e",children:"\u914d\u7f6e"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",metastring:'title="config.yaml" showLineNumbers',children:'general_settings:\n  enable_jwt_auth: True\n  litellm_jwtauth:\n    # \u542f\u7528 OIDC UserInfo \u7aef\u70b9\n    oidc_userinfo_enabled: true\n    oidc_userinfo_endpoint: "https://your-idp.com/oauth2/userinfo"\n    oidc_userinfo_cache_ttl: 300  # \u7f13\u5b585\u5206\u949f\uff08\u9ed8\u8ba4\u503c\uff1a300\uff09\n    \n    # \u6620\u5c04 UserInfo \u54cd\u5e94\u4e2d\u7684\u5b57\u6bb5\n    user_id_jwt_field: "sub"\n    user_email_jwt_field: "email"\n    user_roles_jwt_field: "roles"\n'})}),"\n",(0,i.jsx)(n.h3,{id:"\u6d41\u7a0b\u56fe",children:"\u6d41\u7a0b\u56fe"}),"\n",(0,i.jsx)(n.mermaid,{value:"sequenceDiagram\n    participant Client\n    participant LiteLLM\n    participant IdP as Identity Provider\n\n    Client->>LiteLLM: \u8bf7\u6c42\u5e26\u6709 Bearer \u4ee4\u724c\n    Note over LiteLLM: \u68c0\u67e5\u7f13\u5b58\u4e2d\u7684 UserInfo\n    \n    LiteLLM->>IdP: GET /userinfo (\u5982\u679c\u672a\u7f13\u5b58)<br/>Authorization: Bearer {token}\n    IdP--\x3e>LiteLLM: \u7528\u6237\u6570\u636e\uff08sub, email, roles\uff09\n    \n    Note over LiteLLM: \u7f13\u5b58\u54cd\u5e94\uff08TTL\uff1a5\u5206\u949f\uff09<br/>\u63d0\u53d6 user_id, email, roles<br/>\u6267\u884c RBAC \u68c0\u67e5\n    \n    LiteLLM--\x3e>Client: \u6388\u6743/\u62d2\u7edd"}),"\n",(0,i.jsx)(n.h3,{id:"\u793a\u4f8bazure-ad",children:"\u793a\u4f8b\uff1aAzure AD"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",metastring:'title="config.yaml" showLineNumbers',children:'litellm_jwtauth:\n  oidc_userinfo_enabled: true\n  oidc_userinfo_endpoint: "https://graph.microsoft.com/oidc/userinfo"\n  user_id_jwt_field: "sub"\n  user_email_jwt_field: "email"\n'})}),"\n",(0,i.jsx)(n.h3,{id:"\u793a\u4f8bkeycloak",children:"\u793a\u4f8b\uff1aKeycloak"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",metastring:'title="config.yaml" showLineNumbers',children:'litellm_jwtauth:\n  oidc_userinfo_enabled: true\n  oidc_userinfo_endpoint: "https://keycloak.example.com/realms/your-realm/protocol/openid-connect/userinfo"\n  user_id_jwt_field: "sub"\n  user_roles_jwt_field: "resource_access.your-client.roles"\n'})}),"\n",(0,i.jsx)(n.h2,{id:"beta-\u4f7f\u7528-oidc-\u89d2\u8272\u63a7\u5236\u8bbf\u95ee",children:"[BETA] \u4f7f\u7528 OIDC \u89d2\u8272\u63a7\u5236\u8bbf\u95ee"}),"\n",(0,i.jsx)(n.p,{children:"\u5141\u8bb8\u5177\u6709\u652f\u6301\u89d2\u8272\u7684 JWT \u8bbf\u95ee\u4ee3\u7406\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u8ba9\u7528\u6237\u548c\u56e2\u961f\u65e0\u9700\u6dfb\u52a0\u5230\u6570\u636e\u5e93\u4e2d\u5373\u53ef\u8bbf\u95ee\u4ee3\u7406\u3002"}),"\n",(0,i.jsxs)(n.p,{children:["\u975e\u5e38\u91cd\u8981\uff0c\u8bf7\u8bbe\u7f6e ",(0,i.jsx)(n.code,{children:"enforce_rbac: true"})," \u4ee5\u786e\u4fdd RBAC \u7cfb\u7edf\u542f\u7528\u3002"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"\u6ce8\u610f\uff1a"})," \u8fd9\u5c1a\u5904\u4e8e\u6d4b\u8bd5\u9636\u6bb5\uff0c\u53ef\u80fd\u4f1a\u6709\u610f\u5916\u66f4\u6539\u3002"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'general_settings:\n  enable_jwt_auth: True\n  litellm_jwtauth:\n    object_id_jwt_field: "oid" # \u53ef\u4ee5\u662f\u7528\u6237\u6216\u56e2\u961f\uff0c\u6839\u636e\u89d2\u8272\u6620\u5c04\u63a8\u65ad\n    roles_jwt_field: "roles"\n    role_mappings:\n      - role: litellm.api.consumer\n        internal_role: "team"\n    enforce_rbac: true # \ud83d\udc48 \u975e\u5e38\u91cd\u8981\n\n  role_permissions: # \u9ed8\u8ba4\u6a21\u578b + \u7aef\u70b9\u6743\u9650\u4e3a\u4e00\u4e2a\u89d2\u8272\u3002\n    - role: team\n      models: ["anthropic-claude"]\n      routes: ["/v1/chat/completions"]\n\nenvironment_variables:\n  JWT_AUDIENCE: "api://LiteLLM_Proxy" # \u786e\u4fdd\u9a8c\u8bc1 JWT \u7684\u53d7\u4f17\n'})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"object_id_jwt_field"}),": JWT \u4e2d\u5305\u542b\u7684\u5bf9\u8c61 ID \u5b57\u6bb5\u3002\u6b64 ID \u53ef\u4ee5\u662f\u7528\u6237 ID \u6216\u56e2\u961f ID\u3002\u4f7f\u7528\u6b64\u5b57\u6bb5\u4ee3\u66ff ",(0,i.jsx)(n.code,{children:"user_id_jwt_field"})," \u548c ",(0,i.jsx)(n.code,{children:"team_id_jwt_field"}),"\u3002\u5982\u679c\u540c\u4e00\u4e2a\u5b57\u6bb5\u53ef\u4ee5\u540c\u65f6\u4e3a\u4e24\u8005\u3002",(0,i.jsx)(n.strong,{children:"\u652f\u6301\u70b9\u7b26\u53f7\u8bbf\u95ee\u5d4c\u5957\u58f0\u660e"}),"\uff08\u4f8b\u5982\uff0c",(0,i.jsx)(n.code,{children:'"profile.object_id"'}),"\uff09\u3002"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"roles_jwt_field"}),": JWT \u4e2d\u5305\u542b\u7684\u89d2\u8272\u5b57\u6bb5\u3002\u6b64\u5b57\u6bb5\u662f\u7528\u6237\u62e5\u6709\u7684\u89d2\u8272\u5217\u8868\u3002",(0,i.jsx)(n.strong,{children:"\u652f\u6301\u70b9\u7b26\u53f7\u8bbf\u95ee\u5d4c\u5957\u5b57\u6bb5"})," - \u4f8b\u5982\uff0c",(0,i.jsx)(n.code,{children:"resource_access.litellm-test-client-id.roles"}),"\u3002"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"\u5176\u4ed6 JWT \u5b57\u6bb5\u914d\u7f6e\u9009\u9879\uff1a"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"team_ids_jwt_field"}),": \u5305\u542b\u56e2\u961f ID \u7684\u5b57\u6bb5\uff08\u4f5c\u4e3a\u5217\u8868\uff09\u3002",(0,i.jsx)(n.strong,{children:"\u652f\u6301\u70b9\u7b26\u53f7"})," (\u4f8b\u5982\uff0c",(0,i.jsx)(n.code,{children:'"groups"'}),"\uff0c",(0,i.jsx)(n.code,{children:'"teams.ids"'}),")\u3002"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"user_email_jwt_field"}),": \u5305\u542b\u7528\u6237\u7535\u5b50\u90ae\u4ef6\u7684\u5b57\u6bb5\u3002",(0,i.jsx)(n.strong,{children:"\u652f\u6301\u70b9\u7b26\u53f7"})," (\u4f8b\u5982\uff0c",(0,i.jsx)(n.code,{children:'"email"'}),"\uff0c",(0,i.jsx)(n.code,{children:'"user.email"'}),")\u3002"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"end_user_id_jwt_field"}),": \u5305\u542b\u6700\u7ec8\u7528\u6237 ID \u7684\u5b57\u6bb5\u3002",(0,i.jsx)(n.strong,{children:"\u652f\u6301\u70b9\u7b26\u53f7"})," (\u4f8b\u5982\uff0c",(0,i.jsx)(n.code,{children:'"customer_id"'}),"\uff0c",(0,i.jsx)(n.code,{children:'"user.id"'}),")"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"\u793a\u4f8b JWT\uff1a"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "sub": "user-123",\n  "roles": ["ADMIN"],\n  "groups": ["team-alpha", "team-beta"],\n  "iat": 1234567890,\n  "exp": 1234567890\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"\u5982\u4f55\u5de5\u4f5c",children:"\u5982\u4f55\u5de5\u4f5c"}),"\n",(0,i.jsx)(n.p,{children:"\u5f53\u7528\u6237\u4f7f\u7528 JWT \u53d1\u51fa\u8bf7\u6c42\u65f6\uff1a"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"\u89d2\u8272\u540c\u6b65"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"LiteLLM \u68c0\u67e5 JWT \u4e2d\u7684\u7528\u6237\u89d2\u8272\u662f\u5426\u4e0e\u6570\u636e\u5e93\u4e2d\u7684\u89d2\u8272\u4e0d\u540c"}),"\n",(0,i.jsx)(n.li,{children:"\u5982\u679c\u4e0d\u540c\uff0c\u5219\u66f4\u65b0 LiteLLM \u6570\u636e\u5e93\u4e2d\u7684\u7528\u6237\u89d2\u8272"}),"\n",(0,i.jsxs)(n.li,{children:["\u4f7f\u7528 ",(0,i.jsx)(n.code,{children:"jwt_litellm_role_map"})," \u5c06 JWT \u89d2\u8272\u8f6c\u6362\u4e3a LiteLLM \u89d2\u8272"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"\u56e2\u961f\u6210\u5458\u540c\u6b65"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u6bd4\u8f83 JWT \u4e2d\u7684\u56e2\u961f\u6210\u5458\u4e0e LiteLLM \u4e2d\u7528\u6237\u7684\u5f53\u524d\u56e2\u961f"}),"\n",(0,i.jsx)(n.li,{children:"\u5411\u7528\u6237\u6dfb\u52a0\u65b0\u53d1\u73b0\u7684\u56e2\u961f"}),"\n",(0,i.jsx)(n.li,{children:"\u4ece\u672a\u51fa\u73b0\u5728 JWT \u4e2d\u7684\u56e2\u961f\u4e2d\u79fb\u9664\u7528\u6237"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"\u6570\u636e\u5e93\u66f4\u65b0"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u66f4\u65b0\u5728\u8ba4\u8bc1\u8fc7\u7a0b\u4e2d\u81ea\u52a8\u53d1\u751f"}),"\n",(0,i.jsx)(n.li,{children:"\u4e0d\u9700\u8981\u624b\u52a8\u5e72\u9884"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"\u914d\u7f6e\u9009\u9879",children:"\u914d\u7f6e\u9009\u9879"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'general_settings:\n  enable_jwt_auth: True\n  litellm_jwtauth:\n    # \u5fc5\u586b\u5b57\u6bb5\n    user_id_jwt_field: "sub"\n    team_ids_jwt_field: "groups"\n    roles_jwt_field: "roles"\n    \n    # \u540c\u6b65\u914d\u7f6e\n    sync_user_role_and_teams: true\n    user_id_upsert: true\n    \n    # \u89d2\u8272\u6620\u5c04\n    jwt_litellm_role_map:\n      - jwt_role: "ADMIN_*"  # \u4f7f\u7528 `fnmatch` \u7684\u901a\u914d\u7b26\u6a21\u5f0f\n        litellm_role: "proxy_admin"\n      - jwt_role: "USER"\n        litellm_role: "internal_user"\n      - jwt_role: "VIEWER"\n        litellm_role: "internal_user"\n'})}),"\n",(0,i.jsx)(n.h3,{id:"\u91cd\u8981\u6ce8\u610f\u4e8b\u9879",children:"\u91cd\u8981\u6ce8\u610f\u4e8b\u9879"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u6027\u80fd"}),": \u540c\u6b65\u64cd\u4f5c\u53d1\u751f\u5728\u8ba4\u8bc1\u8fc7\u7a0b\u4e2d\uff0c\u53ef\u80fd\u4f1a\u589e\u52a0\u8f7b\u5fae\u7684\u5ef6\u8fdf"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u6570\u636e\u5e93\u8bbf\u95ee"}),": \u9700\u8981\u5bf9\u7528\u6237\u548c\u56e2\u961f\u8fdb\u884c\u66f4\u65b0\u7684\u6570\u636e\u5e93\u8bbf\u95ee\u6743\u9650"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u56e2\u961f\u521b\u5efa"}),": JWT \u4e2d\u63d0\u5230\u7684\u56e2\u961f\u5fc5\u987b\u5728 LiteLLM \u4e2d\u5b58\u5728\u624d\u80fd\u5206\u914d\u7ed9\u5b83\u4eec"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u901a\u914d\u7b26\u652f\u6301"}),": JWT \u89d2\u8272\u6a21\u5f0f\u652f\u6301\u4f7f\u7528 ",(0,i.jsx)(n.code,{children:"fnmatch"})," \u7684\u901a\u914d\u7b26\u5339\u914d"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"\u6d4b\u8bd5\u540c\u6b65\u529f\u80fd",children:"\u6d4b\u8bd5\u540c\u6b65\u529f\u80fd"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u521b\u5efa\u4e00\u4e2a\u5177\u6709\u521d\u59cb\u89d2\u8272\u7684\u6d4b\u8bd5\u7528\u6237"}),"\uff1a"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"curl -X POST 'http://0.0.0.0:4000/user/new' \\\n-H 'Authorization: Bearer <PROXY_MASTER_KEY>' \\\n-H 'Content-Type: application/json' \\\n-d '{\n    \"user_id\": \"user-123\",\n    \"user_role\": \"internal_user\"\n}'\n"})}),"\n",(0,i.jsxs)(n.ol,{start:"2",children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u4f7f\u7528\u5305\u542b\u4e0d\u540c\u89d2\u8272\u7684 JWT \u53d1\u9001\u8bf7\u6c42"}),"\uff1a"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'curl -X POST \'http://0.0.0.0:4000/v1/chat/completions\' \\\n-H \'Content-Type: application/json\' \\\n-H \'Authorization: Bearer <JWT_WITH_ADMIN_ROLE>\' \\\n-d \'{\n  "model": "claude-sonnet-4-20250514",\n  "messages": [{"role": "user", "content": "Hello"}]\n}\'\n'})}),"\n",(0,i.jsxs)(n.ol,{start:"3",children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u9a8c\u8bc1\u89d2\u8272\u662f\u5426\u66f4\u65b0"}),"\uff1a"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"curl -X GET 'http://0.0.0.0:4000/user/info?user_id=user-123' \\\n-H 'Authorization: Bearer <PROXY_MASTER_KEY>'\n"})}),"\n",(0,i.jsx)(n.h3,{id:"\u6240\u6709-jwt-\u53c2\u6570",children:"\u6240\u6709 JWT \u53c2\u6570"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.a,{href:"https://github.com/BerriAI/litellm/blob/b204f0c01c703317d812a1553363ab0cb989d5b6/litellm/proxy/_types.py#L95",children:(0,i.jsx)(n.strong,{children:"\u67e5\u770b\u4ee3\u7801"})})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{})})]})}function j(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(u,{...e})}):u(e)}}}]);