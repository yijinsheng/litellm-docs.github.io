(globalThis.webpackChunkmy_website=globalThis.webpackChunkmy_website||[]).push([[37957],{36251(e,n,l){"use strict";l.r(n),l.d(n,{assets:()=>d,contentTitle:()=>r,default:()=>p,frontMatter:()=>t,metadata:()=>s,toc:()=>h});const s=JSON.parse('{"id":"tutorials/model_config_proxy","title":"\u5728\u517c\u5bb9 OpenAI \u7684\u670d\u52a1\u5668\u4e0a\u81ea\u5b9a\u4e49\u63d0\u793a\u6a21\u677f","description":"\u4f60\u5c06\u5b66\u4e60\uff1a \u5982\u4f55\u5728\u6211\u4eec\u7684\u517c\u5bb9 OpenAI \u670d\u52a1\u5668\u4e0a\u8bbe\u7f6e\u81ea\u5b9a\u4e49\u63d0\u793a\u6a21\u677f\u3002","source":"@site/docs/tutorials/model_config_proxy.md","sourceDirName":"tutorials","slug":"/tutorials/model_config_proxy","permalink":"/docs/tutorials/model_config_proxy","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{}}');var i=l(74848),a=l(28453),c=l(90547);const t={},r="\u5728\u517c\u5bb9 OpenAI \u7684\u670d\u52a1\u5668\u4e0a\u81ea\u5b9a\u4e49\u63d0\u793a\u6a21\u677f",d={},h=[{value:"\u7b2c\u4e00\u6b65\uff1a\u542f\u52a8\u517c\u5bb9 OpenAI \u7684\u670d\u52a1\u5668",id:"\u7b2c\u4e00\u6b65\u542f\u52a8\u517c\u5bb9-openai-\u7684\u670d\u52a1\u5668",level:2},{value:"\u7b2c\u4e8c\u6b65\uff1a\u521b\u5efa\u81ea\u5b9a\u4e49\u63d0\u793a\u6a21\u677f",id:"\u7b2c\u4e8c\u6b65\u521b\u5efa\u81ea\u5b9a\u4e49\u63d0\u793a\u6a21\u677f",level:2},{value:"\u7b2c\u4e09\u6b65\uff1a\u8fd0\u884c\u65b0\u7684\u6a21\u677f",id:"\u7b2c\u4e09\u6b65\u8fd0\u884c\u65b0\u7684\u6a21\u677f",level:2}];function o(e){const n={a:"a",br:"br",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"\u5728\u517c\u5bb9-openai-\u7684\u670d\u52a1\u5668\u4e0a\u81ea\u5b9a\u4e49\u63d0\u793a\u6a21\u677f",children:"\u5728\u517c\u5bb9 OpenAI \u7684\u670d\u52a1\u5668\u4e0a\u81ea\u5b9a\u4e49\u63d0\u793a\u6a21\u677f"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"\u4f60\u5c06\u5b66\u4e60\uff1a"})," \u5982\u4f55\u5728\u6211\u4eec\u7684\u517c\u5bb9 OpenAI \u670d\u52a1\u5668\u4e0a\u8bbe\u7f6e\u81ea\u5b9a\u4e49\u63d0\u793a\u6a21\u677f\u3002",(0,i.jsx)(n.br,{}),"\n",(0,i.jsx)(n.strong,{children:"\u600e\u4e48\u505a\uff1f"})," \u6211\u4eec\u5c06\u4fee\u6539 CodeLlama \u7684\u63d0\u793a\u6a21\u677f\u3002"]}),"\n",(0,i.jsx)(n.h2,{id:"\u7b2c\u4e00\u6b65\u542f\u52a8\u517c\u5bb9-openai-\u7684\u670d\u52a1\u5668",children:"\u7b2c\u4e00\u6b65\uff1a\u542f\u52a8\u517c\u5bb9 OpenAI \u7684\u670d\u52a1\u5668"}),"\n",(0,i.jsxs)(n.p,{children:["\u8ba9\u6211\u4eec\u542f\u52a8\u4e00\u4e2a\u672c\u5730\u7684\u517c\u5bb9 OpenAI \u670d\u52a1\u5668\uff0c\u4f7f\u7528 Huggingface \u7684 ",(0,i.jsx)(n.a,{href:"https://github.com/huggingface/text-generation-inference",children:"Text-Generation-Inference (TGI)"})," \u683c\u5f0f\u8c03\u7528\u5df2\u90e8\u7f72\u7684 ",(0,i.jsx)(n.code,{children:"codellama/CodeLlama-34b-Instruct-hf"})," \u6a21\u578b\u3002"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",children:"$ litellm --model huggingface/codellama/CodeLlama-34b-Instruct-hf --api_base https://my-endpoint.com\n\n# \u5728 http://0.0.0.0:8000 \u4e0a\u8fd0\u884c\u517c\u5bb9 OpenAI \u7684\u670d\u52a1\u5668\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u5728\u65b0\u7684\u7ec8\u7aef\u4e2d\u8fd0\u884c\uff1a"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",children:"$ litellm --test\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u8fd9\u5c06\u5411\u6211\u4eec\u7684\u7aef\u70b9\u53d1\u9001\u4e00\u4e2a\u6d4b\u8bd5\u8bf7\u6c42\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u73b0\u5728\uff0c\u8ba9\u6211\u4eec\u770b\u770b\u53d1\u9001\u7ed9 Huggingface \u7684\u5185\u5bb9\u3002\u8fd0\u884c\uff1a"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",children:"$ litellm --logs\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u8fd9\u5c06\u8fd4\u56de\u6700\u8fd1\u7684\u65e5\u5fd7\uff08\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u65e5\u5fd7\u5b58\u50a8\u5728\u4e00\u4e2a\u540d\u4e3a 'api_logs.json' \u7684\u672c\u5730\u6587\u4ef6\u4e2d\uff09\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u5982\u6211\u4eec\u6240\u89c1\uff0c\u8fd9\u662f\u53d1\u9001\u7ed9 Huggingface \u7684\u683c\u5f0f\uff1a"}),"\n",(0,i.jsx)(c.A,{img:l(65575)}),"\n",(0,i.jsxs)(n.p,{children:["\u8fd9\u9075\u5faa\u4e86 ",(0,i.jsx)(n.a,{href:"https://github.com/BerriAI/litellm/blob/9932371f883c55fd0f3142f91d9c40279e8fe241/litellm/llms/prompt_templates/factory.py#L10",children:"\u6211\u4eec\u7684\u63d0\u793a\u6a21\u677f\u683c\u5f0f"}),"\uff08\u57fa\u4e8e ",(0,i.jsx)(n.a,{href:"https://huggingface.co/blog/codellama#conversational-instructions",children:"Huggingface \u7684\u6587\u6863"}),"\uff09\u3002"]}),"\n",(0,i.jsxs)(n.p,{children:["\u4f46\u7f3a\u5c11 BOS(",(0,i.jsx)(n.code,{children:"<s>"}),") \u548c EOS(",(0,i.jsx)(n.code,{children:"</s>"}),") \u6807\u8bb0\u3002"]}),"\n",(0,i.jsx)(n.p,{children:"\u56e0\u6b64\uff0c\u6211\u4eec\u4e0d\u4f7f\u7528 LiteLLM \u9ed8\u8ba4\u7684\u683c\u5f0f\uff0c\u800c\u662f\u4f7f\u7528\u81ea\u5b9a\u4e49\u63d0\u793a\u6a21\u677f\uff0c\u5728\u6d88\u606f\u4e2d\u5305\u542b\u8fd9\u4e9b\u6807\u8bb0\u3002"}),"\n",(0,i.jsx)(n.h2,{id:"\u7b2c\u4e8c\u6b65\u521b\u5efa\u81ea\u5b9a\u4e49\u63d0\u793a\u6a21\u677f",children:"\u7b2c\u4e8c\u6b65\uff1a\u521b\u5efa\u81ea\u5b9a\u4e49\u63d0\u793a\u6a21\u677f"}),"\n",(0,i.jsxs)(n.p,{children:["\u6211\u4eec\u7684 litellm \u670d\u52a1\u5668\u63a5\u53d7\u4f5c\u4e3a\u914d\u7f6e\u6587\u4ef6\u4e00\u90e8\u5206\u7684\u63d0\u793a\u6a21\u677f\u3002\u60a8\u53ef\u4ee5\u5728\u6b64\u914d\u7f6e\u6587\u4ef6\u4e2d\u4fdd\u5b58 API \u5bc6\u94a5\u3001\u5907\u7528\u6a21\u578b\u3001\u63d0\u793a\u6a21\u677f\u7b49\u4fe1\u606f\u3002",(0,i.jsx)(n.a,{href:"/docs/proxy_server",children:"\u67e5\u770b\u4e00\u4e2a\u5b8c\u6574\u7684\u914d\u7f6e\u6587\u4ef6"})]}),"\n",(0,i.jsx)(n.p,{children:"\u76ee\u524d\uff0c\u6211\u4eec\u53ea\u9700\u521b\u5efa\u4e00\u4e2a\u7b80\u5355\u7684\u5305\u542b\u81ea\u5b9a\u4e49\u63d0\u793a\u6a21\u677f\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u5e76\u544a\u77e5\u670d\u52a1\u5668\u3002"}),"\n",(0,i.jsxs)(n.p,{children:["\u521b\u5efa\u540d\u4e3a ",(0,i.jsx)(n.code,{children:"litellm_config.toml"})," \u7684\u6587\u4ef6\uff1a"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",children:"$ touch litellm_config.toml\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u6211\u4eec\u9700\u8981\u6dfb\u52a0\uff1a"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\u5728\u6bcf\u4e2a\u7cfb\u7edf\u6d88\u606f\u548c\u4eba\u7c7b\u6d88\u606f\u7684\u5f00\u5934\u4f7f\u7528 BOS (",(0,i.jsx)(n.code,{children:"<s>"}),") \u6807\u8bb0\u3002"]}),"\n",(0,i.jsxs)(n.li,{children:["\u5728\u6bcf\u4e2a\u52a9\u624b\u6d88\u606f\u7684\u7ed3\u5c3e\u4f7f\u7528 EOS (",(0,i.jsx)(n.code,{children:"</s>"}),") \u6807\u8bb0\u3002"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u8ba9\u6211\u4eec\u5728\u7ec8\u7aef\u4e2d\u6253\u5f00\u6211\u4eec\u7684\u6587\u4ef6\uff1a"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",children:"$ vi litellm_config.toml\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u7c98\u8d34\u6211\u4eec\u7684\u63d0\u793a\u6a21\u677f\uff1a"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",children:'[model."huggingface/codellama/CodeLlama-34b-Instruct-hf".prompt_template] \nMODEL_SYSTEM_MESSAGE_START_TOKEN = "<s>[INST]  <<SYS>>\\n]" \nMODEL_SYSTEM_MESSAGE_END_TOKEN = "\\n<</SYS>>\\n [/INST]\\n"\n\nMODEL_USER_MESSAGE_START_TOKEN = "<s>[INST] " \nMODEL_USER_MESSAGE_END_TOKEN = " [/INST]\\n"\n\nMODEL_ASSISTANT_MESSAGE_START_TOKEN = ""\nMODEL_ASSISTANT_MESSAGE_END_TOKEN = "</s>"\n'})}),"\n",(0,i.jsx)(n.p,{children:"\u4fdd\u5b58\u6211\u4eec\u7684\u6587\u4ef6\uff08\u5728 vim \u4e2d\uff09:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",children:":wq\n"})}),"\n",(0,i.jsx)(n.h2,{id:"\u7b2c\u4e09\u6b65\u8fd0\u884c\u65b0\u7684\u6a21\u677f",children:"\u7b2c\u4e09\u6b65\uff1a\u8fd0\u884c\u65b0\u7684\u6a21\u677f"}),"\n",(0,i.jsx)(n.p,{children:"\u8ba9\u6211\u4eec\u901a\u8fc7\u8fd0\u884c\u4ee5\u4e0b\u547d\u4ee4\u5c06\u81ea\u5b9a\u4e49\u6a21\u677f\u4fdd\u5b58\u5230\u6211\u4eec\u7684 litellm \u670d\u52a1\u5668\uff1a"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",children:"$ litellm --config -f ./litellm_config.toml \n"})}),"\n",(0,i.jsx)(n.p,{children:"LiteLLM \u5c06\u5728\u5b83\u7684\u5305\u4e2d\u4fdd\u5b58\u6b64\u6587\u4ef6\u7684\u4e00\u4e2a\u526f\u672c\uff0c\u4ee5\u4fbf\u5728\u91cd\u542f\u65f6\u4fdd\u6301\u8fd9\u4e9b\u8bbe\u7f6e\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u91cd\u65b0\u542f\u52a8\u6211\u4eec\u7684\u670d\u52a1\u5668\uff1a"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",children:"$ litellm --model huggingface/codellama/CodeLlama-34b-Instruct-hf --api_base https://my-endpoint.com\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u5728\u65b0\u7684\u7ec8\u7aef\u4e2d\u8fd0\u884c\uff1a"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",children:"$ litellm --test\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u770b\u770b\u53d1\u9001\u7ed9 Huggingface \u7684\u65b0\u8f93\u5165\u63d0\u793a\uff01"}),"\n",(0,i.jsx)(c.A,{img:l(49398)}),"\n",(0,i.jsx)(n.p,{children:"\u606d\u559c\u4f60 \ud83c\udf89"})]})}function p(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(o,{...e})}):o(e)}},49398(e,n,l){e.exports={src:Object.assign(Object.create({toString(){return this.src}}),{srcSet:l.p+"assets/ideal-img/codellama_formatted_input.0e856f3.640.png 640w,"+l.p+"assets/ideal-img/codellama_formatted_input.59d7c79.729.png 729w",images:[{path:l.p+"assets/ideal-img/codellama_formatted_input.0e856f3.640.png",width:640,height:19},{path:l.p+"assets/ideal-img/codellama_formatted_input.59d7c79.729.png",width:729,height:22}],src:l.p+"assets/ideal-img/codellama_formatted_input.0e856f3.640.png",placeholder:void 0,width:640,height:19}),preSrc:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAABCAYAAADn9T9+AAAACXBIWXMAAAsTAAALEwEAmpwYAAAALklEQVR4nBXJywkAMAhEwdSjsPjB/uvykhcy1znufiOCqsLMyEy6m5lBEv8k7QMxdw+EJ0XJbAAAAABJRU5ErkJggg=="}},65575(e,n,l){e.exports={src:Object.assign(Object.create({toString(){return this.src}}),{srcSet:l.p+"assets/ideal-img/codellama_input.1ba6983.640.png 640w,"+l.p+"assets/ideal-img/codellama_input.bd3a6c2.1134.png 1134w",images:[{path:l.p+"assets/ideal-img/codellama_input.1ba6983.640.png",width:640,height:20},{path:l.p+"assets/ideal-img/codellama_input.bd3a6c2.1134.png",width:1134,height:35}],src:l.p+"assets/ideal-img/codellama_input.1ba6983.640.png",placeholder:void 0,width:640,height:20}),preSrc:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAABCAYAAADn9T9+AAAACXBIWXMAAAsTAAALEwEAmpwYAAAALElEQVR4nGMISav/H5Hd+j80o+l/SHrj/6ic1v8xee1gDBKLyGn7H5RU+QsAxP0WkYPoDcoAAAAASUVORK5CYII="}}}]);