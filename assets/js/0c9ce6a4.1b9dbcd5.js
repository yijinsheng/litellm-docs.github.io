(globalThis.webpackChunkmy_website=globalThis.webpackChunkmy_website||[]).push([[64006],{7227(e,l,s){"use strict";s.d(l,{A:()=>d});s(96540);var n=s(18215);const i="tabItem_Ymn6";var r=s(74848);function d({children:e,hidden:l,className:s}){return(0,r.jsx)("div",{role:"tabpanel",className:(0,n.A)(i,s),hidden:l,children:e})}},24871(e,l,s){e.exports={src:Object.assign(Object.create({toString(){return this.src}}),{srcSet:s.p+"assets/ideal-img/grafana_2.011ffb8.640.png 640w,"+s.p+"assets/ideal-img/grafana_2.6844861.1920.png 1920w",images:[{path:s.p+"assets/ideal-img/grafana_2.011ffb8.640.png",width:640,height:129},{path:s.p+"assets/ideal-img/grafana_2.6844861.1920.png",width:1920,height:387}],src:s.p+"assets/ideal-img/grafana_2.011ffb8.640.png",placeholder:void 0,width:640,height:129}),preSrc:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAACCAYAAABhYU3QAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAUElEQVR4nC3D2w2AIAwAQKeQgtAHQkncfxRnMNovFyD1x0tuYdGZcfcVsodYPG7kJOoxkQcoExJ6gHwthdqN3I1E/8NqP4xYjWU8XMeL1M4PIEMaNiLoAU8AAAAASUVORK5CYII="}},34015(e,l,s){e.exports={src:Object.assign(Object.create({toString(){return this.src}}),{srcSet:s.p+"assets/ideal-img/grafana_1.f82d883.640.png 640w,"+s.p+"assets/ideal-img/grafana_1.bef38f5.1920.png 1920w",images:[{path:s.p+"assets/ideal-img/grafana_1.f82d883.640.png",width:640,height:322},{path:s.p+"assets/ideal-img/grafana_1.bef38f5.1920.png",width:1920,height:966}],src:s.p+"assets/ideal-img/grafana_1.f82d883.640.png",placeholder:void 0,width:640,height:322}),preSrc:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAFCAYAAAB8ZH1oAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAnElEQVR4nDXMORICIRBAUW7gMOMAzdJsLlXe/zYG5hYEQ2Ii05ZYBi/8n2kTNvTnJpVrx1UPCrAp8E0Cbqswr2XVD2Z9IuczaRt+XCQMmSwmMi7uFiNJwMLQn3q+3HrI125c7NqGbjB2h7GDwbe2noS0T/a9jBrTOILxNC9q4LPc+SyJc1GYMqE4TFW7WEH7qgDrxMVfOUyiTVzcP6czP9KvqQ2XAAAAAElFTkSuQmCC"}},37182(e,l,s){e.exports={src:Object.assign(Object.create({toString(){return this.src}}),{srcSet:s.p+"assets/ideal-img/grafana_3.c6811f0.640.png 640w,"+s.p+"assets/ideal-img/grafana_3.173da82.1920.png 1920w",images:[{path:s.p+"assets/ideal-img/grafana_3.c6811f0.640.png",width:640,height:168},{path:s.p+"assets/ideal-img/grafana_3.173da82.1920.png",width:1920,height:504}],src:s.p+"assets/ideal-img/grafana_3.c6811f0.640.png",placeholder:void 0,width:640,height:168}),preSrc:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAADCAYAAACqPZ51AAAACXBIWXMAABYlAAAWJQFJUiTwAAAAbUlEQVR4nD3IOQ7CMBQFQN8hsf0XPy84Qty/5hBImCI9F0DIaQAZkYJimjGK8ij1tInmPlvdeYndefTJyXN2+posrwa5vpGXEeLhryzHgbTfB6kO0nQ3JLgoyo0kth/HoUlIjTg0YlyJ42q9nr8MbyVJ8RnrwAAAAABJRU5ErkJggg=="}},49489(e,l,s){"use strict";s.d(l,{A:()=>v});var n=s(96540),i=s(18215),r=s(24245),d=s(56347),t=s(36494),c=s(62814),a=s(45167),h=s(69900);function o(e){return n.Children.toArray(e).filter(e=>"\n"!==e).map(e=>{if(!e||(0,n.isValidElement)(e)&&function(e){const{props:l}=e;return!!l&&"object"==typeof l&&"value"in l}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})?.filter(Boolean)??[]}function x(e){const{values:l,children:s}=e;return(0,n.useMemo)(()=>{const e=l??function(e){return o(e).map(({props:{value:e,label:l,attributes:s,default:n}})=>({value:e,label:l,attributes:s,default:n}))}(s);return function(e){const l=(0,a.XI)(e,(e,l)=>e.value===l.value);if(l.length>0)throw new Error(`Docusaurus error: Duplicate values "${l.map(e=>e.value).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e},[l,s])}function _({value:e,tabValues:l}){return l.some(l=>l.value===e)}function j({queryString:e=!1,groupId:l}){const s=(0,d.W6)(),i=function({queryString:e=!1,groupId:l}){if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!l)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return l??null}({queryString:e,groupId:l});return[(0,c.aZ)(i),(0,n.useCallback)(e=>{if(!i)return;const l=new URLSearchParams(s.location.search);l.set(i,e),s.replace({...s.location,search:l.toString()})},[i,s])]}function m(e){const{defaultValue:l,queryString:s=!1,groupId:i}=e,r=x(e),[d,c]=(0,n.useState)(()=>function({defaultValue:e,tabValues:l}){if(0===l.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!_({value:e,tabValues:l}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${l.map(e=>e.value).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}const s=l.find(e=>e.default)??l[0];if(!s)throw new Error("Unexpected error: 0 tabValues");return s.value}({defaultValue:l,tabValues:r})),[a,o]=j({queryString:s,groupId:i}),[m,u]=function({groupId:e}){const l=function(e){return e?`docusaurus.tab.${e}`:null}(e),[s,i]=(0,h.Dv)(l);return[s,(0,n.useCallback)(e=>{l&&i.set(e)},[l,i])]}({groupId:i}),p=(()=>{const e=a??m;return _({value:e,tabValues:r})?e:null})();(0,t.A)(()=>{p&&c(p)},[p]);return{selectedValue:d,selectValue:(0,n.useCallback)(e=>{if(!_({value:e,tabValues:r}))throw new Error(`Can't select invalid tab value=${e}`);c(e),o(e),u(e)},[o,u,r]),tabValues:r}}var u=s(11062);const p="tabList__CuJ",g="tabItem_LNqP";var b=s(74848);function A({className:e,block:l,selectedValue:s,selectValue:n,tabValues:d}){const t=[],{blockElementScrollPositionUntilNextRender:c}=(0,r.a_)(),a=e=>{const l=e.currentTarget,i=t.indexOf(l),r=d[i].value;r!==s&&(c(l),n(r))},h=e=>{let l=null;switch(e.key){case"Enter":a(e);break;case"ArrowRight":{const s=t.indexOf(e.currentTarget)+1;l=t[s]??t[0];break}case"ArrowLeft":{const s=t.indexOf(e.currentTarget)-1;l=t[s]??t[t.length-1];break}}l?.focus()};return(0,b.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,i.A)("tabs",{"tabs--block":l},e),children:d.map(({value:e,label:l,attributes:n})=>(0,b.jsx)("li",{role:"tab",tabIndex:s===e?0:-1,"aria-selected":s===e,ref:e=>{t.push(e)},onKeyDown:h,onClick:a,...n,className:(0,i.A)("tabs__item",g,n?.className,{"tabs__item--active":s===e}),children:l??e},e))})}function y({lazy:e,children:l,selectedValue:s}){const r=(Array.isArray(l)?l:[l]).filter(Boolean);if(e){const e=r.find(e=>e.props.value===s);return e?(0,n.cloneElement)(e,{className:(0,i.A)("margin-top--md",e.props.className)}):null}return(0,b.jsx)("div",{className:"margin-top--md",children:r.map((e,l)=>(0,n.cloneElement)(e,{key:l,hidden:e.props.value!==s}))})}function f(e){const l=m(e);return(0,b.jsxs)("div",{className:(0,i.A)("tabs-container",p),children:[(0,b.jsx)(A,{...l,...e}),(0,b.jsx)(y,{...l,...e})]})}function v(e){const l=(0,u.A)();return(0,b.jsx)(f,{...e,children:o(e.children)},String(l))}},59041(e,l,s){"use strict";s.r(l),s.d(l,{assets:()=>o,contentTitle:()=>h,default:()=>j,frontMatter:()=>a,metadata:()=>n,toc:()=>x});const n=JSON.parse('{"id":"proxy/prometheus","title":"\ud83d\udcc8 Prometheus \u6307\u6807","description":"LiteLLM \u4e3a Prometheus \u63d0\u4f9b\u4e86\u4e00\u4e2a /metrics \u7aef\u70b9\u4ee5\u8fdb\u884c\u8f6e\u8be2\u3002","source":"@site/docs/proxy/prometheus.md","sourceDirName":"proxy","slug":"/proxy/prometheus","permalink":"/docs/proxy/prometheus","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"integrationsSidebar","previous":{"title":"PagerDuty \u8b66\u62a5","permalink":"/docs/proxy/pagerduty"},"next":{"title":"LiteLLM AI Gateway Prompt Management","permalink":"/docs/proxy/litellm_prompt_management"}}');var i=s(74848),r=s(28453),d=s(49489),t=s(7227),c=s(90547);const a={},h="\ud83d\udcc8 Prometheus \u6307\u6807",o={},x=[{value:"\u5feb\u901f\u5165\u95e8",id:"\u5feb\u901f\u5165\u95e8",level:2},{value:"\u591a\u4e2a Worker",id:"\u591a\u4e2a-worker",level:3},{value:"\u865a\u62df\u5bc6\u94a5\u3001\u56e2\u961f\u3001\u5185\u90e8\u7528\u6237",id:"\u865a\u62df\u5bc6\u94a5\u56e2\u961f\u5185\u90e8\u7528\u6237",level:2},{value:"\u56e2\u961f - \u9884\u7b97",id:"\u56e2\u961f---\u9884\u7b97",level:3},{value:"\u865a\u62df\u5bc6\u94a5 - \u9884\u7b97",id:"\u865a\u62df\u5bc6\u94a5---\u9884\u7b97",level:3},{value:"\u865a\u62df\u5bc6\u94a5 - \u901f\u7387\u9650\u5236",id:"\u865a\u62df\u5bc6\u94a5---\u901f\u7387\u9650\u5236",level:3},{value:"\u521d\u59cb\u5316\u9884\u7b97\u6307\u6807",id:"\u521d\u59cb\u5316\u9884\u7b97\u6307\u6807",level:3},{value:"\u4ee3\u7406\u7ea7\u522b\u8ddf\u8e2a\u6307\u6807",id:"\u4ee3\u7406\u7ea7\u522b\u8ddf\u8e2a\u6307\u6807",level:2},{value:"\u56de\u8c03\u65e5\u5fd7\u8bb0\u5f55\u6307\u6807",id:"\u56de\u8c03\u65e5\u5fd7\u8bb0\u5f55\u6307\u6807",level:3},{value:"LLM \u63d0\u4f9b\u5546\u6307\u6807",id:"llm-\u63d0\u4f9b\u5546\u6307\u6807",level:2},{value:"\u8ddf\u8e2a\u7684\u6807\u7b7e",id:"\u8ddf\u8e2a\u7684\u6807\u7b7e",level:3},{value:"\u6210\u529f\u4e0e\u5931\u8d25",id:"\u6210\u529f\u4e0e\u5931\u8d25",level:3},{value:"\u5269\u4f59\u8bf7\u6c42\u548c\u4ee4\u724c",id:"\u5269\u4f59\u8bf7\u6c42\u548c\u4ee4\u724c",level:3},{value:"\u90e8\u7f72\u72b6\u6001",id:"\u90e8\u7f72\u72b6\u6001",level:3},{value:"\u964d\u7ea7 (\u6545\u969c\u8f6c\u79fb) \u6307\u6807",id:"\u964d\u7ea7-\u6545\u969c\u8f6c\u79fb-\u6307\u6807",level:4},{value:"\u8bf7\u6c42\u8ba1\u6570\u6307\u6807",id:"\u8bf7\u6c42\u8ba1\u6570\u6307\u6807",level:2},{value:"\u8bf7\u6c42\u5ef6\u8fdf\u6307\u6807",id:"\u8bf7\u6c42\u5ef6\u8fdf\u6307\u6807",level:2},{value:"\u5728 Prometheus \u4e2d\u8ddf\u8e2a <code>end_user</code>",id:"\u5728-prometheus-\u4e2d\u8ddf\u8e2a-end_user",level:2},{value:"[BETA] \u81ea\u5b9a\u4e49\u6307\u6807",id:"beta-\u81ea\u5b9a\u4e49\u6307\u6807",level:2},{value:"\u81ea\u5b9a\u4e49\u5143\u6570\u636e\u6807\u7b7e",id:"\u81ea\u5b9a\u4e49\u5143\u6570\u636e\u6807\u7b7e",level:3},{value:"\u81ea\u5b9a\u4e49\u6807\u7b7e",id:"\u81ea\u5b9a\u4e49\u6807\u7b7e",level:3},{value:"\u914d\u7f6e\u6307\u6807\u548c\u6807\u7b7e",id:"\u914d\u7f6e\u6307\u6807\u548c\u6807\u7b7e",level:2},{value:"\u542f\u7528\u7279\u5b9a\u6307\u6807\u548c\u6807\u7b7e",id:"\u542f\u7528\u7279\u5b9a\u6307\u6807\u548c\u6807\u7b7e",level:3},{value:"\u6309\u6307\u6807\u8fc7\u6ee4\u6807\u7b7e",id:"\u6309\u6307\u6807\u8fc7\u6ee4\u6807\u7b7e",level:3},{value:"\u9ad8\u7ea7\u914d\u7f6e",id:"\u9ad8\u7ea7\u914d\u7f6e",level:3},{value:"\u76d1\u63a7\u7cfb\u7edf\u5065\u5eb7",id:"\u76d1\u63a7\u7cfb\u7edf\u5065\u5eb7",level:2},{value:"DB \u4e8b\u52a1\u961f\u5217\u5065\u5eb7\u6307\u6807",id:"db-\u4e8b\u52a1\u961f\u5217\u5065\u5eb7\u6307\u6807",level:4},{value:"\ud83d\udd25 LiteLLM \u7ef4\u62a4\u7684 Grafana \u4eea\u8868\u677f",id:"-litellm-\u7ef4\u62a4\u7684-grafana-\u4eea\u8868\u677f",level:2},{value:"\u5df2\u5f03\u7528\u7684\u6307\u6807",id:"\u5df2\u5f03\u7528\u7684\u6307\u6807",level:2},{value:"\u5728 <code>/metrics</code> \u7aef\u70b9\u4e0a\u6dfb\u52a0\u8eab\u4efd\u9a8c\u8bc1",id:"\u5728-metrics-\u7aef\u70b9\u4e0a\u6dfb\u52a0\u8eab\u4efd\u9a8c\u8bc1",level:2},{value:"\u5e38\u89c1\u95ee\u9898",id:"\u5e38\u89c1\u95ee\u9898",level:2},{value:"<code>_created</code> vs. <code>_total</code> \u6307\u6807\u662f\u4ec0\u4e48\uff1f",id:"_created-vs-_total-\u6307\u6807\u662f\u4ec0\u4e48",level:3}];function _(e){const l={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(l.header,{children:(0,i.jsx)(l.h1,{id:"-prometheus-\u6307\u6807",children:"\ud83d\udcc8 Prometheus \u6307\u6807"})}),"\n",(0,i.jsxs)(l.p,{children:["LiteLLM \u4e3a Prometheus \u63d0\u4f9b\u4e86\u4e00\u4e2a ",(0,i.jsx)(l.code,{children:"/metrics"})," \u7aef\u70b9\u4ee5\u8fdb\u884c\u8f6e\u8be2\u3002"]}),"\n",(0,i.jsx)(l.h2,{id:"\u5feb\u901f\u5165\u95e8",children:"\u5feb\u901f\u5165\u95e8"}),"\n",(0,i.jsxs)(l.p,{children:["\u5982\u679c\u4f60\u4f7f\u7528\u7684\u662f LiteLLM CLI \u5e76\u4e14\u901a\u8fc7 ",(0,i.jsx)(l.code,{children:"litellm --config proxy_config.yaml"})," \u542f\u52a8\uff0c\u90a3\u4e48\u4f60\u9700\u8981\u5b89\u88c5 ",(0,i.jsx)(l.code,{children:"prometheus_client==0.20.0"}),"\u3002",(0,i.jsx)(l.strong,{children:"\u8fd9\u5df2\u7ecf\u5728 litellm Docker \u955c\u50cf\u4e2d\u9884\u88c5\u4e86"})]}),"\n",(0,i.jsxs)(l.p,{children:["\u5728\u4f60\u7684\u4ee3\u7406\u914d\u7f6e\u6587\u4ef6 ",(0,i.jsx)(l.code,{children:"proxy_config.yaml"})," \u4e2d\u6dfb\u52a0\u4ee5\u4e0b\u5185\u5bb9\uff1a"]}),"\n",(0,i.jsx)(l.pre,{children:(0,i.jsx)(l.code,{className:"language-yaml",children:"model_list:\n  - model_name: gpt-4o\n    litellm_params:\n      model: gpt-4o\nlitellm_settings:\n  callbacks:\n    - prometheus\n\n\n\u542f\u52a8\u4ee3\u7406\uff1a\n```shell\nlitellm --config config.yaml --debug\n"})}),"\n",(0,i.jsx)(l.p,{children:"\u6d4b\u8bd5\u8bf7\u6c42\uff1a"}),"\n",(0,i.jsx)(l.pre,{children:(0,i.jsx)(l.code,{className:"language-shell",children:'curl --location \'http://0.0.0.0:4000/chat/completions\' \\\n    --header \'Content-Type: application/json\' \\\n    --data \'{\n    "model": "gpt-4o",\n    "messages": [\n        {\n        "role": "user",\n        "content": "what llm are you"\n        }\n    ]\n}\'\n'})}),"\n",(0,i.jsxs)(l.p,{children:["\u67e5\u770b\u6307\u6807\uff1a\n\u8bbf\u95ee ",(0,i.jsx)(l.code,{children:"http://localhost:4000/metrics"})]}),"\n",(0,i.jsx)(l.pre,{children:(0,i.jsx)(l.code,{className:"language-shell",children:"http://localhost:4000/metrics\n\n# <proxy_base_url>/metrics\n"})}),"\n",(0,i.jsx)(l.h3,{id:"\u591a\u4e2a-worker",children:"\u591a\u4e2a Worker"}),"\n",(0,i.jsxs)(l.p,{children:["\u5f53\u4f60\u4f7f\u7528 LiteLLM \u5e76\u4e14\u6709\u591a\u4e2a\u5de5\u4f5c\u5668\u65f6\uff0c\u4f60\u9700\u8981\u8bbe\u7f6e\u73af\u5883\u53d8\u91cf ",(0,i.jsx)(l.code,{children:"PROMETHEUS_MULTIPROC_DIR"})," \u4ee5\u5728\u591a\u4e2a\u5de5\u4f5c\u8fdb\u7a0b\u4e4b\u95f4\u805a\u5408\u6307\u6807\u3002"]}),"\n",(0,i.jsx)(l.pre,{children:(0,i.jsx)(l.code,{className:"language-shell",children:'export PROMETHEUS_MULTIPROC_DIR="/prometheus_multiproc"\n'})}),"\n",(0,i.jsx)(l.p,{children:"\u8fd9\u4e2a\u76ee\u5f55\u88ab Prometheus \u5ba2\u6237\u7aef\u5e93\u7528\u6765\u5b58\u50a8\u53ef\u4ee5\u5171\u4eab\u7ed9\u591a\u4e2a\u5de5\u4f5c\u8fdb\u7a0b\u7684\u6307\u6807\u6587\u4ef6\u3002\u786e\u4fdd\u8be5\u76ee\u5f55\u5b58\u5728\u5e76\u4e14\u7531 LiteLLM \u8fdb\u7a0b\u53ef\u5199\u3002"}),"\n",(0,i.jsx)(l.h2,{id:"\u865a\u62df\u5bc6\u94a5\u56e2\u961f\u5185\u90e8\u7528\u6237",children:"\u865a\u62df\u5bc6\u94a5\u3001\u56e2\u961f\u3001\u5185\u90e8\u7528\u6237"}),"\n",(0,i.jsxs)(l.p,{children:["\u4f7f\u7528\u6b64\u529f\u80fd\u6765\u8ddf\u8e2a ",(0,i.jsx)(l.a,{href:"virtual_keys",children:"\u7528\u6237\u3001\u5bc6\u94a5\u3001\u56e2\u961f\u7b49"})]}),"\n",(0,i.jsxs)(l.table,{children:[(0,i.jsx)(l.thead,{children:(0,i.jsxs)(l.tr,{children:[(0,i.jsx)(l.th,{children:"\u6307\u6807\u540d\u79f0"}),(0,i.jsx)(l.th,{children:"\u63cf\u8ff0"})]})}),(0,i.jsxs)(l.tbody,{children:[(0,i.jsxs)(l.tr,{children:[(0,i.jsx)(l.td,{children:(0,i.jsx)(l.code,{children:"litellm_spend_metric"})}),(0,i.jsxs)(l.td,{children:["\u603b\u82b1\u8d39\uff0c\u6309 ",(0,i.jsx)(l.code,{children:'"end_user", "hashed_api_key", "api_key_alias", "model", "team", "team_alias", "user"'})," \u5206\u7c7b"]})]}),(0,i.jsxs)(l.tr,{children:[(0,i.jsx)(l.td,{children:(0,i.jsx)(l.code,{children:"litellm_total_tokens_metric"})}),(0,i.jsxs)(l.td,{children:["\u6309 ",(0,i.jsx)(l.code,{children:'"end_user", "hashed_api_key", "api_key_alias", "requested_model", "team", "team_alias", "user", "model"'})," \u8ba1\u7b97\u7684\u8f93\u5165 + \u8f93\u51fa token \u6570\u91cf"]})]}),(0,i.jsxs)(l.tr,{children:[(0,i.jsx)(l.td,{children:(0,i.jsx)(l.code,{children:"litellm_input_tokens_metric"})}),(0,i.jsxs)(l.td,{children:["\u6309 ",(0,i.jsx)(l.code,{children:'"end_user", "hashed_api_key", "api_key_alias", "requested_model", "team", "team_alias", "user", "model"'})," \u8ba1\u7b97\u7684\u8f93\u5165 token \u6570\u91cf"]})]}),(0,i.jsxs)(l.tr,{children:[(0,i.jsx)(l.td,{children:(0,i.jsx)(l.code,{children:"litellm_output_tokens_metric"})}),(0,i.jsxs)(l.td,{children:["\u6309 ",(0,i.jsx)(l.code,{children:'"end_user", "hashed_api_key", "api_key_alias", "requested_model", "team", "team_alias", "user", "model"'})," \u8ba1\u7b97\u7684\u8f93\u51fa token \u6570\u91cf"]})]})]})]}),"\n",(0,i.jsx)(l.h3,{id:"\u56e2\u961f---\u9884\u7b97",children:"\u56e2\u961f - \u9884\u7b97"}),"\n",(0,i.jsxs)(l.table,{children:[(0,i.jsx)(l.thead,{children:(0,i.jsxs)(l.tr,{children:[(0,i.jsx)(l.th,{children:"\u6307\u6807\u540d\u79f0"}),(0,i.jsx)(l.th,{children:"\u63cf\u8ff0"})]})}),(0,i.jsxs)(l.tbody,{children:[(0,i.jsxs)(l.tr,{children:[(0,i.jsx)(l.td,{children:(0,i.jsx)(l.code,{children:"litellm_team_max_budget_metric"})}),(0,i.jsxs)(l.td,{children:["\u56e2\u961f\u6807\u7b7e ",(0,i.jsx)(l.code,{children:'"team", "team_alias"'})," \u7684\u6700\u5927\u9884\u7b97"]})]}),(0,i.jsxs)(l.tr,{children:[(0,i.jsx)(l.td,{children:(0,i.jsx)(l.code,{children:"litellm_remaining_team_budget_metric"})}),(0,i.jsxs)(l.td,{children:["\u56e2\u961f (\u5728 LiteLLM \u521b\u5efa\u7684) \u6807\u7b7e ",(0,i.jsx)(l.code,{children:'"team", "team_alias"'})," \u5269\u4f59\u7684\u9884\u7b97"]})]}),(0,i.jsxs)(l.tr,{children:[(0,i.jsx)(l.td,{children:(0,i.jsx)(l.code,{children:"litellm_team_budget_remaining_hours_metric"})}),(0,i.jsxs)(l.td,{children:["\u5728\u56e2\u961f\u9884\u7b97\u91cd\u7f6e\u524d\u5269\u4f59\u7684\u65f6\u95f4\u6807\u7b7e ",(0,i.jsx)(l.code,{children:'"team", "team_alias"'})]})]})]})]}),"\n",(0,i.jsx)(l.h3,{id:"\u865a\u62df\u5bc6\u94a5---\u9884\u7b97",children:"\u865a\u62df\u5bc6\u94a5 - \u9884\u7b97"}),"\n",(0,i.jsxs)(l.table,{children:[(0,i.jsx)(l.thead,{children:(0,i.jsxs)(l.tr,{children:[(0,i.jsx)(l.th,{children:"\u6307\u6807\u540d\u79f0"}),(0,i.jsx)(l.th,{children:"\u63cf\u8ff0"})]})}),(0,i.jsxs)(l.tbody,{children:[(0,i.jsxs)(l.tr,{children:[(0,i.jsx)(l.td,{children:(0,i.jsx)(l.code,{children:"litellm_api_key_max_budget_metric"})}),(0,i.jsxs)(l.td,{children:["API \u5bc6\u94a5\u6807\u7b7e ",(0,i.jsx)(l.code,{children:'"hashed_api_key", "api_key_alias"'})," \u7684\u6700\u5927\u9884\u7b97"]})]}),(0,i.jsxs)(l.tr,{children:[(0,i.jsx)(l.td,{children:(0,i.jsx)(l.code,{children:"litellm_remaining_api_key_budget_metric"})}),(0,i.jsxs)(l.td,{children:["API \u5bc6\u94a5 (\u5728 LiteLLM \u521b\u5efa\u7684) \u6807\u7b7e ",(0,i.jsx)(l.code,{children:'"hashed_api_key", "api_key_alias"'})," \u5269\u4f59\u7684\u9884\u7b97"]})]}),(0,i.jsxs)(l.tr,{children:[(0,i.jsx)(l.td,{children:(0,i.jsx)(l.code,{children:"litellm_api_key_budget_remaining_hours_metric"})}),(0,i.jsxs)(l.td,{children:["\u5728 API \u5bc6\u94a5\u9884\u7b97\u91cd\u7f6e\u524d\u5269\u4f59\u7684\u65f6\u95f4\u6807\u7b7e ",(0,i.jsx)(l.code,{children:'"hashed_api_key", "api_key_alias"'})]})]})]})]}),"\n",(0,i.jsx)(l.h3,{id:"\u865a\u62df\u5bc6\u94a5---\u901f\u7387\u9650\u5236",children:"\u865a\u62df\u5bc6\u94a5 - \u901f\u7387\u9650\u5236"}),"\n",(0,i.jsxs)(l.table,{children:[(0,i.jsx)(l.thead,{children:(0,i.jsxs)(l.tr,{children:[(0,i.jsx)(l.th,{children:"\u6307\u6807\u540d\u79f0"}),(0,i.jsx)(l.th,{children:"\u63cf\u8ff0"})]})}),(0,i.jsxs)(l.tbody,{children:[(0,i.jsxs)(l.tr,{children:[(0,i.jsx)(l.td,{children:(0,i.jsx)(l.code,{children:"litellm_remaining_api_key_requests_for_model"})}),(0,i.jsxs)(l.td,{children:["LiteLLM \u865a\u62df API \u5bc6\u94a5\u5269\u4f59\u7684\u8bf7\u6c42\uff0c\u4ec5\u5f53\u4e3a\u8be5\u865a\u62df\u5bc6\u94a5\u8bbe\u7f6e\u4e86\u7279\u5b9a\u4e8e\u6a21\u578b\u7684\u901f\u7387\u9650\u5236 (rpm) \u65f6\u3002\u6807\u7b7e: ",(0,i.jsx)(l.code,{children:'"hashed_api_key", "api_key_alias", "model"'})]})]}),(0,i.jsxs)(l.tr,{children:[(0,i.jsx)(l.td,{children:(0,i.jsx)(l.code,{children:"litellm_remaining_api_key_tokens_for_model"})}),(0,i.jsxs)(l.td,{children:["LiteLLM \u865a\u62df API \u5bc6\u94a5\u5269\u4f59\u7684\u4ee4\u724c\uff0c\u4ec5\u5f53\u4e3a\u8be5\u865a\u62df\u5bc6\u94a5\u8bbe\u7f6e\u4e86\u7279\u5b9a\u4e8e\u6a21\u578b\u7684\u4ee4\u724c\u9650\u5236 (tpm) \u65f6\u3002\u6807\u7b7e: ",(0,i.jsx)(l.code,{children:'"hashed_api_key", "api_key_alias", "model"'})]})]})]})]}),"\n",(0,i.jsx)(l.h3,{id:"\u521d\u59cb\u5316\u9884\u7b97\u6307\u6807",children:"\u521d\u59cb\u5316\u9884\u7b97\u6307\u6807"}),"\n",(0,i.jsxs)(l.p,{children:["\u5982\u679c\u4f60\u60f3\u8ba9 litellm \u5728\u542f\u52a8\u65f6\u53d1\u51fa\u6240\u6709\u5bc6\u94a5\u3001\u56e2\u961f\u7684\u9884\u7b97\u6307\u6807\uff08\u65e0\u8bba\u662f\u5426\u6536\u5230\u8bf7\u6c42\uff09\uff0c\u53ef\u4ee5\u5728 ",(0,i.jsx)(l.code,{children:"config.yaml"})," \u4e2d\u8bbe\u7f6e ",(0,i.jsx)(l.code,{children:"prometheus_initialize_budget_metrics"})," \u4e3a ",(0,i.jsx)(l.code,{children:"true"})]}),"\n",(0,i.jsx)(l.p,{children:(0,i.jsx)(l.strong,{children:"\u5de5\u4f5c\u539f\u7406\uff1a"})}),"\n",(0,i.jsxs)(l.ul,{children:["\n",(0,i.jsxs)(l.li,{children:["\u5982\u679c\u8bbe\u7f6e\u4e86 ",(0,i.jsx)(l.code,{children:"prometheus_initialize_budget_metrics: true"}),"\n",(0,i.jsxs)(l.ul,{children:["\n",(0,i.jsx)(l.li,{children:"\u6bcf\u9694\u4e94\u5206\u949f\uff0clitellm \u8fd0\u884c\u4e00\u4e2a cron \u4f5c\u4e1a\u6765\u8bfb\u53d6\u6570\u636e\u5e93\u4e2d\u7684\u6240\u6709\u5bc6\u94a5\u3001\u56e2\u961f"}),"\n",(0,i.jsx)(l.li,{children:"\u7136\u540e\u4e3a\u6bcf\u4e2a\u5bc6\u94a5\u3001\u56e2\u961f\u53d1\u51fa\u9884\u7b97\u6307\u6807"}),"\n",(0,i.jsxs)(l.li,{children:["\u8fd9\u7528\u4e8e\u586b\u5145 ",(0,i.jsx)(l.code,{children:"/metrics"})," \u7aef\u70b9\u4e0a\u7684\u9884\u7b97\u6307\u6807"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(l.pre,{children:(0,i.jsx)(l.code,{className:"language-yaml",children:'litellm_settings:\n  callbacks: ["prometheus"]\n  prometheus_initialize_budget_metrics: true\n'})}),"\n",(0,i.jsx)(l.h2,{id:"\u4ee3\u7406\u7ea7\u522b\u8ddf\u8e2a\u6307\u6807",children:"\u4ee3\u7406\u7ea7\u522b\u8ddf\u8e2a\u6307\u6807"}),"\n",(0,i.jsx)(l.p,{children:"\u4f7f\u7528\u6b64\u529f\u80fd\u6765\u8ddf\u8e2a LiteLLM \u4ee3\u7406\u7684\u6574\u4f53\u4f7f\u7528\u60c5\u51b5\u3002"}),"\n",(0,i.jsxs)(l.ul,{children:["\n",(0,i.jsx)(l.li,{children:"\u8ddf\u8e2a\u4ee3\u7406\u5230\u5ba2\u6237\u7aef\u7684\u5b9e\u9645\u6d41\u91cf\u7387"}),"\n",(0,i.jsx)(l.li,{children:"\u5ba2\u6237\u7aef\u8bf7\u6c42\u548c\u5931\u8d25\u7684\u8bf7\u6c42\u6570\u91cf"}),"\n"]}),"\n",(0,i.jsxs)(l.table,{children:[(0,i.jsx)(l.thead,{children:(0,i.jsxs)(l.tr,{children:[(0,i.jsx)(l.th,{children:"\u6307\u6807\u540d\u79f0"}),(0,i.jsx)(l.th,{children:"\u63cf\u8ff0"})]})}),(0,i.jsxs)(l.tbody,{children:[(0,i.jsxs)(l.tr,{children:[(0,i.jsx)(l.td,{children:(0,i.jsx)(l.code,{children:"litellm_proxy_failed_requests_metric"})}),(0,i.jsxs)(l.td,{children:["\u4ece\u4ee3\u7406\u8fd4\u56de\u7684\u603b\u5931\u8d25\u54cd\u5e94\u6570 - \u5ba2\u6237\u7aef\u672a\u4ece litellm \u4ee3\u7406\u63a5\u6536\u5230\u6210\u529f\u54cd\u5e94\u3002\u6807\u7b7e: ",(0,i.jsx)(l.code,{children:'"end_user", "hashed_api_key", "api_key_alias", "requested_model", "team", "team_alias", "user", "exception_status", "exception_class", "route"'})]})]}),(0,i.jsxs)(l.tr,{children:[(0,i.jsx)(l.td,{children:(0,i.jsx)(l.code,{children:"litellm_proxy_total_requests_metric"})}),(0,i.jsxs)(l.td,{children:["\u53d1\u9001\u5230\u4ee3\u7406\u670d\u52a1\u5668\u7684\u603b\u8bf7\u6c42\u6570 - \u8ddf\u8e2a\u5ba2\u6237\u7aef\u8bf7\u6c42\u7684\u6570\u91cf\u3002\u6807\u7b7e: ",(0,i.jsx)(l.code,{children:'"end_user", "hashed_api_key", "api_key_alias", "requested_model", "team", "team_alias", "user", "status_code", "user_email", "route"'})]})]})]})]}),"\n",(0,i.jsx)(l.h3,{id:"\u56de\u8c03\u65e5\u5fd7\u8bb0\u5f55\u6307\u6807",children:"\u56de\u8c03\u65e5\u5fd7\u8bb0\u5f55\u6307\u6807"}),"\n",(0,i.jsxs)(l.p,{children:["\u76d1\u63a7\u5411\u4e0b\u6e38\u56de\u8c03\uff08\u5982 ",(0,i.jsx)(l.code,{children:"s3_v3"})," \u51b7\u5b58\u50a8\uff09\u53d1\u9001\u65e5\u5fd7\u65f6\u7684\u5931\u8d25\u60c5\u51b5\u3002"]}),"\n",(0,i.jsxs)(l.table,{children:[(0,i.jsx)(l.thead,{children:(0,i.jsxs)(l.tr,{children:[(0,i.jsx)(l.th,{children:"\u6307\u6807\u540d\u79f0"}),(0,i.jsx)(l.th,{children:"\u63cf\u8ff0"})]})}),(0,i.jsx)(l.tbody,{children:(0,i.jsxs)(l.tr,{children:[(0,i.jsx)(l.td,{children:(0,i.jsx)(l.code,{children:"litellm_callback_logging_failures_metric"})}),(0,i.jsxs)(l.td,{children:["\u53d1\u9001\u5230\u914d\u7f6e\u7684\u56de\u8c03\u7684\u65e5\u5fd7\u603b\u6570\u3002\u6807\u7b7e: ",(0,i.jsx)(l.code,{children:'"callback_name"'}),"\u3002\u4f7f\u7528\u6b64\u6307\u6807\u6765\u63d0\u9192\u5728\u5411 ",(0,i.jsx)(l.code,{children:"s3_v3"})," \u5199\u5165\u65f6\u51fa\u73b0\u91cd\u590d\u5931\u8d25\u7684\u95ee\u9898\u3002"]})]})})]}),"\n",(0,i.jsx)(l.h2,{id:"llm-\u63d0\u4f9b\u5546\u6307\u6807",children:"LLM \u63d0\u4f9b\u5546\u6307\u6807"}),"\n",(0,i.jsx)(l.p,{children:"\u7528\u4e8e\u76d1\u63a7 LLM API \u9519\u8bef\u548c\u8ddf\u8e2a\u5269\u4f59\u901f\u7387\u9650\u5236\u548c\u4ee4\u724c\u9650\u5236"}),"\n",(0,i.jsx)(l.h3,{id:"\u8ddf\u8e2a\u7684\u6807\u7b7e",children:"\u8ddf\u8e2a\u7684\u6807\u7b7e"}),"\n",(0,i.jsxs)(l.table,{children:[(0,i.jsx)(l.thead,{children:(0,i.jsxs)(l.tr,{children:[(0,i.jsx)(l.th,{children:"\u6807\u7b7e"}),(0,i.jsx)(l.th,{children:"\u63cf\u8ff0"})]})}),(0,i.jsxs)(l.tbody,{children:[(0,i.jsxs)(l.tr,{children:[(0,i.jsx)(l.td,{children:"litellm_model_name"}),(0,i.jsx)(l.td,{children:"LiteLLM \u4f7f\u7528\u7684 LLM \u6a21\u578b\u540d\u79f0"})]}),(0,i.jsxs)(l.tr,{children:[(0,i.jsx)(l.td,{children:"requested_model"}),(0,i.jsx)(l.td,{children:"\u8bf7\u6c42\u4e2d\u53d1\u9001\u7684\u6a21\u578b"})]}),(0,i.jsxs)(l.tr,{children:[(0,i.jsx)(l.td,{children:"model_id"}),(0,i.jsx)(l.td,{children:"\u90e8\u7f72\u7684\u6a21\u578b ID\u3002\u7531 LiteLLM \u81ea\u52a8\u751f\u6210\uff0c\u6bcf\u4e2a\u90e8\u7f72\u90fd\u6709\u4e00\u4e2a\u552f\u4e00\u7684 model_id"})]}),(0,i.jsxs)(l.tr,{children:[(0,i.jsx)(l.td,{children:"api_base"}),(0,i.jsx)(l.td,{children:"\u90e8\u7f72\u7684 API \u57fa\u7840 URL"})]}),(0,i.jsxs)(l.tr,{children:[(0,i.jsx)(l.td,{children:"api_provider"}),(0,i.jsx)(l.td,{children:"\u7528\u4e8e\u63d0\u4f9b\u8005\u7684 LLM API \u63d0\u4f9b\u5546\uff0c\u4f8b\u5982 (azure, openai, vertex_ai)"})]}),(0,i.jsxs)(l.tr,{children:[(0,i.jsx)(l.td,{children:"hashed_api_key"}),(0,i.jsx)(l.td,{children:"\u8bf7\u6c42\u4e2d\u7684\u54c8\u5e0c\u5bc6\u94a5"})]}),(0,i.jsxs)(l.tr,{children:[(0,i.jsx)(l.td,{children:"api_key_alias"}),(0,i.jsx)(l.td,{children:"\u4f7f\u7528\u7684\u5bc6\u94a5\u522b\u540d"})]}),(0,i.jsxs)(l.tr,{children:[(0,i.jsx)(l.td,{children:"team"}),(0,i.jsx)(l.td,{children:"\u8bf7\u6c42\u4e2d\u7684\u56e2\u961f"})]}),(0,i.jsxs)(l.tr,{children:[(0,i.jsx)(l.td,{children:"team_alias"}),(0,i.jsx)(l.td,{children:"\u4f7f\u7528\u7684\u56e2\u961f\u522b\u540d"})]}),(0,i.jsxs)(l.tr,{children:[(0,i.jsx)(l.td,{children:"exception_status"}),(0,i.jsx)(l.td,{children:"\u5982\u679c\u6709\u5f02\u5e38\uff0c\u5219\u4e3a\u5f02\u5e38\u72b6\u6001"})]}),(0,i.jsxs)(l.tr,{children:[(0,i.jsx)(l.td,{children:"exception_class"}),(0,i.jsx)(l.td,{children:"\u5982\u679c\u6709\u5f02\u5e38\uff0c\u5219\u4e3a\u5f02\u5e38\u7c7b"})]})]})]}),"\n",(0,i.jsx)(l.h3,{id:"\u6210\u529f\u4e0e\u5931\u8d25",children:"\u6210\u529f\u4e0e\u5931\u8d25"}),"\n",(0,i.jsxs)(l.table,{children:[(0,i.jsx)(l.thead,{children:(0,i.jsxs)(l.tr,{children:[(0,i.jsx)(l.th,{children:"\u6307\u6807\u540d\u79f0"}),(0,i.jsx)(l.th,{children:"\u63cf\u8ff0"})]})}),(0,i.jsxs)(l.tbody,{children:[(0,i.jsxs)(l.tr,{children:[(0,i.jsx)(l.td,{children:(0,i.jsx)(l.code,{children:"litellm_deployment_success_responses"})}),(0,i.jsxs)(l.td,{children:["\u90e8\u7f72\u7684\u603b\u6210\u529f LLM API \u8c03\u7528\u6b21\u6570\u3002\u6807\u7b7e: ",(0,i.jsx)(l.code,{children:'"requested_model", "litellm_model_name", "model_id", "api_base", "api_provider", "hashed_api_key", "api_key_alias", "team", "team_alias"'})]})]}),(0,i.jsxs)(l.tr,{children:[(0,i.jsx)(l.td,{children:(0,i.jsx)(l.code,{children:"litellm_deployment_failure_responses"})}),(0,i.jsxs)(l.td,{children:["\u7279\u5b9a LLM \u90e8\u7f72\u7684\u603b\u5931\u8d25 LLM API \u8c03\u7528\u6b21\u6570\u3002\u6807\u7b7e: ",(0,i.jsx)(l.code,{children:'"requested_model", "litellm_model_name", "model_id", "api_base", "api_provider", "hashed_api_key", "api_key_alias", "team", "team_alias", "exception_status", "exception_class"'})]})]}),(0,i.jsxs)(l.tr,{children:[(0,i.jsx)(l.td,{children:(0,i.jsx)(l.code,{children:"litellm_deployment_total_requests"})}),(0,i.jsxs)(l.td,{children:["\u90e8\u7f72\u7684\u603b LLM API \u8c03\u7528\u6b21\u6570 - \u6210\u529f + \u5931\u8d25\u3002\u6807\u7b7e: ",(0,i.jsx)(l.code,{children:'"requested_model", "litellm_model_name", "model_id", "api_base", "api_provider", "hashed_api_key", "api_key_alias", "team", "team_alias"'})]})]})]})]}),"\n",(0,i.jsx)(l.h3,{id:"\u5269\u4f59\u8bf7\u6c42\u548c\u4ee4\u724c",children:"\u5269\u4f59\u8bf7\u6c42\u548c\u4ee4\u724c"}),"\n",(0,i.jsxs)(l.table,{children:[(0,i.jsx)(l.thead,{children:(0,i.jsxs)(l.tr,{children:[(0,i.jsx)(l.th,{children:"\u6307\u6807\u540d\u79f0"}),(0,i.jsx)(l.th,{children:"\u63cf\u8ff0"})]})}),(0,i.jsxs)(l.tbody,{children:[(0,i.jsxs)(l.tr,{children:[(0,i.jsx)(l.td,{children:(0,i.jsx)(l.code,{children:"litellm_remaining_requests_metric"})}),(0,i.jsxs)(l.td,{children:["\u8ddf\u8e2a\u4ece LLM API \u90e8\u7f72\u8fd4\u56de\u7684 ",(0,i.jsx)(l.code,{children:"x-ratelimit-remaining-requests"}),"\u3002\u6807\u7b7e: ",(0,i.jsx)(l.code,{children:'"model_group", "api_provider", "api_base", "litellm_model_name", "hashed_api_key", "api_key_alias"'})]})]}),(0,i.jsxs)(l.tr,{children:[(0,i.jsx)(l.td,{children:(0,i.jsx)(l.code,{children:"litellm_remaining_tokens_metric"})}),(0,i.jsxs)(l.td,{children:["\u8ddf\u8e2a\u4ece LLM API \u90e8\u7f72\u8fd4\u56de\u7684 ",(0,i.jsx)(l.code,{children:"x-ratelimit-remaining-tokens"}),"\u3002\u6807\u7b7e: ",(0,i.jsx)(l.code,{children:'"model_group", "api_provider", "api_base", "litellm_model_name", "hashed_api_key", "api_key_alias"'})]})]})]})]}),"\n",(0,i.jsx)(l.h3,{id:"\u90e8\u7f72\u72b6\u6001",children:"\u90e8\u7f72\u72b6\u6001"}),"\n",(0,i.jsxs)(l.table,{children:[(0,i.jsx)(l.thead,{children:(0,i.jsxs)(l.tr,{children:[(0,i.jsx)(l.th,{children:"\u6307\u6807\u540d\u79f0"}),(0,i.jsx)(l.th,{children:"\u63cf\u8ff0"})]})}),(0,i.jsxs)(l.tbody,{children:[(0,i.jsxs)(l.tr,{children:[(0,i.jsx)(l.td,{children:(0,i.jsx)(l.code,{children:"litellm_deployment_state"})}),(0,i.jsxs)(l.td,{children:["\u90e8\u7f72\u7684\u72b6\u6001: 0 = \u5065\u5eb7\uff0c1 = \u90e8\u5206\u4e2d\u65ad\uff0c2 = \u5b8c\u5168\u4e2d\u65ad\u3002\u6807\u7b7e: ",(0,i.jsx)(l.code,{children:'"litellm_model_name", "model_id", "api_base", "api_provider"'})]})]}),(0,i.jsxs)(l.tr,{children:[(0,i.jsx)(l.td,{children:(0,i.jsx)(l.code,{children:"litellm_deployment_latency_per_output_token"})}),(0,i.jsxs)(l.td,{children:["\u6bcf\u4e2a\u8f93\u51fa\u4ee4\u724c\u7684\u90e8\u7f72\u5ef6\u8fdf\u3002\u6807\u7b7e: ",(0,i.jsx)(l.code,{children:'"litellm_model_name", "model_id", "api_base", "api_provider", "hashed_api_key", "api_key_alias", "team", "team_alias"'})]})]})]})]}),"\n",(0,i.jsx)(l.h4,{id:"\u964d\u7ea7-\u6545\u969c\u8f6c\u79fb-\u6307\u6807",children:"\u964d\u7ea7 (\u6545\u969c\u8f6c\u79fb) \u6307\u6807"}),"\n",(0,i.jsxs)(l.table,{children:[(0,i.jsx)(l.thead,{children:(0,i.jsxs)(l.tr,{children:[(0,i.jsx)(l.th,{children:"\u6307\u6807\u540d\u79f0"}),(0,i.jsx)(l.th,{children:"\u63cf\u8ff0"})]})}),(0,i.jsxs)(l.tbody,{children:[(0,i.jsxs)(l.tr,{children:[(0,i.jsx)(l.td,{children:(0,i.jsx)(l.code,{children:"litellm_deployment_cooled_down"})}),(0,i.jsxs)(l.td,{children:["LiteLLM \u8d1f\u8f7d\u5747\u8861\u903b\u8f91\u51b7\u5374\u90e8\u7f72\u7684\u6b21\u6570\u3002\u6807\u7b7e: ",(0,i.jsx)(l.code,{children:'"litellm_model_name", "model_id", "api_base", "api_provider"'})]})]}),(0,i.jsxs)(l.tr,{children:[(0,i.jsx)(l.td,{children:(0,i.jsx)(l.code,{children:"litellm_deployment_successful_fallbacks"})}),(0,i.jsxs)(l.td,{children:["\u4ece\u4e3b\u6a21\u578b -> \u5907\u7528\u6a21\u578b\u7684\u6210\u529f\u6545\u969c\u8f6c\u79fb\u8bf7\u6c42\u6b21\u6570\u3002\u6807\u7b7e: ",(0,i.jsx)(l.code,{children:'"requested_model", "fallback_model", "hashed_api_key", "api_key_alias", "team", "team_alias", "exception_status", "exception_class"'})]})]}),(0,i.jsxs)(l.tr,{children:[(0,i.jsx)(l.td,{children:(0,i.jsx)(l.code,{children:"litellm_deployment_failed_fallbacks"})}),(0,i.jsxs)(l.td,{children:["\u4ece\u4e3b\u6a21\u578b -> \u5907\u7528\u6a21\u578b\u7684\u5931\u8d25\u6545\u969c\u8f6c\u79fb\u8bf7\u6c42\u6b21\u6570\u3002\u6807\u7b7e: ",(0,i.jsx)(l.code,{children:'"requested_model", "fallback_model", "hashed_api_key", "api_key_alias", "team", "team_alias", "exception_status", "exception_class"'})]})]})]})]}),"\n",(0,i.jsx)(l.h2,{id:"\u8bf7\u6c42\u8ba1\u6570\u6307\u6807",children:"\u8bf7\u6c42\u8ba1\u6570\u6307\u6807"}),"\n",(0,i.jsxs)(l.table,{children:[(0,i.jsx)(l.thead,{children:(0,i.jsxs)(l.tr,{children:[(0,i.jsx)(l.th,{children:"\u6307\u6807\u540d\u79f0"}),(0,i.jsx)(l.th,{children:"\u63cf\u8ff0"})]})}),(0,i.jsx)(l.tbody,{children:(0,i.jsxs)(l.tr,{children:[(0,i.jsx)(l.td,{children:(0,i.jsx)(l.code,{children:"litellm_requests_metric"})}),(0,i.jsxs)(l.td,{children:["\u8ddf\u8e2a\u6bcf\u4e2a\u7aef\u70b9\u7684\u603b\u8bf7\u6c42\u6570\u3002\u6807\u7b7e: ",(0,i.jsx)(l.code,{children:'"end_user", "hashed_api_key", "api_key_alias", "model", "team", "team_alias", "user", "user_email"'})]})]})})]}),"\n",(0,i.jsx)(l.h2,{id:"\u8bf7\u6c42\u5ef6\u8fdf\u6307\u6807",children:"\u8bf7\u6c42\u5ef6\u8fdf\u6307\u6807"}),"\n",(0,i.jsxs)(l.table,{children:[(0,i.jsx)(l.thead,{children:(0,i.jsxs)(l.tr,{children:[(0,i.jsx)(l.th,{children:"\u6307\u6807\u540d\u79f0"}),(0,i.jsx)(l.th,{children:"\u63cf\u8ff0"})]})}),(0,i.jsxs)(l.tbody,{children:[(0,i.jsxs)(l.tr,{children:[(0,i.jsx)(l.td,{children:(0,i.jsx)(l.code,{children:"litellm_request_total_latency_metric"})}),(0,i.jsxs)(l.td,{children:["LiteLLM \u4ee3\u7406\u670d\u52a1\u5668\u8bf7\u6c42\u7684\u603b\u5ef6\u8fdf\uff08\u79d2\uff09 - \u8ddf\u8e2a\u6807\u7b7e ",(0,i.jsx)(l.code,{children:'"end_user", "hashed_api_key", "api_key_alias", "requested_model", "team", "team_alias", "user", "model"'})]})]}),(0,i.jsxs)(l.tr,{children:[(0,i.jsx)(l.td,{children:(0,i.jsx)(l.code,{children:"litellm_overhead_latency_metric"})}),(0,i.jsxs)(l.td,{children:["LiteLLM \u5904\u7406\u589e\u52a0\u7684\u5ef6\u8fdf\uff08\u79d2\uff09 - \u8ddf\u8e2a\u6807\u7b7e ",(0,i.jsx)(l.code,{children:'"model_group", "api_provider", "api_base", "litellm_model_name", "hashed_api_key", "api_key_alias"'})]})]}),(0,i.jsxs)(l.tr,{children:[(0,i.jsx)(l.td,{children:(0,i.jsx)(l.code,{children:"litellm_llm_api_latency_metric"})}),(0,i.jsxs)(l.td,{children:["LLM API \u8c03\u7528\u7684\u5ef6\u8fdf\uff08\u79d2\uff09 - \u8ddf\u8e2a\u6807\u7b7e ",(0,i.jsx)(l.code,{children:'"model", "hashed_api_key", "api_key_alias", "team", "team_alias", "requested_model", "end_user", "user"'})]})]}),(0,i.jsxs)(l.tr,{children:[(0,i.jsx)(l.td,{children:(0,i.jsx)(l.code,{children:"litellm_llm_api_time_to_first_token_metric"})}),(0,i.jsxs)(l.td,{children:["LLM API \u8c03\u7528\u7684\u7b2c\u4e00\u4e2a\u4ee4\u724c\u65f6\u95f4 - \u8ddf\u8e2a\u6807\u7b7e ",(0,i.jsx)(l.code,{children:"model"}),", ",(0,i.jsx)(l.code,{children:"hashed_api_key"}),", ",(0,i.jsx)(l.code,{children:"api_key_alias"}),", ",(0,i.jsx)(l.code,{children:"team"}),", ",(0,i.jsx)(l.code,{children:"team_alias"})," [\u6ce8\u610f\uff1a\u4ec5\u5728\u6d41\u5f0f\u8bf7\u6c42\u4e2d\u53d1\u51fa]"]})]})]})]}),"\n",(0,i.jsxs)(l.h2,{id:"\u5728-prometheus-\u4e2d\u8ddf\u8e2a-end_user",children:["\u5728 Prometheus \u4e2d\u8ddf\u8e2a ",(0,i.jsx)(l.code,{children:"end_user"})]}),"\n",(0,i.jsxs)(l.p,{children:["\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cLiteLLM \u4e0d\u4f1a\u5728 Prometheus \u4e2d\u8ddf\u8e2a ",(0,i.jsx)(l.code,{children:"end_user"}),"\u3002\u8fd9\u6709\u52a9\u4e8e\u51cf\u5c11 LiteLLM \u4ee3\u7406\u7684\u6307\u6807\u57fa\u6570\u3002"]}),"\n",(0,i.jsxs)(l.p,{children:["\u5982\u679c\u4f60\u60f3\u5728 Prometheus \u4e2d\u8ddf\u8e2a ",(0,i.jsx)(l.code,{children:"end_user"}),"\uff0c\u53ef\u4ee5\u8fd9\u6837\u505a\uff1a"]}),"\n",(0,i.jsx)(l.pre,{children:(0,i.jsx)(l.code,{className:"language-yaml",metastring:'showLineNumbers title="config.yaml"',children:'litellm_settings:\n  callbacks: ["prometheus"]\n  enable_end_user_cost_tracking_prometheus_only: true\n'})}),"\n",(0,i.jsx)(l.h2,{id:"beta-\u81ea\u5b9a\u4e49\u6307\u6807",children:"[BETA] \u81ea\u5b9a\u4e49\u6307\u6807"}),"\n",(0,i.jsx)(l.p,{children:"\u5728\u6240\u6709\u4e0a\u8ff0\u4e8b\u4ef6\u4e2d\u81ea\u5b9a\u4e49\u6307\u6807\u8bb0\u5f55\u5230 Prometheus \u4e2d\u3002"}),"\n",(0,i.jsx)(l.h3,{id:"\u81ea\u5b9a\u4e49\u5143\u6570\u636e\u6807\u7b7e",children:"\u81ea\u5b9a\u4e49\u5143\u6570\u636e\u6807\u7b7e"}),"\n",(0,i.jsxs)(l.ol,{children:["\n",(0,i.jsxs)(l.li,{children:["\u5728 ",(0,i.jsx)(l.code,{children:"config.yaml"})," \u4e2d\u5b9a\u4e49\u81ea\u5b9a\u4e49\u5143\u6570\u636e\u6807\u7b7e\uff1a"]}),"\n"]}),"\n",(0,i.jsx)(l.pre,{children:(0,i.jsx)(l.code,{className:"language-yaml",children:'model_list:\n  - model_name: openai/gpt-4o\n    litellm_params:\n      model: openai/gpt-4o\n      api_key: os.environ/OPENAI_API_KEY\n\nlitellm_settings:\n  callbacks: ["prometheus"]\n  custom_prometheus_metadata_labels: ["metadata.foo", "metadata.bar"]\n'})}),"\n",(0,i.jsxs)(l.ol,{start:"2",children:["\n",(0,i.jsx)(l.li,{children:"\u4f7f\u7528\u81ea\u5b9a\u4e49\u5143\u6570\u636e\u6807\u7b7e\u53d1\u8d77\u8bf7\u6c42\uff1a"}),"\n"]}),"\n",(0,i.jsxs)(d.A,{children:[(0,i.jsx)(t.A,{value:"Curl",label:"Curl \u8bf7\u6c42",children:(0,i.jsx)(l.pre,{children:(0,i.jsx)(l.code,{className:"language-bash",children:'curl -L -X POST \'http://0.0.0.0:4000/v1/chat/completions\' \\\n-H \'Content-Type: application/json\' \\\n-H \'Authorization: Bearer <LITELLM_API_KEY>\' \\\n-d \'{\n    "model": "openai/gpt-4o",\n    "messages": [\n      {\n        "role": "user",\n        "content": [\n          {\n            "type": "text",\n            "text": "What\'s in this image?"\n          }\n        ]\n      }\n    ],\n    "max_tokens": 300,\n    "metadata": {\n        "foo": "hello world"\n    }\n}\'\n'})})}),(0,i.jsx)(t.A,{value:"key",label:"\u5728\u5bc6\u94a5\u4e0a",children:(0,i.jsx)(l.pre,{children:(0,i.jsx)(l.code,{className:"language-bash",children:"curl -L -X POST 'http://0.0.0.0:4000/key/generate' \\\n-H 'Authorization: Bearer sk-1234' \\\n-H 'Content-Type: application/json' \\\n-d '{\n    \"metadata\": {\n        \"foo\": \"hello world\"\n    }\n}'\n"})})}),(0,i.jsx)(t.A,{value:"team",label:"\u5728\u56e2\u961f\u4e0a",children:(0,i.jsx)(l.pre,{children:(0,i.jsx)(l.code,{className:"language-bash",children:"curl -L -X POST 'http://0.0.0.0:4000/team/new' \\\n-H 'Authorization: Bearer sk-1234' \\\n-H 'Content-Type: application/json' \\\n-d '{\n    \"metadata\": {\n        \"foo\": \"hello world\"\n    }\n}'\n"})})})]}),"\n",(0,i.jsxs)(l.ol,{start:"3",children:["\n",(0,i.jsxs)(l.li,{children:["\u5728 ",(0,i.jsx)(l.code,{children:"/metrics"})," \u7aef\u70b9\u68c0\u67e5\u81ea\u5b9a\u4e49\u6307\u6807\uff1a"]}),"\n"]}),"\n",(0,i.jsx)(l.pre,{children:(0,i.jsx)(l.code,{children:'... "metadata_foo": "hello world" ...\n'})}),"\n",(0,i.jsx)(l.h3,{id:"\u81ea\u5b9a\u4e49\u6807\u7b7e",children:"\u81ea\u5b9a\u4e49\u6807\u7b7e"}),"\n",(0,i.jsx)(l.p,{children:"\u8ddf\u8e2a\u7279\u5b9a\u7684\u6807\u7b7e\u4f5c\u4e3a Prometheus \u6807\u7b7e\uff0c\u4ee5\u4fbf\u66f4\u597d\u5730\u8fc7\u6ee4\u548c\u76d1\u63a7\u3002"}),"\n",(0,i.jsxs)(l.ol,{children:["\n",(0,i.jsxs)(l.li,{children:["\u5728 ",(0,i.jsx)(l.code,{children:"config.yaml"})," \u4e2d\u5b9a\u4e49\u81ea\u5b9a\u4e49\u6807\u7b7e\uff1a"]}),"\n"]}),"\n",(0,i.jsx)(l.pre,{children:(0,i.jsx)(l.code,{className:"language-yaml",children:'model_list:\n  - model_name: openai/gpt-4o\n    litellm_params:\n      model: openai/gpt-4o\n      api_key: os.environ/OPENAI_API_KEY\n\nlitellm_settings:\n  callbacks: ["prometheus"]\n  custom_prometheus_metadata_labels: ["metadata.foo", "metadata.bar"]\n  custom_prometheus_tags: \n    - "prod"\n    - "staging"\n    - "batch-job"\n    - "User-Agent: RooCode/*"\n    - "User-Agent: claude-cli/*"\n'})}),"\n",(0,i.jsxs)(l.ol,{start:"2",children:["\n",(0,i.jsx)(l.li,{children:"\u53d1\u8d77\u5e26\u6709\u6807\u7b7e\u7684\u8bf7\u6c42\uff1a"}),"\n"]}),"\n",(0,i.jsx)(l.pre,{children:(0,i.jsx)(l.code,{className:"language-bash",children:'curl -L -X POST \'http://0.0.0.0:4000/v1/chat/completions\' \\\n-H \'Content-Type: application/json\' \\\n-H \'Authorization: Bearer <LITELLM_API_KEY>\' \\\n-d \'{\n    "model": "openai/gpt-4o",\n    "messages": [\n      {\n        "role": "user",\n        "content": [\n          {\n            "type": "text",\n            "text": "What\'s in this image?"\n          }\n        ]\n      }\n    ],\n    "max_tokens": 300,\n    "metadata": {\n        "tags": ["prod", "user-facing"]\n    }\n}\'\n'})}),"\n",(0,i.jsxs)(l.ol,{start:"3",children:["\n",(0,i.jsxs)(l.li,{children:["\u5728 ",(0,i.jsx)(l.code,{children:"/metrics"})," \u7aef\u70b9\u68c0\u67e5\u81ea\u5b9a\u4e49\u6807\u7b7e\u6307\u6807\uff1a"]}),"\n"]}),"\n",(0,i.jsx)(l.pre,{children:(0,i.jsx)(l.code,{children:'... "tag_prod": "true", "tag_staging": "false", "tag_batch_job": "false" ...\n'})}),"\n",(0,i.jsx)(l.p,{children:(0,i.jsx)(l.strong,{children:"\u5982\u4f55\u5de5\u4f5c\uff1a"})}),"\n",(0,i.jsxs)(l.ul,{children:["\n",(0,i.jsx)(l.li,{children:"\u6bcf\u4e2a\u914d\u7f6e\u7684\u6807\u7b7e\u5728 Prometheus \u4e2d\u90fd\u4f1a\u6210\u4e3a\u4e00\u4e2a\u5e03\u5c14\u6807\u7b7e"}),"\n",(0,i.jsxs)(l.li,{children:["\u5982\u679c\u6807\u7b7e\u5339\u914d\uff08\u7cbe\u786e\u6216\u901a\u914d\u7b26\uff09\uff0c\u8be5\u6807\u7b7e\u503c\u4e3a ",(0,i.jsx)(l.code,{children:'"true"'}),"\uff0c\u5426\u5219\u4e3a ",(0,i.jsx)(l.code,{children:'"false"'})]}),"\n",(0,i.jsx)(l.li,{children:"\u6807\u7b7e\u540d\u79f0\u4e3a\u4e86\u517c\u5bb9 Prometheus \u800c\u8fdb\u884c\u4e86\u6e05\u7406\uff08\u4f8b\u5982\uff0c\u201cbatch-job\u201d\u53d8\u4e3a\u201ctag_batch_job\u201d\uff09"}),"\n",(0,i.jsxs)(l.li,{children:[(0,i.jsxs)(l.strong,{children:["\u652f\u6301\u4f7f\u7528 ",(0,i.jsx)(l.code,{children:"*"})," \u7684\u901a\u914d\u7b26\u6a21\u5f0f"]})," (\u4f8b\u5982\uff0c\u201cUser-Agent: RooCode/*\u201d \u5339\u914d \u201cUser-Agent: RooCode/1.0.0\u201d)"]}),"\n"]}),"\n",(0,i.jsx)(l.p,{children:(0,i.jsx)(l.strong,{children:"\u793a\u4f8b\u4e0e\u901a\u914d\u7b26\uff1a"})}),"\n",(0,i.jsx)(l.pre,{children:(0,i.jsx)(l.code,{className:"language-yaml",children:'litellm_settings:\n  callbacks: ["prometheus"]\n  custom_prometheus_tags:\n    - "User-Agent: RooCode/*"\n    - "User-Agent: claude-cli/*"\n'})}),"\n",(0,i.jsx)(l.p,{children:(0,i.jsx)(l.strong,{children:"\u7528\u4f8b\uff1a"})}),"\n",(0,i.jsxs)(l.ul,{children:["\n",(0,i.jsxs)(l.li,{children:["\u73af\u5883\u8ddf\u8e2a (",(0,i.jsx)(l.code,{children:"prod"}),", ",(0,i.jsx)(l.code,{children:"staging"}),", ",(0,i.jsx)(l.code,{children:"dev"}),")"]}),"\n",(0,i.jsxs)(l.li,{children:["\u8bf7\u6c42\u7c7b\u578b\u5206\u7c7b (",(0,i.jsx)(l.code,{children:"batch-job"}),", ",(0,i.jsx)(l.code,{children:"user-facing"}),", ",(0,i.jsx)(l.code,{children:"background"}),")"]}),"\n",(0,i.jsxs)(l.li,{children:["\u7279\u5f81\u6807\u5fd7 (",(0,i.jsx)(l.code,{children:"new-feature"}),", ",(0,i.jsx)(l.code,{children:"beta-users"}),")"]}),"\n",(0,i.jsxs)(l.li,{children:["\u56e2\u961f\u6216\u670d\u52a1\u8bc6\u522b (",(0,i.jsx)(l.code,{children:"team-a"}),", ",(0,i.jsx)(l.code,{children:"service-xyz"}),")"]}),"\n",(0,i.jsxs)(l.li,{children:["\u7528\u6237\u4ee3\u7406\u8ddf\u8e2a - \u7528\u4e8e\u8ddf\u8e2a Roo Code, Claude Code, Gemini CLI \u7684\u4f7f\u7528\u60c5\u51b5 (",(0,i.jsx)(l.code,{children:"User-Agent: RooCode/*"}),", ",(0,i.jsx)(l.code,{children:"User-Agent: claude-cli/*"}),", ",(0,i.jsx)(l.code,{children:"User-Agent: gemini-cli/*"}),")"]}),"\n"]}),"\n",(0,i.jsx)(l.h2,{id:"\u914d\u7f6e\u6307\u6807\u548c\u6807\u7b7e",children:"\u914d\u7f6e\u6307\u6807\u548c\u6807\u7b7e"}),"\n",(0,i.jsx)(l.p,{children:"\u4f60\u53ef\u4ee5\u9009\u62e9\u6027\u5730\u542f\u7528\u7279\u5b9a\u7684\u6307\u6807\u5e76\u63a7\u5236\u54ea\u4e9b\u6807\u7b7e\u88ab\u5305\u542b\u4ee5\u4f18\u5316\u6027\u80fd\u5e76\u51cf\u5c11\u57fa\u6570\u3002"}),"\n",(0,i.jsx)(l.h3,{id:"\u542f\u7528\u7279\u5b9a\u6307\u6807\u548c\u6807\u7b7e",children:"\u542f\u7528\u7279\u5b9a\u6307\u6807\u548c\u6807\u7b7e"}),"\n",(0,i.jsxs)(l.p,{children:["\u901a\u8fc7\u5728 ",(0,i.jsx)(l.code,{children:"prometheus_metrics_config"})," \u4e2d\u6307\u5b9a\u5b83\u4eec\u6765\u914d\u7f6e\u8981\u53d1\u51fa\u7684\u6307\u6807\u3002\u6bcf\u4e2a\u914d\u7f6e\u7ec4\u9700\u8981\u4e00\u4e2a ",(0,i.jsx)(l.code,{children:"group"})," \u540d\u79f0\uff08\u7528\u4e8e\u7ec4\u7ec7\uff09\u4ee5\u53ca\u8981\u542f\u7528\u7684\u4e00\u7cfb\u5217 ",(0,i.jsx)(l.code,{children:"metrics"}),"\u3002\u4f60\u53ef\u4ee5\u53ef\u9009\u5730\u5305\u62ec\u4e00\u4e2a ",(0,i.jsx)(l.code,{children:"include_labels"})," \u5217\u8868\u4ee5\u8fc7\u6ee4\u8fd9\u4e9b\u6307\u6807\u7684\u6807\u7b7e\u3002"]}),"\n",(0,i.jsx)(l.pre,{children:(0,i.jsx)(l.code,{className:"language-yaml",children:'model_list:\n - model_name: gpt-4o\n    litellm_params:\n      model: gpt-4o\n\nlitellm_settings:\n  callbacks: ["prometheus"]\n  prometheus_metrics_config:\n    # \u9ad8\u57fa\u6570\u6307\u6807\uff0c\u5e26\u6709\u6700\u5c11\u6807\u7b7e\n    - group: "proxy_metrics"\n      metrics:\n        - "litellm_proxy_total_requests_metric"\n        - "litellm_proxy_failed_requests_metric"\n      include_labels:\n        - "hashed_api_key"\n        - "requested_model"\n        - "model_group"\n'})}),"\n",(0,i.jsx)(l.p,{children:"\u5728\u542f\u52a8 LiteLLM \u65f6\uff0c\u5982\u679c\u4f60\u7684\u6307\u6807\u914d\u7f6e\u6b63\u786e\uff0c\u5219\u4f60\u5e94\u8be5\u5728\u5bb9\u5668\u65e5\u5fd7\u4e2d\u770b\u5230\u4ee5\u4e0b\u5185\u5bb9"}),"\n",(0,i.jsx)(c.A,{img:s(72035),style:{width:"100%",display:"block",margin:"2rem auto"}}),"\n",(0,i.jsx)(l.h3,{id:"\u6309\u6307\u6807\u8fc7\u6ee4\u6807\u7b7e",children:"\u6309\u6307\u6807\u8fc7\u6ee4\u6807\u7b7e"}),"\n",(0,i.jsx)(l.p,{children:"\u63a7\u5236\u6bcf\u4e2a\u6307\u6807\u5305\u542b\u54ea\u4e9b\u6807\u7b7e\u4ee5\u51cf\u5c11\u57fa\u6570\uff1a"}),"\n",(0,i.jsx)(l.pre,{children:(0,i.jsx)(l.code,{className:"language-yaml",children:'litellm_settings:\n  callbacks: ["prometheus"]\n  prometheus_metrics_config:\n    - group: "token_consumption"\n      metrics:\n        - "litellm_input_tokens_metric"\n        - "litellm_output_tokens_metric"\n        - "litellm_total_tokens_metric"\n      include_labels:\n        - "model"\n        - "team"\n        - "hashed_api_key"\n    - group: "request_tracking"\n      metrics:\n        - "litellm_proxy_total_requests_metric"\n      include_labels:\n        - "status_code"\n        - "requested_model"\n'})}),"\n",(0,i.jsx)(l.h3,{id:"\u9ad8\u7ea7\u914d\u7f6e",children:"\u9ad8\u7ea7\u914d\u7f6e"}),"\n",(0,i.jsx)(l.p,{children:"\u4f60\u53ef\u4ee5\u521b\u5efa\u591a\u4e2a\u5177\u6709\u4e0d\u540c\u6807\u7b7e\u96c6\u7684\u914d\u7f6e\u7ec4\uff1a"}),"\n",(0,i.jsx)(l.pre,{children:(0,i.jsx)(l.code,{className:"language-yaml",children:'litellm_settings:\n  callbacks: ["prometheus"]\n  prometheus_metrics_config:\n    # \u9ad8\u57fa\u6570\u6307\u6807\uff0c\u5e26\u6709\u6700\u5c11\u6807\u7b7e\n    - group: "deployment_health"\n      metrics:\n        - "litellm_deployment_success_responses"\n        - "litellm_deployment_failure_responses"\n      include_labels:\n        - "api_provider"\n        - "requested_model"\n    \n    # \u9884\u7b97\u8ddf\u8e2a\u6307\u6807\uff0c\u5e26\u6709\u5b8c\u6574\u6807\u7b7e\u96c6\n    - group: "budget_tracking"\n      metrics:\n        - "litellm_remaining_team_budget_metric"\n      include_labels:\n        - "team"\n        - "team_alias"\n        - "hashed_api_key"\n        - "api_key_alias"\n        - "model"\n        - "end_user"\n    \n    # \u6027\u80fd\u6307\u6807\uff0c\u5e26\u6709\u6027\u80fd\u5173\u6ce8\u7684\u6807\u7b7e\n    - group: "performance"\n      metrics:\n        - "litellm_request_total_latency_metric"\n        - "litellm_llm_api_latency_metric"\n      include_labels:\n        - "model"\n        - "api_provider"\n        - "requested_model"\n'})}),"\n",(0,i.jsx)(l.p,{children:(0,i.jsx)(l.strong,{children:"\u914d\u7f6e\u7ed3\u6784\uff1a"})}),"\n",(0,i.jsxs)(l.ul,{children:["\n",(0,i.jsxs)(l.li,{children:[(0,i.jsx)(l.code,{children:"group"}),": \u7528\u4e8e\u7ec4\u7ec7\u76f8\u5173\u6307\u6807\u7684\u63cf\u8ff0\u6027\u540d\u79f0"]}),"\n",(0,i.jsxs)(l.li,{children:[(0,i.jsx)(l.code,{children:"metrics"}),": \u8981\u5305\u542b\u5728\u8be5\u7ec4\u4e2d\u7684\u6307\u6807\u5217\u8868"]}),"\n",(0,i.jsxs)(l.li,{children:[(0,i.jsx)(l.code,{children:"include_labels"}),": (\u53ef\u9009) \u4e3a\u8fd9\u4e9b\u6307\u6807\u5305\u62ec\u7684\u6807\u7b7e\u5217\u8868"]}),"\n"]}),"\n",(0,i.jsxs)(l.p,{children:[(0,i.jsx)(l.strong,{children:"\u9ed8\u8ba4\u884c\u4e3a"}),": \u5982\u679c\u6ca1\u6709\u6307\u5b9a ",(0,i.jsx)(l.code,{children:"prometheus_metrics_config"}),"\uff0c\u6240\u6709\u6307\u6807\u5c06\u4ee5\u5176\u9ed8\u8ba4\u6807\u7b7e\u542f\u7528\uff08\u5411\u540e\u517c\u5bb9\uff09\u3002"]}),"\n",(0,i.jsx)(l.h2,{id:"\u76d1\u63a7\u7cfb\u7edf\u5065\u5eb7",children:"\u76d1\u63a7\u7cfb\u7edf\u5065\u5eb7"}),"\n",(0,i.jsx)(l.p,{children:"\u8981\u76d1\u63a7\u4e0e LiteLLM \u76f8\u90bb\u7684\u670d\u52a1\uff08Redis / Postgres\uff09\u7684\u5065\u5eb7\u72b6\u51b5\uff0c\u8bf7\u6267\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a"}),"\n",(0,i.jsx)(l.pre,{children:(0,i.jsx)(l.code,{className:"language-yaml",children:'model_list:\n - model_name: gpt-4o\n    litellm_params:\n      model: gpt-4o\nlitellm_settings:\n  service_callback: ["prometheus_system"]\n'})}),"\n",(0,i.jsxs)(l.table,{children:[(0,i.jsx)(l.thead,{children:(0,i.jsxs)(l.tr,{children:[(0,i.jsx)(l.th,{children:"\u6307\u6807\u540d\u79f0"}),(0,i.jsx)(l.th,{children:"\u63cf\u8ff0"})]})}),(0,i.jsxs)(l.tbody,{children:[(0,i.jsxs)(l.tr,{children:[(0,i.jsx)(l.td,{children:(0,i.jsx)(l.code,{children:"litellm_redis_latency"})}),(0,i.jsx)(l.td,{children:"Redis \u8c03\u7528\u7684\u76f4\u65b9\u56fe\u5ef6\u8fdf"})]}),(0,i.jsxs)(l.tr,{children:[(0,i.jsx)(l.td,{children:(0,i.jsx)(l.code,{children:"litellm_redis_fails"})}),(0,i.jsx)(l.td,{children:"\u5931\u8d25\u7684 Redis \u8c03\u7528\u6b21\u6570"})]}),(0,i.jsxs)(l.tr,{children:[(0,i.jsx)(l.td,{children:(0,i.jsx)(l.code,{children:"litellm_self_latency"})}),(0,i.jsx)(l.td,{children:"\u6210\u529f\u7684 LiteLLM API \u8c03\u7528\u7684\u76f4\u65b9\u56fe\u5ef6\u8fdf"})]})]})]}),"\n",(0,i.jsx)(l.h4,{id:"db-\u4e8b\u52a1\u961f\u5217\u5065\u5eb7\u6307\u6807",children:"DB \u4e8b\u52a1\u961f\u5217\u5065\u5eb7\u6307\u6807"}),"\n",(0,i.jsx)(l.p,{children:"\u4f7f\u7528\u8fd9\u4e9b\u6307\u6807\u6765\u76d1\u63a7 DB \u4e8b\u52a1\u961f\u5217\u7684\u5065\u5eb7\u72b6\u51b5\u3002\u4f8b\u5982\uff0c\u76d1\u63a7\u5185\u5b58\u7f13\u51b2\u533a\u548c Redis \u7f13\u51b2\u533a\u7684\u5927\u5c0f\u3002"}),"\n",(0,i.jsxs)(l.table,{children:[(0,i.jsx)(l.thead,{children:(0,i.jsxs)(l.tr,{children:[(0,i.jsx)(l.th,{children:"\u6307\u6807\u540d\u79f0"}),(0,i.jsx)(l.th,{children:"\u63cf\u8ff0"}),(0,i.jsx)(l.th,{children:"\u5b58\u50a8\u7c7b\u578b"})]})}),(0,i.jsxs)(l.tbody,{children:[(0,i.jsxs)(l.tr,{children:[(0,i.jsx)(l.td,{children:(0,i.jsx)(l.code,{children:"litellm_pod_lock_manager_size"})}),(0,i.jsx)(l.td,{children:"\u8868\u793a\u54ea\u4e2a Pod \u62e5\u6709\u5199\u5165\u6570\u636e\u5e93\u66f4\u65b0\u7684\u9501\u3002"}),(0,i.jsx)(l.td,{children:"Redis"})]}),(0,i.jsxs)(l.tr,{children:[(0,i.jsx)(l.td,{children:(0,i.jsx)(l.code,{children:"litellm_in_memory_daily_spend_update_queue_size"})}),(0,i.jsx)(l.td,{children:"\u5185\u5b58\u4e2d\u6bcf\u65e5\u82b1\u8d39\u66f4\u65b0\u961f\u5217\u4e2d\u7684\u9879\u76ee\u6570\u91cf\u3002\u8fd9\u4e9b\u662f\u6bcf\u4e2a\u7528\u6237\u7684\u6c47\u603b\u82b1\u8d39\u65e5\u5fd7\u3002"}),(0,i.jsx)(l.td,{children:"In-Memory"})]}),(0,i.jsxs)(l.tr,{children:[(0,i.jsx)(l.td,{children:(0,i.jsx)(l.code,{children:"litellm_redis_daily_spend_update_queue_size"})}),(0,i.jsx)(l.td,{children:"Redis \u4e2d\u6bcf\u65e5\u82b1\u8d39\u66f4\u65b0\u961f\u5217\u4e2d\u7684\u9879\u76ee\u6570\u91cf\u3002  \u8fd9\u4e9b\u662f\u6bcf\u4e2a\u7528\u6237\u7684\u6c47\u603b\u82b1\u8d39\u65e5\u5fd7\u3002"}),(0,i.jsx)(l.td,{children:"Redis"})]}),(0,i.jsxs)(l.tr,{children:[(0,i.jsx)(l.td,{children:(0,i.jsx)(l.code,{children:"litellm_in_memory_spend_update_queue_size"})}),(0,i.jsx)(l.td,{children:"\u5185\u5b58\u4e2d\u952e\u3001\u7528\u6237\u3001\u56e2\u961f\u3001\u56e2\u961f\u6210\u5458\u7b49\u7684\u6c47\u603b\u82b1\u8d39\u503c"}),(0,i.jsx)(l.td,{children:"In-Memory"})]}),(0,i.jsxs)(l.tr,{children:[(0,i.jsx)(l.td,{children:(0,i.jsx)(l.code,{children:"litellm_redis_spend_update_queue_size"})}),(0,i.jsx)(l.td,{children:"Redis \u4e2d\u952e\u3001\u7528\u6237\u3001\u56e2\u961f\u7b49\u7684\u6c47\u603b\u82b1\u8d39\u503c"}),(0,i.jsx)(l.td,{children:"Redis"})]})]})]}),"\n",(0,i.jsx)(l.h2,{id:"-litellm-\u7ef4\u62a4\u7684-grafana-\u4eea\u8868\u677f",children:"\ud83d\udd25 LiteLLM \u7ef4\u62a4\u7684 Grafana \u4eea\u8868\u677f"}),"\n",(0,i.jsx)(l.p,{children:"\u94fe\u63a5\u5230\u7531 LiteLLM \u7ef4\u62a4\u7684 Grafana \u4eea\u8868\u677f"}),"\n",(0,i.jsx)(l.p,{children:(0,i.jsx)(l.a,{href:"https://github.com/BerriAI/litellm/tree/main/cookbook/litellm_proxy_server/grafana_dashboard",children:"https://github.com/BerriAI/litellm/tree/main/cookbook/litellm_proxy_server/grafana_dashboard"})}),"\n",(0,i.jsx)(l.p,{children:"\u4ee5\u4e0b\u662f\u4f7f\u7528 LiteLLM Grafana \u4eea\u8868\u677f\u53ef\u4ee5\u76d1\u63a7\u7684\u6307\u6807\u622a\u56fe"}),"\n",(0,i.jsx)(c.A,{img:s(34015)}),"\n",(0,i.jsx)(c.A,{img:s(24871)}),"\n",(0,i.jsx)(c.A,{img:s(37182)}),"\n",(0,i.jsx)(l.h2,{id:"\u5df2\u5f03\u7528\u7684\u6307\u6807",children:"\u5df2\u5f03\u7528\u7684\u6307\u6807"}),"\n",(0,i.jsxs)(l.table,{children:[(0,i.jsx)(l.thead,{children:(0,i.jsxs)(l.tr,{children:[(0,i.jsx)(l.th,{children:"\u6307\u6807\u540d\u79f0"}),(0,i.jsx)(l.th,{children:"\u63cf\u8ff0"})]})}),(0,i.jsx)(l.tbody,{children:(0,i.jsxs)(l.tr,{children:[(0,i.jsx)(l.td,{children:(0,i.jsx)(l.code,{children:"litellm_llm_api_failed_requests_metric"})}),(0,i.jsxs)(l.td,{children:[(0,i.jsx)(l.strong,{children:"\u5df2\u5f03\u7528"})," \u8bf7\u4f7f\u7528 ",(0,i.jsx)(l.code,{children:"litellm_proxy_failed_requests_metric"})]})]})})]}),"\n",(0,i.jsxs)(l.h2,{id:"\u5728-metrics-\u7aef\u70b9\u4e0a\u6dfb\u52a0\u8eab\u4efd\u9a8c\u8bc1",children:["\u5728 ",(0,i.jsx)(l.code,{children:"/metrics"})," \u7aef\u70b9\u4e0a\u6dfb\u52a0\u8eab\u4efd\u9a8c\u8bc1"]}),"\n",(0,i.jsxs)(l.p,{children:["\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c",(0,i.jsx)(l.code,{children:"/metrics"})," \u7aef\u70b9\u662f\u672a\u7ecf\u8fc7\u8eab\u4efd\u9a8c\u8bc1\u7684\u3002"]}),"\n",(0,i.jsxs)(l.p,{children:["\u4f60\u53ef\u4ee5\u901a\u8fc7\u5728\u914d\u7f6e\u4e2d\u8bbe\u7f6e\u4ee5\u4e0b\u5185\u5bb9\u6765\u9009\u62e9\u6027\u5730\u5728 ",(0,i.jsx)(l.code,{children:"/metrics"})," \u7aef\u70b9\u542f\u7528 LiteLLM \u8eab\u4efd\u9a8c\u8bc1\uff1a"]}),"\n",(0,i.jsx)(l.pre,{children:(0,i.jsx)(l.code,{className:"language-yaml",children:"litellm_settings:\n  require_auth_for_metrics_endpoint: true\n"})}),"\n",(0,i.jsx)(l.h2,{id:"\u5e38\u89c1\u95ee\u9898",children:"\u5e38\u89c1\u95ee\u9898"}),"\n",(0,i.jsxs)(l.h3,{id:"_created-vs-_total-\u6307\u6807\u662f\u4ec0\u4e48",children:[(0,i.jsx)(l.code,{children:"_created"})," vs. ",(0,i.jsx)(l.code,{children:"_total"})," \u6307\u6807\u662f\u4ec0\u4e48\uff1f"]}),"\n",(0,i.jsxs)(l.ul,{children:["\n",(0,i.jsxs)(l.li,{children:[(0,i.jsx)(l.code,{children:"_created"})," \u6307\u6807\u662f\u5728\u4ee3\u7406\u542f\u52a8\u65f6\u521b\u5efa\u7684\u3002"]}),"\n",(0,i.jsxs)(l.li,{children:[(0,i.jsx)(l.code,{children:"_total"})," \u6307\u6807\u662f\u6bcf\u6b21\u8bf7\u6c42\u90fd\u4f1a\u9012\u589e\u7684\u3002"]}),"\n"]}),"\n",(0,i.jsxs)(l.p,{children:["\u4f60\u5e94\u8be5\u4f7f\u7528 ",(0,i.jsx)(l.code,{children:"_total"})," \u6307\u6807\u6765\u8fdb\u884c\u8ba1\u6570\u76ee\u7684"]}),"\n",(0,i.jsx)(l.pre,{children:(0,i.jsx)(l.code,{})})]})}function j(e={}){const{wrapper:l}={...(0,r.R)(),...e.components};return l?(0,i.jsx)(l,{...e,children:(0,i.jsx)(_,{...e})}):_(e)}},72035(e,l,s){e.exports={src:Object.assign(Object.create({toString(){return this.src}}),{srcSet:s.p+"assets/ideal-img/prom_config.9f6c9db.640.png 640w,"+s.p+"assets/ideal-img/prom_config.b63d830.1920.png 1920w",images:[{path:s.p+"assets/ideal-img/prom_config.9f6c9db.640.png",width:640,height:155},{path:s.p+"assets/ideal-img/prom_config.b63d830.1920.png",width:1920,height:466}],src:s.p+"assets/ideal-img/prom_config.9f6c9db.640.png",placeholder:void 0,width:640,height:155}),preSrc:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAACCAYAAABhYU3QAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAPElEQVR4nGOwtvX6b2Ht+V/P0Pa/prbFfy0dy/9aIBoNM1jYuv01tXL9a2rl+NfE3O6vkYntX3VNUwwMABDbH9PmMWTYAAAAAElFTkSuQmCC"}}}]);