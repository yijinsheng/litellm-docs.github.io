"use strict";(globalThis.webpackChunkmy_website=globalThis.webpackChunkmy_website||[]).push([[87882],{28453(e,t,n){n.d(t,{R:()=>l,x:()=>a});var r=n(96540);const i={},o=r.createContext(i);function l(e){const t=r.useContext(o);return r.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),r.createElement(o.Provider,{value:t},e.children)}},47503(e,t,n){n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>a,default:()=>p,frontMatter:()=>l,metadata:()=>r,toc:()=>m});const r=JSON.parse('{"id":"proxy/architecture","title":"architecture","description":"","source":"@site/docs/proxy/architecture.md","sourceDirName":"proxy","slug":"/proxy/architecture","permalink":"/docs/proxy/architecture","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"\u4f1a\u8bdd\u65e5\u5fd7","permalink":"/docs/proxy/ui_logs_sessions"},"next":{"title":"\u591a\u79df\u6237\u67b6\u6784\u4e0eLiteLLM","permalink":"/docs/proxy/multi_tenant_architecture"}}');var i=n(74848),o=n(28453);const l={},a=void 0,s={},m=[];function c(e){const t={code:"code",pre:"pre",...(0,o.R)(),...e.components};return(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-markdown",children:"import Image from '@theme/IdealImage';\nimport Tabs from '@theme/Tabs';\nimport TabItem from '@theme/TabItem';\n\n# \u8bf7\u6c42\u751f\u547d\u5468\u671f\n\n## \u9ad8\u7ea7\u67b6\u6784\n\n<Image img={require('../../img/litellm_gateway.png')} style={{ width: '100%', maxWidth: '4000px' }} />\n\n\n### \u8bf7\u6c42\u6d41\u7a0b \n\n1. **\u7528\u6237\u53d1\u9001\u8bf7\u6c42**\uff1a\u5f53\u7528\u6237\u5411 LiteLLM \u4ee3\u7406\u670d\u52a1\u5668\uff08\u7f51\u5173\uff09\u53d1\u9001\u8bf7\u6c42\u65f6\uff0c\u6574\u4e2a\u8fc7\u7a0b\u5c31\u5f00\u59cb\u4e86\u3002\n\n2. [**\u865a\u62df\u5bc6\u94a5**](../virtual_keys)\uff1a\u6b64\u65f6\u4f1a\u68c0\u67e5\u8bf7\u6c42\u4e2d\u7684 `Bearer` token \u662f\u5426\u6709\u6548\u4e14\u5728\u9884\u7b97\u8303\u56f4\u5185\u3002[\u8fd9\u91cc\u5217\u51fa\u4e86\u6bcf\u6761\u8bf7\u6c42\u8fd0\u884c\u7684\u6240\u6709\u68c0\u67e5\u9879](https://github.com/BerriAI/litellm/blob/ba41a72f92a9abf1d659a87ec880e8e319f87481/litellm/proxy/auth/auth_checks.py#L43)\n    - 2.1 \u68c0\u67e5\u865a\u62df\u5bc6\u94a5\u662f\u5426\u5b58\u5728\u4e8e Redis \u7f13\u5b58\u6216\u5185\u5b58\u7f13\u5b58\u4e2d\n    - 2.2 **\u5982\u679c\u4e0d\u5728\u7f13\u5b58\u4e2d**\uff0c\u67e5\u627e\u6570\u636e\u5e93\u4e2d\u7684\u865a\u62df\u5bc6\u94a5\n\n3. **\u901f\u7387\u9650\u5236**\uff1a[MaxParallelRequestsHandler](https://github.com/BerriAI/litellm/blob/main/litellm/proxy/hooks/parallel_request_limiter.py) \u68c0\u67e5\u4ee5\u4e0b\u7ec4\u4ef6\u7684\u901f\u7387\u9650\u5236\uff08\u6bcf\u5206\u949f\u8bf7\u6c42\u6570/\u6bcf\u79d2\u8bf7\u6c42\u6570\uff09\uff1a\n    - \u5168\u5c40\u670d\u52a1\u5668\u901f\u7387\u9650\u5236\n    - \u865a\u62df\u5bc6\u94a5\u901f\u7387\u9650\u5236\n    - \u7528\u6237\u901f\u7387\u9650\u5236\n    - \u56e2\u961f\u9650\u5236\n\n4. **LiteLLM `proxy_server.py`**\uff1a\u5305\u542b `/chat/completions` \u548c `/embeddings` \u7aef\u70b9\u3002\u8fd9\u4e9b\u7aef\u70b9\u7684\u8bf7\u6c42\u901a\u8fc7 LiteLLM \u8def\u7531\u5668\u53d1\u9001\u3002\n\n5. [**LiteLLM \u8def\u7531\u5668**](../routing)\uff1aLiteLLM \u8def\u7531\u5668\u5904\u7406\u8d1f\u8f7d\u5747\u8861\u3001\u56de\u9000\u548c LLM API \u90e8\u7f72\u7684\u91cd\u8bd5\u3002\n\n6. **litellm.completion() / litellm.embedding()**: (\u53c2\u89c1 ../index#litellm-python-sdk) \u4f7f\u7528 litellm Python SDK \u4ee5 OpenAI API \u683c\u5f0f\u8c03\u7528 LLM\uff08\u7ffb\u8bd1\u548c\u53c2\u6570\u6620\u5c04\uff09\n\n7. **\u8bf7\u6c42\u540e\u5904\u7406**\uff1a\u5728\u5c06\u54cd\u5e94\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef\u4e4b\u540e\uff0c\u6267\u884c\u4ee5\u4e0b\u5f02\u6b65\u4efb\u52a1\uff1a\n   - [\u65e5\u5fd7\u8bb0\u5f55\u5230 Lunary\u3001MLflow\u3001LangFuse \u6216\u5176\u4ed6\u65e5\u5fd7\u76ee\u7684\u5730](./logging)\n   - [MaxParallelRequestsHandler](https://github.com/BerriAI/litellm/blob/main/litellm/proxy/hooks/parallel_request_limiter.py) \u66f4\u65b0\n        - \u5168\u5c40\u670d\u52a1\u5668\u901f\u7387\u9650\u5236\u7684 rpm/tpm \u4f7f\u7528\u60c5\u51b5\n        - \u865a\u62df\u5bc6\u94a5\u901f\u7387\u9650\u5236\u7684 rpm/tpm \u4f7f\u7528\u60c5\u51b5\n        - \u7528\u6237\u901f\u7387\u9650\u5236\u7684 rpm/tpm \u4f7f\u7528\u60c5\u51b5\n        - \u56e2\u961f\u9650\u5236\u7684\u4f7f\u7528\u60c5\u51b5\n    - `_ProxyDBLogger` \u66f4\u65b0 LiteLLM \u6570\u636e\u5e93\u4e2d\u7684\u82b1\u8d39\u548c\u4f7f\u7528\u60c5\u51b5\u3002[\u8fd9\u91cc\u5217\u51fa\u4e86\u6bcf\u6761\u8bf7\u6c42\u5728\u6570\u636e\u5e93\u4e2d\u8ddf\u8e2a\u7684\u6240\u6709\u5185\u5bb9](https://github.com/BerriAI/litellm/blob/ba41a72f92a9abf1d659a87ec880e8e319f87481/schema.prisma#L172)\n\n## \u7ecf\u5e38\u9047\u5230\u7684\u95ee\u9898\n\n1. \u4e00\u4e2a\u6570\u636e\u5e93\u4e8b\u52a1\u662f\u5426\u4e0e\u8bf7\u6c42\u7684\u751f\u547d\u5468\u671f\u76f8\u5173\uff1f\n    - \u4e0d\u662f\uff0c\u6570\u636e\u5e93\u4e8b\u52a1\u4e0d\u4e0e\u8bf7\u6c42\u7684\u751f\u547d\u5468\u671f\u76f8\u5173\u3002\n    - \u68c0\u67e5\u865a\u62df\u5bc6\u94a5\u7684\u6709\u6548\u6027\u4f9d\u8d56\u4e8e\u7f13\u5b58\u4e2d\u4e0d\u5b58\u5728\u65f6\u5bf9\u6570\u636e\u5e93\u7684\u8bfb\u53d6\u64cd\u4f5c\u3002\n    - \u6240\u6709\u5176\u4ed6\u6570\u636e\u5e93\u4e8b\u52a1\u90fd\u5728\u540e\u53f0\u4efb\u52a1\u4e2d\u5f02\u6b65\u6267\u884c\u3002\n"})})}function p(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}}}]);