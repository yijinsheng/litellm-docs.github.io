"use strict";(globalThis.webpackChunkmy_website=globalThis.webpackChunkmy_website||[]).push([[87199],{28453(e,n,t){t.d(n,{R:()=>r,x:()=>c});var s=t(96540);const a={},l=s.createContext(a);function r(e){const n=s.useContext(l);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),s.createElement(l.Provider,{value:n},e.children)}},56207(e,n,t){t.r(n),t.d(n,{assets:()=>i,contentTitle:()=>c,default:()=>h,frontMatter:()=>r,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"proxy/reject_clientside_metadata_tags","title":"\u62d2\u7edd\u5ba2\u6237\u7aef\u5143\u6570\u636e\u6807\u7b7e","description":"\u6982\u8ff0","source":"@site/docs/proxy/reject_clientside_metadata_tags.md","sourceDirName":"proxy","slug":"/proxy/reject_clientside_metadata_tags","permalink":"/docs/proxy/reject_clientside_metadata_tags","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{}}');var a=t(74848),l=t(28453);const r={},c="\u62d2\u7edd\u5ba2\u6237\u7aef\u5143\u6570\u636e\u6807\u7b7e",i={},d=[{value:"\u6982\u8ff0",id:"\u6982\u8ff0",level:2},{value:"\u4f7f\u7528\u573a\u666f",id:"\u4f7f\u7528\u573a\u666f",level:2},{value:"\u914d\u7f6e",id:"\u914d\u7f6e",level:2},{value:"\u884c\u4e3a",id:"\u884c\u4e3a",level:2},{value:"\u5f53 <code>reject_clientside_metadata_tags: true</code> \u65f6",id:"\u5f53-reject_clientside_metadata_tags-true-\u65f6",level:3},{value:"\u5f53 <code>reject_clientside_metadata_tags: false</code> \u6216\u672a\u8bbe\u7f6e\u65f6",id:"\u5f53-reject_clientside_metadata_tags-false-\u6216\u672a\u8bbe\u7f6e\u65f6",level:3},{value:"\u901a\u8fc7 API \u5bc6\u94a5\u8bbe\u7f6e\u6807\u7b7e",id:"\u901a\u8fc7-api-\u5bc6\u94a5\u8bbe\u7f6e\u6807\u7b7e",level:2},{value:"\u5b8c\u6574\u793a\u4f8b\u914d\u7f6e",id:"\u5b8c\u6574\u793a\u4f8b\u914d\u7f6e",level:2},{value:"\u76f8\u5173\u529f\u80fd",id:"\u76f8\u5173\u529f\u80fd",level:2},{value:"\u6ce8\u610f\u4e8b\u9879",id:"\u6ce8\u610f\u4e8b\u9879",level:2}];function o(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"\u62d2\u7edd\u5ba2\u6237\u7aef\u5143\u6570\u636e\u6807\u7b7e",children:"\u62d2\u7edd\u5ba2\u6237\u7aef\u5143\u6570\u636e\u6807\u7b7e"})}),"\n",(0,a.jsx)(n.h2,{id:"\u6982\u8ff0",children:"\u6982\u8ff0"}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.code,{children:"reject_clientside_metadata_tags"})," \u8bbe\u7f6e\u5141\u8bb8\u60a8\u9632\u6b62\u7528\u6237\u5728\u5176 API \u8bf7\u6c42\u4e2d\u4f20\u9012\u5ba2\u6237\u7aef\u4fa7 ",(0,a.jsx)(n.code,{children:"metadata.tags"}),"\u3002\u8fd9\u786e\u4fdd\u4e86\u6807\u7b7e\u53ea\u80fd\u4ece API \u5bc6\u94a5\u5143\u6570\u636e\u7ee7\u627f\uff0c\u800c\u4e0d\u80fd\u88ab\u7528\u6237\u901a\u8fc7\u53d1\u9001\u81ea\u5b9a\u4e49\u5ba2\u6237\u7aef\u4fa7\u6807\u7b7e\u6765\u6f5c\u5728\u5730\u5f71\u54cd\u9884\u7b97\u8ddf\u8e2a\u6216\u8def\u7531\u51b3\u7b56\u3002"]}),"\n",(0,a.jsx)(n.h2,{id:"\u4f7f\u7528\u573a\u666f",children:"\u4f7f\u7528\u573a\u666f"}),"\n",(0,a.jsx)(n.p,{children:"\u6b64\u529f\u80fd\u7279\u522b\u9002\u7528\u4e8e\u591a\u79df\u6237\u573a\u666f\uff0c\u5176\u4e2d\uff1a"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"\u60a8\u5e0c\u671b\u57fa\u4e8e API \u5bc6\u94a5\u6807\u7b7e\u8fdb\u884c\u4e25\u683c\u7684\u9884\u7b97\u8ddf\u8e2a"}),"\n",(0,a.jsx)(n.li,{children:"\u60a8\u5e0c\u671b\u9632\u6b62\u7528\u6237\u901a\u8fc7\u53d1\u9001\u81ea\u5b9a\u4e49\u5ba2\u6237\u7aef\u4fa7\u6807\u7b7e\u6765\u64cd\u7eb5\u8def\u7531\u51b3\u7b56"}),"\n",(0,a.jsx)(n.li,{children:"\u60a8\u9700\u8981\u786e\u4fdd\u57fa\u4e8e\u6807\u7b7e\u7684\u4e00\u81f4\u6027\u8fc7\u6ee4\u548c\u62a5\u544a"}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"\u914d\u7f6e",children:"\u914d\u7f6e"}),"\n",(0,a.jsxs)(n.p,{children:["\u5728 ",(0,a.jsx)(n.code,{children:"config.yaml"})," \u4e2d\u6dfb\u52a0\u4ee5\u4e0b\u5185\u5bb9\uff1a"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:"general_settings:\n  reject_clientside_metadata_tags: true  # \u9ed8\u8ba4\u4e3a false/null\n"})}),"\n",(0,a.jsx)(n.h2,{id:"\u884c\u4e3a",children:"\u884c\u4e3a"}),"\n",(0,a.jsxs)(n.h3,{id:"\u5f53-reject_clientside_metadata_tags-true-\u65f6",children:["\u5f53 ",(0,a.jsx)(n.code,{children:"reject_clientside_metadata_tags: true"})," \u65f6"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"\u88ab\u62d2\u7edd\u7684\u8bf7\u6c42\u793a\u4f8b\uff1a"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'curl -X POST http://localhost:4000/chat/completions \\\n  -H "Authorization: Bearer sk-1234" \\\n  -H "Content-Type: application/json" \\\n  -d \'{\n    "model": "gpt-3.5-turbo",\n    "messages": [{"role": "user", "content": "Hello"}],\n    "metadata": {\n      "tags": ["custom-tag"]  # \u8fd9\u5c06\u88ab\u62d2\u7edd\n    }\n  }\'\n'})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"\u9519\u8bef\u54cd\u5e94\uff1a"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'{\n  "error": {\n    "message": "\u5ba2\u6237\u7aef \'metadata.tags\' \u4e0d\u5141\u8bb8\u5728\u8bf7\u6c42\u4e2d\u4f7f\u7528\u3002\'reject_clientside_metadata_tags\'=True\u3002\u6807\u7b7e\u53ea\u80fd\u901a\u8fc7 API \u5bc6\u94a5\u5143\u6570\u636e\u8bbe\u7f6e\u3002",\n    "type": "bad_request_error",\n    "param": "metadata.tags",\n    "code": 400\n  }\n}\n'})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"\u5141\u8bb8\u7684\u8bf7\u6c42\u793a\u4f8b\uff1a"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'curl -X POST http://localhost:4000/chat/completions \\\n  -H "Authorization: Bearer sk-1234" \\\n  -H "Content-Type: application/json" \\\n  -d \'{\n    "model": "gpt-3.5-turbo",\n    "messages": [{"role": "user", "content": "Hello"}],\n    "metadata": {\n      "custom_field": "value"  # \u5176\u4ed6\u5143\u6570\u636e\u5b57\u6bb5\u5141\u8bb8\u5b58\u5728\n    }\n  }\'\n'})}),"\n",(0,a.jsxs)(n.h3,{id:"\u5f53-reject_clientside_metadata_tags-false-\u6216\u672a\u8bbe\u7f6e\u65f6",children:["\u5f53 ",(0,a.jsx)(n.code,{children:"reject_clientside_metadata_tags: false"})," \u6216\u672a\u8bbe\u7f6e\u65f6"]}),"\n",(0,a.jsxs)(n.p,{children:["\u6240\u6709\u8bf7\u6c42\u5747\u88ab\u5141\u8bb8\uff0c\u5305\u62ec\u5e26\u6709\u5ba2\u6237\u7aef\u4fa7 ",(0,a.jsx)(n.code,{children:"metadata.tags"})," \u7684\u8bf7\u6c42\u3002"]}),"\n",(0,a.jsx)(n.h2,{id:"\u901a\u8fc7-api-\u5bc6\u94a5\u8bbe\u7f6e\u6807\u7b7e",children:"\u901a\u8fc7 API \u5bc6\u94a5\u8bbe\u7f6e\u6807\u7b7e"}),"\n",(0,a.jsxs)(n.p,{children:["\u5f53\u542f\u7528 ",(0,a.jsx)(n.code,{children:"reject_clientside_metadata_tags"})," \u65f6\uff0c\u5e94\u5728 API \u5bc6\u94a5\u5143\u6570\u636e\u4e2d\u8bbe\u7f6e\u6807\u7b7e\uff1a"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'curl -X POST http://localhost:4000/key/generate \\\n  -H "Authorization: Bearer sk-master-key" \\\n  -H "Content-Type: application/json" \\\n  -d \'{\n    "metadata": {\n      "tags": ["team-a", "production"]\n    }\n  }\'\n'})}),"\n",(0,a.jsx)(n.p,{children:"\u8fd9\u4e9b\u6807\u7b7e\u5c06\u81ea\u52a8\u88ab\u6240\u6709\u4f7f\u7528\u8be5 API \u5bc6\u94a5\u7684\u8bf7\u6c42\u7ee7\u627f\u3002"}),"\n",(0,a.jsx)(n.h2,{id:"\u5b8c\u6574\u793a\u4f8b\u914d\u7f6e",children:"\u5b8c\u6574\u793a\u4f8b\u914d\u7f6e"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:'model_list:\n  - model_name: gpt-3.5-turbo\n    litellm_params:\n      model: gpt-3.5-turbo\n      api_key: os.environ/OPENAI_API_KEY\n\ngeneral_settings:\n  master_key: sk-1234\n  database_url: "postgresql://user:password@localhost:5432/litellm"\n  \n  # \u62d2\u7edd\u5ba2\u6237\u7aef\u4fa7\u6807\u7b7e\n  reject_clientside_metadata_tags: true\n  \n  # \u53ef\u9009\uff1a\u540c\u65f6\u5f3a\u5236\u6267\u884c\u7528\u6237\u53c2\u6570\n  enforce_user_param: true\n'})}),"\n",(0,a.jsx)(n.h2,{id:"\u76f8\u5173\u529f\u80fd",children:"\u76f8\u5173\u529f\u80fd"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"enforce_user_param"})," - \u8981\u6c42\u6240\u6709\u8bf7\u6c42\u90fd\u5305\u542b\u4e00\u4e2a 'user' \u53c2\u6570"]}),"\n",(0,a.jsx)(n.li,{children:"\u57fa\u4e8e\u6807\u7b7e\u7684\u8def\u7531 - \u4f7f\u7528\u6807\u7b7e\u8fdb\u884c\u667a\u80fd\u8bf7\u6c42\u8def\u7531"}),"\n",(0,a.jsx)(n.li,{children:"\u9884\u7b97\u8ddf\u8e2a - \u6309\u6807\u7b7e\u8ffd\u8e2a\u652f\u51fa"}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"\u6ce8\u610f\u4e8b\u9879",children:"\u6ce8\u610f\u4e8b\u9879"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["\u6b64\u68c0\u67e5\u4ec5\u9002\u7528\u4e8e LLM API \u8def\u7531\uff08\u4f8b\u5982\uff0c",(0,a.jsx)(n.code,{children:"/chat/completions"}),", ",(0,a.jsx)(n.code,{children:"/embeddings"}),"\uff09"]}),"\n",(0,a.jsxs)(n.li,{children:["\u7ba1\u7406\u7aef\u70b9\uff08\u4f8b\u5982\uff0c",(0,a.jsx)(n.code,{children:"/key/generate"}),"\uff09\u4e0d\u53d7\u5f71\u54cd"]}),"\n",(0,a.jsxs)(n.li,{children:["\u8be5\u68c0\u67e5\u9a8c\u8bc1\u8bf7\u6c42\u4e3b\u4f53\u4e2d\u4e0d\u5b58\u5728\u5ba2\u6237\u7aef\u4fa7 ",(0,a.jsx)(n.code,{children:"metadata.tags"})]}),"\n",(0,a.jsx)(n.li,{children:"\u5176\u4ed6\u5143\u6570\u636e\u5b57\u6bb5\u4ecd\u7136\u53ef\u4ee5\u5728\u8bf7\u6c42\u4e2d\u4f20\u9012"}),"\n",(0,a.jsx)(n.li,{children:"\u8bbe\u7f6e\u5728 API \u5bc6\u94a5\u4e0a\u7684\u6807\u7b7e\u4ecd\u5c06\u5e94\u7528\u4e8e\u6240\u6709\u8bf7\u6c42"}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(o,{...e})}):o(e)}}}]);