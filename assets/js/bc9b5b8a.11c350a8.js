"use strict";(globalThis.webpackChunkmy_website=globalThis.webpackChunkmy_website||[]).push([[19191],{7227(e,n,a){a.d(n,{A:()=>r});a(96540);var l=a(18215);const t="tabItem_Ymn6";var s=a(74848);function r({children:e,hidden:n,className:a}){return(0,s.jsx)("div",{role:"tabpanel",className:(0,l.A)(t,a),hidden:n,children:e})}},28453(e,n,a){a.d(n,{R:()=>r,x:()=>i});var l=a(96540);const t={},s=l.createContext(t);function r(e){const n=l.useContext(s);return l.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:r(e.components),l.createElement(s.Provider,{value:n},e.children)}},49489(e,n,a){a.d(n,{A:()=>w});var l=a(96540),t=a(18215),s=a(24245),r=a(56347),i=a(36494),o=a(62814),c=a(45167),d=a(69900);function u(e){return l.Children.toArray(e).filter(e=>"\n"!==e).map(e=>{if(!e||(0,l.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})?.filter(Boolean)??[]}function h(e){const{values:n,children:a}=e;return(0,l.useMemo)(()=>{const e=n??function(e){return u(e).map(({props:{value:e,label:n,attributes:a,default:l}})=>({value:e,label:n,attributes:a,default:l}))}(a);return function(e){const n=(0,c.XI)(e,(e,n)=>e.value===n.value);if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map(e=>e.value).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e},[n,a])}function p({value:e,tabValues:n}){return n.some(n=>n.value===e)}function m({queryString:e=!1,groupId:n}){const a=(0,r.W6)(),t=function({queryString:e=!1,groupId:n}){if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:e,groupId:n});return[(0,o.aZ)(t),(0,l.useCallback)(e=>{if(!t)return;const n=new URLSearchParams(a.location.search);n.set(t,e),a.replace({...a.location,search:n.toString()})},[t,a])]}function x(e){const{defaultValue:n,queryString:a=!1,groupId:t}=e,s=h(e),[r,o]=(0,l.useState)(()=>function({defaultValue:e,tabValues:n}){if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!p({value:e,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${n.map(e=>e.value).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}const a=n.find(e=>e.default)??n[0];if(!a)throw new Error("Unexpected error: 0 tabValues");return a.value}({defaultValue:n,tabValues:s})),[c,u]=m({queryString:a,groupId:t}),[x,j]=function({groupId:e}){const n=function(e){return e?`docusaurus.tab.${e}`:null}(e),[a,t]=(0,d.Dv)(n);return[a,(0,l.useCallback)(e=>{n&&t.set(e)},[n,t])]}({groupId:t}),b=(()=>{const e=c??x;return p({value:e,tabValues:s})?e:null})();(0,i.A)(()=>{b&&o(b)},[b]);return{selectedValue:r,selectValue:(0,l.useCallback)(e=>{if(!p({value:e,tabValues:s}))throw new Error(`Can't select invalid tab value=${e}`);o(e),u(e),j(e)},[u,j,s]),tabValues:s}}var j=a(11062);const b="tabList__CuJ",f="tabItem_LNqP";var g=a(74848);function y({className:e,block:n,selectedValue:a,selectValue:l,tabValues:r}){const i=[],{blockElementScrollPositionUntilNextRender:o}=(0,s.a_)(),c=e=>{const n=e.currentTarget,t=i.indexOf(n),s=r[t].value;s!==a&&(o(n),l(s))},d=e=>{let n=null;switch(e.key){case"Enter":c(e);break;case"ArrowRight":{const a=i.indexOf(e.currentTarget)+1;n=i[a]??i[0];break}case"ArrowLeft":{const a=i.indexOf(e.currentTarget)-1;n=i[a]??i[i.length-1];break}}n?.focus()};return(0,g.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,t.A)("tabs",{"tabs--block":n},e),children:r.map(({value:e,label:n,attributes:l})=>(0,g.jsx)("li",{role:"tab",tabIndex:a===e?0:-1,"aria-selected":a===e,ref:e=>{i.push(e)},onKeyDown:d,onClick:c,...l,className:(0,t.A)("tabs__item",f,l?.className,{"tabs__item--active":a===e}),children:n??e},e))})}function v({lazy:e,children:n,selectedValue:a}){const s=(Array.isArray(n)?n:[n]).filter(Boolean);if(e){const e=s.find(e=>e.props.value===a);return e?(0,l.cloneElement)(e,{className:(0,t.A)("margin-top--md",e.props.className)}):null}return(0,g.jsx)("div",{className:"margin-top--md",children:s.map((e,n)=>(0,l.cloneElement)(e,{key:n,hidden:e.props.value!==a}))})}function k(e){const n=x(e);return(0,g.jsxs)("div",{className:(0,t.A)("tabs-container",b),children:[(0,g.jsx)(y,{...n,...e}),(0,g.jsx)(v,{...n,...e})]})}function w(e){const n=(0,j.A)();return(0,g.jsx)(k,{...e,children:u(e.children)},String(n))}},49907(e,n,a){a.r(n),a.d(n,{assets:()=>d,contentTitle:()=>c,default:()=>p,frontMatter:()=>o,metadata:()=>l,toc:()=>u});const l=JSON.parse('{"id":"proxy/model_access","title":"Restrict Model Access","description":"Restrict models by Virtual Key","source":"@site/docs/proxy/model_access.md","sourceDirName":"proxy","slug":"/proxy/model_access","permalink":"/docs/proxy/model_access","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"\u5982\u4f55\u8bbf\u95ee\u6a21\u578b","permalink":"/docs/proxy/model_access_guide"},"next":{"title":"\u6a21\u578b\u8bbf\u95ee\u7ec4","permalink":"/docs/proxy/model_access_groups"}}');var t=a(74848),s=a(28453),r=a(49489),i=a(7227);const o={},c="Restrict Model Access",d={},u=[{value:"<strong>Restrict models by Virtual Key</strong>",id:"restrict-models-by-virtual-key",level:2},{value:"API Reference",id:"api-reference",level:3},{value:"<strong>Restrict models by <code>team_id</code></strong>",id:"restrict-models-by-team_id",level:2},{value:"API Reference",id:"api-reference-1",level:3},{value:"<strong>View Available Fallback Models</strong>",id:"view-available-fallback-models",level:2},{value:"Basic Usage",id:"basic-usage",level:3},{value:"Get Fallback Models with Metadata",id:"get-fallback-models-with-metadata",level:3},{value:"Get Specific Fallback Types",id:"get-specific-fallback-types",level:3},{value:"Example Response",id:"example-response",level:3},{value:"Use Cases",id:"use-cases",level:3},{value:"API Parameters",id:"api-parameters",level:3},{value:"Advanced: Model Access Groups",id:"advanced-model-access-groups",level:2},{value:"Role Based Access Control (RBAC)",id:"role-based-access-control-rbac",level:2}];function h(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"restrict-model-access",children:"Restrict Model Access"})}),"\n",(0,t.jsx)(n.h2,{id:"restrict-models-by-virtual-key",children:(0,t.jsx)(n.strong,{children:"Restrict models by Virtual Key"})}),"\n",(0,t.jsxs)(n.p,{children:["Set allowed models for a key using the ",(0,t.jsx)(n.code,{children:"models"})," param"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"curl 'http://0.0.0.0:4000/key/generate' \\\n--header 'Authorization: Bearer <your-master-key>' \\\n--header 'Content-Type: application/json' \\\n--data-raw '{\"models\": [\"gpt-3.5-turbo\", \"gpt-4\"]}'\n"})}),"\n",(0,t.jsx)(n.admonition,{type:"info",children:(0,t.jsxs)(n.p,{children:["This key can only make requests to ",(0,t.jsx)(n.code,{children:"models"})," that are ",(0,t.jsx)(n.code,{children:"gpt-3.5-turbo"})," or ",(0,t.jsx)(n.code,{children:"gpt-4"})]})}),"\n",(0,t.jsx)(n.p,{children:"Verify this is set correctly by"}),"\n",(0,t.jsxs)(r.A,{children:[(0,t.jsx)(i.A,{label:"Allowed Access",value:"allowed",children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:'curl -i http://localhost:4000/v1/chat/completions \\\n  -H "Content-Type: application/json" \\\n  -H "Authorization: Bearer sk-1234" \\\n  -d \'{\n    "model": "gpt-4",\n    "messages": [\n      {"role": "user", "content": "Hello"}\n    ]\n  }\'\n'})})}),(0,t.jsxs)(i.A,{label:"Disallowed Access",value:"not-allowed",children:[(0,t.jsx)(n.admonition,{type:"info",children:(0,t.jsxs)(n.p,{children:["Expect this to fail since gpt-4o is not in the ",(0,t.jsx)(n.code,{children:"models"})," for the key generated"]})}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:'curl -i http://localhost:4000/v1/chat/completions \\\n  -H "Content-Type: application/json" \\\n  -H "Authorization: Bearer sk-1234" \\\n  -d \'{\n    "model": "gpt-4o",\n    "messages": [\n      {"role": "user", "content": "Hello"}\n    ]\n  }\'\n'})})]})]}),"\n",(0,t.jsx)(n.h3,{id:"api-reference",children:(0,t.jsx)(n.a,{href:"https://litellm-api.up.railway.app/#/key%20management/generate_key_fn_key_generate_post",children:"API Reference"})}),"\n",(0,t.jsx)(n.h2,{id:"restrict-models-by-team_id",children:(0,t.jsxs)(n.strong,{children:["Restrict models by ",(0,t.jsx)(n.code,{children:"team_id"})]})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"litellm-dev"})," can only access ",(0,t.jsx)(n.code,{children:"azure-gpt-3.5"})]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsxs)(n.strong,{children:["1. Create a team via ",(0,t.jsx)(n.code,{children:"/team/new"})]})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:'curl --location \'http://localhost:4000/team/new\' \\\n--header \'Authorization: Bearer <your-master-key>\' \\\n--header \'Content-Type: application/json\' \\\n--data-raw \'{\n  "team_alias": "litellm-dev",\n  "models": ["azure-gpt-3.5"]\n}\' \n\n# returns {...,"team_id": "my-unique-id"}\n'})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"2. Create a key for team"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"curl --location 'http://localhost:4000/key/generate' \\\n--header 'Authorization: Bearer sk-1234' \\\n--header 'Content-Type: application/json' \\\n--data-raw '{\"team_id\": \"my-unique-id\"}'\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"3. Test it"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:'curl --location \'http://0.0.0.0:4000/chat/completions\' \\\n    --header \'Content-Type: application/json\' \\\n    --header \'Authorization: Bearer sk-qo992IjKOC2CHKZGRoJIGA\' \\\n    --data \'{\n        "model": "BEDROCK_GROUP",\n        "messages": [\n            {\n                "role": "user",\n                "content": "hi"\n            }\n        ]\n    }\'\n'})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:'{"error":{"message":"Invalid model for team litellm-dev: BEDROCK_GROUP.  Valid models for team are: [\'azure-gpt-3.5\']\\n\\n\\nTraceback (most recent call last):\\n  File \\"/Users/ishaanjaffer/Github/litellm/litellm/proxy/proxy_server.py\\", line 2298, in chat_completion\\n    _is_valid_team_configs(\\n  File \\"/Users/ishaanjaffer/Github/litellm/litellm/proxy/utils.py\\", line 1296, in _is_valid_team_configs\\n    raise Exception(\\nException: Invalid model for team litellm-dev: BEDROCK_GROUP.  Valid models for team are: [\'azure-gpt-3.5\']\\n\\n","type":"None","param":"None","code":500}}%            \n'})}),"\n",(0,t.jsx)(n.h3,{id:"api-reference-1",children:(0,t.jsx)(n.a,{href:"https://litellm-api.up.railway.app/#/team%20management/new_team_team_new_post",children:"API Reference"})}),"\n",(0,t.jsx)(n.h2,{id:"view-available-fallback-models",children:(0,t.jsx)(n.strong,{children:"View Available Fallback Models"})}),"\n",(0,t.jsxs)(n.p,{children:["Use the ",(0,t.jsx)(n.code,{children:"/v1/models"})," endpoint to discover available fallback models for a given model. This helps you understand which backup models are available when your primary model is unavailable or restricted."]}),"\n",(0,t.jsx)(n.admonition,{title:"Extension Point",type:"info",children:(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"include_metadata"})," parameter serves as an extension point for exposing additional model metadata in the future. While currently focused on fallback models, this approach will be expanded to include other model metadata such as pricing information, capabilities, rate limits, and more."]})}),"\n",(0,t.jsx)(n.h3,{id:"basic-usage",children:"Basic Usage"}),"\n",(0,t.jsx)(n.p,{children:"Get all available models:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"curl -X GET 'http://localhost:4000/v1/models' \\\n  -H 'Authorization: Bearer <your-api-key>'\n"})}),"\n",(0,t.jsx)(n.h3,{id:"get-fallback-models-with-metadata",children:"Get Fallback Models with Metadata"}),"\n",(0,t.jsx)(n.p,{children:"Include metadata to see fallback model information:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"curl -X GET 'http://localhost:4000/v1/models?include_metadata=true' \\\n  -H 'Authorization: Bearer <your-api-key>'\n"})}),"\n",(0,t.jsx)(n.h3,{id:"get-specific-fallback-types",children:"Get Specific Fallback Types"}),"\n",(0,t.jsx)(n.p,{children:"You can specify the type of fallbacks you want to see:"}),"\n",(0,t.jsxs)(r.A,{children:[(0,t.jsxs)(i.A,{value:"general",label:"General Fallbacks",children:[(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"curl -X GET 'http://localhost:4000/v1/models?include_metadata=true&fallback_type=general' \\\n  -H 'Authorization: Bearer <your-api-key>'\n"})}),(0,t.jsx)(n.p,{children:"General fallbacks are alternative models that can handle the same types of requests."})]}),(0,t.jsxs)(i.A,{value:"context_window",label:"Context Window Fallbacks",children:[(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"curl -X GET 'http://localhost:4000/v1/models?include_metadata=true&fallback_type=context_window' \\\n  -H 'Authorization: Bearer <your-api-key>'\n"})}),(0,t.jsx)(n.p,{children:"Context window fallbacks are models with larger context windows that can handle requests when the primary model's context limit is exceeded."})]}),(0,t.jsxs)(i.A,{value:"content_policy",label:"Content Policy Fallbacks",children:[(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"curl -X GET 'http://localhost:4000/v1/models?include_metadata=true&fallback_type=content_policy' \\\n  -H 'Authorization: Bearer <your-api-key>'\n"})}),(0,t.jsx)(n.p,{children:"Content policy fallbacks are models that can handle requests when the primary model rejects content due to safety policies."})]})]}),"\n",(0,t.jsx)(n.h3,{id:"example-response",children:"Example Response"}),"\n",(0,t.jsxs)(n.p,{children:["When ",(0,t.jsx)(n.code,{children:"include_metadata=true"})," is specified, the response includes fallback information:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "data": [\n    {\n      "id": "gpt-4",\n      "object": "model",\n      "created": 1677610602,\n      "owned_by": "openai",\n      "fallbacks": {\n        "general": ["gpt-3.5-turbo", "claude-3-sonnet"],\n        "context_window": ["gpt-4-turbo", "claude-3-opus"],\n        "content_policy": ["claude-3-haiku"]\n      }\n    }\n  ]\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"use-cases",children:"Use Cases"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"High Availability"}),": Identify backup models to ensure service continuity"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Cost Optimization"}),": Find cheaper alternatives when primary models are expensive"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Content Filtering"}),": Discover models with different content policies"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Context Length"}),": Find models that can handle larger inputs"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Load Balancing"}),": Distribute requests across multiple compatible models"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"api-parameters",children:"API Parameters"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Parameter"}),(0,t.jsx)(n.th,{children:"Type"}),(0,t.jsx)(n.th,{children:"Description"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"include_metadata"})}),(0,t.jsx)(n.td,{children:"boolean"}),(0,t.jsx)(n.td,{children:"Include additional model metadata including fallbacks"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"fallback_type"})}),(0,t.jsx)(n.td,{children:"string"}),(0,t.jsxs)(n.td,{children:["Filter fallbacks by type: ",(0,t.jsx)(n.code,{children:"general"}),", ",(0,t.jsx)(n.code,{children:"context_window"}),", or ",(0,t.jsx)(n.code,{children:"content_policy"})]})]})]})]}),"\n",(0,t.jsx)(n.h2,{id:"advanced-model-access-groups",children:"Advanced: Model Access Groups"}),"\n",(0,t.jsxs)(n.p,{children:["For advanced use cases, use ",(0,t.jsx)(n.a,{href:"./model_access_groups",children:"Model Access Groups"})," to dynamically group multiple models and manage access without restarting the proxy."]}),"\n",(0,t.jsx)(n.h2,{id:"role-based-access-control-rbac",children:(0,t.jsx)(n.a,{href:"./jwt_auth_arch",children:"Role Based Access Control (RBAC)"})})]})}function p(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(h,{...e})}):h(e)}}}]);