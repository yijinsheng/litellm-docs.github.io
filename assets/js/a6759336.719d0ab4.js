"use strict";(globalThis.webpackChunkmy_website=globalThis.webpackChunkmy_website||[]).push([[95497],{7227(e,r,l){l.d(r,{A:()=>s});l(96540);var n=l(18215);const o="tabItem_Ymn6";var a=l(74848);function s({children:e,hidden:r,className:l}){return(0,a.jsx)("div",{role:"tabpanel",className:(0,n.A)(o,l),hidden:r,children:e})}},49489(e,r,l){l.d(r,{A:()=>A});var n=l(96540),o=l(18215),a=l(24245),s=l(56347),t=l(36494),i=l(62814),c=l(45167),d=l(69900);function u(e){return n.Children.toArray(e).filter(e=>"\n"!==e).map(e=>{if(!e||(0,n.isValidElement)(e)&&function(e){const{props:r}=e;return!!r&&"object"==typeof r&&"value"in r}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})?.filter(Boolean)??[]}function h(e){const{values:r,children:l}=e;return(0,n.useMemo)(()=>{const e=r??function(e){return u(e).map(({props:{value:e,label:r,attributes:l,default:n}})=>({value:e,label:r,attributes:l,default:n}))}(l);return function(e){const r=(0,c.XI)(e,(e,r)=>e.value===r.value);if(r.length>0)throw new Error(`Docusaurus error: Duplicate values "${r.map(e=>e.value).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e},[r,l])}function m({value:e,tabValues:r}){return r.some(r=>r.value===e)}function p({queryString:e=!1,groupId:r}){const l=(0,s.W6)(),o=function({queryString:e=!1,groupId:r}){if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!r)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return r??null}({queryString:e,groupId:r});return[(0,i.aZ)(o),(0,n.useCallback)(e=>{if(!o)return;const r=new URLSearchParams(l.location.search);r.set(o,e),l.replace({...l.location,search:r.toString()})},[o,l])]}function x(e){const{defaultValue:r,queryString:l=!1,groupId:o}=e,a=h(e),[s,i]=(0,n.useState)(()=>function({defaultValue:e,tabValues:r}){if(0===r.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!m({value:e,tabValues:r}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${r.map(e=>e.value).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}const l=r.find(e=>e.default)??r[0];if(!l)throw new Error("Unexpected error: 0 tabValues");return l.value}({defaultValue:r,tabValues:a})),[c,u]=p({queryString:l,groupId:o}),[x,f]=function({groupId:e}){const r=function(e){return e?`docusaurus.tab.${e}`:null}(e),[l,o]=(0,d.Dv)(r);return[l,(0,n.useCallback)(e=>{r&&o.set(e)},[r,o])]}({groupId:o}),g=(()=>{const e=c??x;return m({value:e,tabValues:a})?e:null})();(0,t.A)(()=>{g&&i(g)},[g]);return{selectedValue:s,selectValue:(0,n.useCallback)(e=>{if(!m({value:e,tabValues:a}))throw new Error(`Can't select invalid tab value=${e}`);i(e),u(e),f(e)},[u,f,a]),tabValues:a}}var f=l(11062);const g="tabList__CuJ",j="tabItem_LNqP";var b=l(74848);function v({className:e,block:r,selectedValue:l,selectValue:n,tabValues:s}){const t=[],{blockElementScrollPositionUntilNextRender:i}=(0,a.a_)(),c=e=>{const r=e.currentTarget,o=t.indexOf(r),a=s[o].value;a!==l&&(i(r),n(a))},d=e=>{let r=null;switch(e.key){case"Enter":c(e);break;case"ArrowRight":{const l=t.indexOf(e.currentTarget)+1;r=t[l]??t[0];break}case"ArrowLeft":{const l=t.indexOf(e.currentTarget)-1;r=t[l]??t[t.length-1];break}}r?.focus()};return(0,b.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,o.A)("tabs",{"tabs--block":r},e),children:s.map(({value:e,label:r,attributes:n})=>(0,b.jsx)("li",{role:"tab",tabIndex:l===e?0:-1,"aria-selected":l===e,ref:e=>{t.push(e)},onKeyDown:d,onClick:c,...n,className:(0,o.A)("tabs__item",j,n?.className,{"tabs__item--active":l===e}),children:r??e},e))})}function _({lazy:e,children:r,selectedValue:l}){const a=(Array.isArray(r)?r:[r]).filter(Boolean);if(e){const e=a.find(e=>e.props.value===l);return e?(0,n.cloneElement)(e,{className:(0,o.A)("margin-top--md",e.props.className)}):null}return(0,b.jsx)("div",{className:"margin-top--md",children:a.map((e,r)=>(0,n.cloneElement)(e,{key:r,hidden:e.props.value!==l}))})}function y(e){const r=x(e);return(0,b.jsxs)("div",{className:(0,o.A)("tabs-container",g),children:[(0,b.jsx)(v,{...r,...e}),(0,b.jsx)(_,{...r,...e})]})}function A(e){const r=(0,f.A)();return(0,b.jsx)(y,{...e,children:u(e.children)},String(r))}},71921(e,r,l){l.r(r),l.d(r,{assets:()=>i,contentTitle:()=>t,default:()=>u,frontMatter:()=>s,metadata:()=>n,toc:()=>c});const n=JSON.parse('{"id":"proxy/guardrails/model_armor","title":"Google Cloud Model Armor","description":"LiteLLM \u652f\u6301\u901a\u8fc7 Model Armor API \u4f7f\u7528 Google Cloud Model Armor \u9632\u62a4\u680f\u3002","source":"@site/docs/proxy/guardrails/model_armor.md","sourceDirName":"proxy/guardrails","slug":"/proxy/guardrails/model_armor","permalink":"/docs/proxy/guardrails/model_armor","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"integrationsSidebar","previous":{"title":"Lasso \u5b89\u5168","permalink":"/docs/proxy/guardrails/lasso_security"},"next":{"title":"Noma \u5b89\u5168","permalink":"/docs/proxy/guardrails/noma_security"}}');var o=l(74848),a=l(28453);l(90547),l(49489),l(7227);const s={},t="Google Cloud Model Armor",i={},c=[{value:"\u652f\u6301\u7684\u9632\u62a4\u680f",id:"\u652f\u6301\u7684\u9632\u62a4\u680f",level:2},{value:"\u5feb\u901f\u5f00\u59cb",id:"\u5feb\u901f\u5f00\u59cb",level:2},{value:"1. \u5728 LiteLLM config.yaml \u4e2d\u5b9a\u4e49\u9632\u62a4\u680f",id:"1-\u5728-litellm-configyaml-\u4e2d\u5b9a\u4e49\u9632\u62a4\u680f",level:3},{value:"3. \u6d4b\u8bd5\u8bf7\u6c42",id:"3-\u6d4b\u8bd5\u8bf7\u6c42",level:3},{value:"\u652f\u6301\u7684\u53c2\u6570",id:"\u652f\u6301\u7684\u53c2\u6570",level:2},{value:"\u5171\u901a\u53c2\u6570",id:"\u5171\u901a\u53c2\u6570",level:3},{value:"Model Armor \u7279\u5b9a\u53c2\u6570",id:"model-armor-\u7279\u5b9a\u53c2\u6570",level:3},{value:"\u8fdb\u4e00\u6b65\u9605\u8bfb",id:"\u8fdb\u4e00\u6b65\u9605\u8bfb",level:2}];function d(e){const r={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(r.header,{children:(0,o.jsx)(r.h1,{id:"google-cloud-model-armor",children:"Google Cloud Model Armor"})}),"\n",(0,o.jsxs)(r.p,{children:["LiteLLM \u652f\u6301\u901a\u8fc7 ",(0,o.jsx)(r.a,{href:"https://cloud.google.com/security-command-center/docs/model-armor-overview",children:"Model Armor API"})," \u4f7f\u7528 Google Cloud Model Armor \u9632\u62a4\u680f\u3002"]}),"\n",(0,o.jsx)(r.h2,{id:"\u652f\u6301\u7684\u9632\u62a4\u680f",children:"\u652f\u6301\u7684\u9632\u62a4\u680f"}),"\n",(0,o.jsxs)(r.ul,{children:["\n",(0,o.jsxs)(r.li,{children:[(0,o.jsx)(r.a,{href:"https://cloud.google.com/security-command-center/docs/manage-model-armor-templates",children:"Model Armor \u6a21\u677f"})," - \u57fa\u4e8e\u914d\u7f6e\u6a21\u677f\u7684\u5185\u5bb9\u51c0\u5316\u548c\u963b\u6b62"]}),"\n"]}),"\n",(0,o.jsx)(r.h2,{id:"\u5feb\u901f\u5f00\u59cb",children:"\u5feb\u901f\u5f00\u59cb"}),"\n",(0,o.jsx)(r.h3,{id:"1-\u5728-litellm-configyaml-\u4e2d\u5b9a\u4e49\u9632\u62a4\u680f",children:"1. \u5728 LiteLLM config.yaml \u4e2d\u5b9a\u4e49\u9632\u62a4\u680f"}),"\n",(0,o.jsxs)(r.p,{children:["\u5728 ",(0,o.jsx)(r.code,{children:"guardrails"})," \u90e8\u5206\u5b9a\u4e49\u4f60\u7684\u9632\u62a4\u680f"]}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-yaml",children:'model_list:\n  - model_name: gpt-3.5-turbo\n    litellm_params:\n      model: openai/gpt-3.5-turbo\n      api_key: os.environ/OPENAI_API_KEY\n\nguardrails:\n  - guardrail_name: model-armor-shield\n    litellm_params:\n      guardrail: model_armor\n      mode: [pre_call, post_call]  # \u5728\u8c03\u7528\u524d\u540e\u8fd0\u884c\n      template_id: "your-template-id"  # \u5fc5\u586b\uff1a\u4f60\u7684 Model Armor \u6a21\u677f ID\n      project_id: "your-project-id"    # \u4f60\u7684 GCP \u9879\u76ee ID\n      location: "us-central1"          # GCP \u5730\u533a\uff08\u9ed8\u8ba4\u4e3a us-central1\uff09\n      credentials: "path/to/credentials.json"  # \u670d\u52a1\u8d26\u53f7\u5bc6\u94a5\u8def\u5f84\n      mask_request_content: true       # \u542f\u7528\u8bf7\u6c42\u5185\u5bb9\u5c4f\u853d\n      mask_response_content: true      # \u542f\u7528\u54cd\u5e94\u5185\u5bb9\u5c4f\u853d\n      fail_on_error: true             # \u5982\u679c Model Armor \u51fa\u73b0\u9519\u8bef\u5219\u5931\u8d25\uff08\u9ed8\u8ba4\u4e3a true\uff09\n      default_on: true                # \u9ed8\u8ba4\u5bf9\u6240\u6709\u8bf7\u6c42\u8fd0\u884c\n\n\n#### `mode` \u652f\u6301\u7684\u503c\n\n- `pre_call` \u5728\u8c03\u7528\u524d\u8fd0\u884c\uff0c\u9488\u5bf9 **\u8f93\u5165**\n- `post_call` \u5728\u8c03\u7528\u540e\u8fd0\u884c\uff0c\u9488\u5bf9 **\u8f93\u5165\u548c\u8f93\u51fa**\n\n### 2. \u542f\u52a8 LiteLLM \u7f51\u5173\n\n```shell\nlitellm --config config.yaml --detailed_debug\n'})}),"\n",(0,o.jsx)(r.h3,{id:"3-\u6d4b\u8bd5\u8bf7\u6c42",children:"3. \u6d4b\u8bd5\u8bf7\u6c42"}),"\n",(0,o.jsx)(r.p,{children:(0,o.jsx)(r.strong,{children:(0,o.jsx)(r.a,{href:"../proxy/user_keys#request-format",children:"Langchain, OpenAI SDK \u4f7f\u7528\u793a\u4f8b"})})}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-shell",children:'curl -i http://localhost:4000/v1/chat/completions \\\n  -H "Content-Type: application/json" \\\n  -H "Authorization: Bearer sk-npnwjPQciVRok5yNZgKmFQ" \\\n  -d \'{\n    "model": "gpt-3.5-turbo",\n    "messages": [\n      {"role": "user", "content": "Hi, my email is test@example.com"}\n    ],\n    "guardrails": ["model-armor-shield"]\n  }\'\n'})}),"\n",(0,o.jsx)(r.h2,{id:"\u652f\u6301\u7684\u53c2\u6570",children:"\u652f\u6301\u7684\u53c2\u6570"}),"\n",(0,o.jsx)(r.h3,{id:"\u5171\u901a\u53c2\u6570",children:"\u5171\u901a\u53c2\u6570"}),"\n",(0,o.jsxs)(r.ul,{children:["\n",(0,o.jsxs)(r.li,{children:[(0,o.jsx)(r.code,{children:"api_key"})," - str - Google Cloud \u670d\u52a1\u8d26\u53f7\u51ed\u636e\uff08\u5982\u679c\u4f7f\u7528 ADC \u53ef\u7701\u7565\uff09"]}),"\n",(0,o.jsxs)(r.li,{children:[(0,o.jsx)(r.code,{children:"api_base"})," - str - \u81ea\u5b9a\u4e49 Model Armor API \u7aef\u70b9\uff08\u53ef\u9009\uff09"]}),"\n",(0,o.jsxs)(r.li,{children:[(0,o.jsx)(r.code,{children:"default_on"})," - bool - \u662f\u5426\u9ed8\u8ba4\u8fd0\u884c\u9632\u62a4\u680f\u3002\u9ed8\u8ba4\u4e3a ",(0,o.jsx)(r.code,{children:"false"}),"\u3002"]}),"\n",(0,o.jsxs)(r.li,{children:[(0,o.jsx)(r.code,{children:"mode"})," - Union[str, list[str]] - \u8fd0\u884c\u9632\u62a4\u680f\u7684\u6a21\u5f0f\u3002\u53ef\u4ee5\u662f ",(0,o.jsx)(r.code,{children:"pre_call"})," \u6216 ",(0,o.jsx)(r.code,{children:"post_call"}),"\u3002\u9ed8\u8ba4\u4e3a ",(0,o.jsx)(r.code,{children:"pre_call"}),"\u3002"]}),"\n"]}),"\n",(0,o.jsx)(r.h3,{id:"model-armor-\u7279\u5b9a\u53c2\u6570",children:"Model Armor \u7279\u5b9a\u53c2\u6570"}),"\n",(0,o.jsxs)(r.ul,{children:["\n",(0,o.jsxs)(r.li,{children:[(0,o.jsx)(r.code,{children:"template_id"})," - str - \u4f60\u7684 Model Armor \u6a21\u677f ID\uff08\u5fc5\u586b\uff09"]}),"\n",(0,o.jsxs)(r.li,{children:[(0,o.jsx)(r.code,{children:"project_id"})," - str - Google Cloud \u9879\u76ee ID \uff08\u9ed8\u8ba4\u4e3a\u51ed\u636e\u4e2d\u7684\u9879\u76ee\uff09"]}),"\n",(0,o.jsxs)(r.li,{children:[(0,o.jsx)(r.code,{children:"location"})," - str - Google Cloud \u5730\u533a/\u533a\u57df\u3002\u9ed8\u8ba4\u4e3a ",(0,o.jsx)(r.code,{children:"us-central1"})]}),"\n",(0,o.jsxs)(r.li,{children:[(0,o.jsx)(r.code,{children:"credentials"})," - Union[str, dict] - \u670d\u52a1\u8d26\u53f7 JSON \u6587\u4ef6\u8def\u5f84\u6216\u51ed\u636e\u5b57\u5178"]}),"\n",(0,o.jsxs)(r.li,{children:[(0,o.jsx)(r.code,{children:"api_endpoint"})," - str - \u81ea\u5b9a\u4e49 Model Armor API \u7aef\u70b9\uff08\u53ef\u9009\uff09"]}),"\n",(0,o.jsxs)(r.li,{children:[(0,o.jsx)(r.code,{children:"fail_on_error"})," - bool - \u5982\u679c Model Armor \u51fa\u73b0\u9519\u8bef\u5219\u5931\u8d25\u3002\u9ed8\u8ba4\u4e3a ",(0,o.jsx)(r.code,{children:"true"})]}),"\n",(0,o.jsxs)(r.li,{children:[(0,o.jsx)(r.code,{children:"mask_request_content"})," - bool - \u542f\u7528\u8bf7\u6c42\u4e2d\u654f\u611f\u5185\u5bb9\u7684\u5c4f\u853d\u3002\u9ed8\u8ba4\u4e3a ",(0,o.jsx)(r.code,{children:"false"})]}),"\n",(0,o.jsxs)(r.li,{children:[(0,o.jsx)(r.code,{children:"mask_response_content"})," - bool - \u542f\u7528\u54cd\u5e94\u4e2d\u654f\u611f\u5185\u5bb9\u7684\u5c4f\u853d\u3002\u9ed8\u8ba4\u4e3a ",(0,o.jsx)(r.code,{children:"false"})]}),"\n"]}),"\n",(0,o.jsx)(r.h2,{id:"\u8fdb\u4e00\u6b65\u9605\u8bfb",children:"\u8fdb\u4e00\u6b65\u9605\u8bfb"}),"\n",(0,o.jsxs)(r.ul,{children:["\n",(0,o.jsx)(r.li,{children:(0,o.jsx)(r.a,{href:"./quick_start#-control-guardrails-per-api-key",children:"\u6309 API Key \u63a7\u5236\u9632\u62a4\u680f"})}),"\n"]}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{})})]})}function u(e={}){const{wrapper:r}={...(0,a.R)(),...e.components};return r?(0,o.jsx)(r,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}}}]);